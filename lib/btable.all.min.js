/*!
 * ====================================================
 * BTable - v1.0.0 - 2015-04-17
 * https://github.com/kitygraph/formula
 * GitHub: https://github.com/kitygraph/formula.git 
 * Copyright (c) 2015 Baidu Kity Group; Licensed MIT
 * ====================================================
 */
!function(){function a(a){return b.r([c[a]])}var b={r:function(a){if(b[a].inited)return b[a].value;if("function"!=typeof b[a].value)return b[a].inited=!0,b[a].value;var c={exports:{}},d=b[a].value(null,c.exports,c);if(b[a].inited=!0,b[a].value=d,void 0!==d)return d;for(var e in c.exports)if(c.exports.hasOwnProperty(e))return b[a].inited=!0,b[a].value=c.exports,c.exports}};b[0]={value:function(){function a(a,b){var e=c(b);return e=d(a,e,b)}function c(a){return a.hasOwnProperty("constructor")?a.constructor:f()}function d(a,b,c){function d(){this.___callBase.apply(this,arguments),b.apply(this,arguments),this.__render&&this.__render()}var f=c.base||g(),k=e(f),l=new k,n=f.prototype.___fields,o=j(c);c.__render||(c.__render=function(){return this.isBadCall()?this:this.__rendered?this:(this.callBase(),this)});for(var p in l)h(p,l)||delete l[p];for(var p in c)c.hasOwnProperty(p)&&(i(l[p])&&(c[p].___super=l[p]),l[p]=c[p]);return o=m({},n,o),l.___fields=o,l.constructor=b,l.___className=a,d.___isConstructor=!0,d.prototype=l,d.___baseClass=f,d.___className=a,b.prototype=l,b.___baseClass=f,b.___className=a,d}function e(a){function b(){}return b.prototype=a.prototype,b}function f(){function a(){}return a.prototype=k.prototype,a.prototype.constructor=a,a}function g(){function a(){this.___initField(),this.___callBase(),this.__render&&this.__render()}return a.prototype=k.prototype,a.prototype.constructor=a,a.___isConstructor=!0,a.___className="RootClass"+ +new Date,a}function h(a,b){return b.hasOwnProperty(a)?"function"!=typeof b[a]?!1:!0:!1}function i(a){return"function"==typeof a}function j(a){var b={};for(var c in a)a.hasOwnProperty(c)&&"function"!=typeof a[c]&&(b[c]=a[c],delete a[c]);return b}function k(){this.___initField(),this.___callBase(),this.__render&&this.__render()}var l=b.r(2),m=b.r(3);return l.extend(k.prototype,{___fields:{},___callBase:function(){var a=arguments.callee.caller;a.___baseClass&&a.___baseClass.apply(this,arguments)},___initField:function(){var a=this.___fields;m(this,a)},callBase:function(){var a=arguments.callee.caller;a.___super&&a.___super.apply(this,arguments)},isBadCall:function(){var a=this.___className,b=arguments.callee.caller,c=b.caller;return c.___isConstructor&&a!==c.___className}}),{create:a}}},b[1]={value:function(){return b.r(0).create("EnvManager",{context:null,target:null,constructor:function(a,b){this.context=a,this.target=b,this.init()},getContext:function(){return this.context},init:function(){}})}},b[2]={value:function(){var a=window.jQuery;return a._clone=function(a){var b={_:a};return JSON.parse(JSON.stringify(b))._},a._extend=function(a,b){for(var c,d=arguments,e=1,f=d.length;f>e;e++)if(b=d[e])for(var g in b)b.hasOwnProperty(g)&&(c=b[g],void 0!==c&&"none"!==c&&(a[g]=b[g]));return a},window.jQuery}},b[3]={value:function(){function a(b){var e=!1,f=!1,g=null;return 1===arguments.length?c(b):(d.each([].slice.call(arguments,1),function(c,h){for(var i in h)g=h[i],h.hasOwnProperty(i)&&(e=d.isPlainObject(g),f=d.isArray(g),e||f?e?(d.isPlainObject(b[i])||(b[i]={}),b[i]=a(b[i],g)):f&&(b[i]=a(g)):b[i]=h[i])}),b)}function c(b){var e=null;return d.isPlainObject(b)?a({},b):d.isArray(b)?(e=[],d.each(b,function(a,b){e.push(d.isPlainObject(b)||d.isArray(b)?c(b):b)}),e):b}var d=b.r(2);return a}},b[4]={value:function(){var a=b.r(123),c=b.r(116),d={};for(var e in c)c.hasOwnProperty(e)&&"_default"!==e&&(d[e]=c[e]);var f=b.r(0).create("BTable",{context:null,constructor:function(b){this.context=new a(b)},execCommand:function(a){return this.context.execCommand(null,a,[].slice.call(arguments,1))},queryCommandValue:function(a){return this.context.queryCommandValue(null,a,[].slice.call(arguments,1))},on:function(a,b){return this.context.addEventListener(a,b)}});return $.extend(f,{module:function(b){a.registerModule(b)},command:function(b){a.addCommand(b)},mapEvent:function(){a.mapEvent.apply(a,arguments)},plugin:function(b,c){a.registerPlugin(b,c)},FORMAT_CODE:d}),f}},b[5]={value:function(){return{basic:{undo:b.r(121),redo:b.r(120)},core:{init:b.r(26),sheet:b.r(34),content:b.r(23),resize:b.r(32),move:b.r(28),scroll:b.r(33),range:b.r(30),style:b.r(35),clear:b.r(21),border:b.r(20),format:b.r(25),"export":b.r(24),merge:b.r(27),batchstyle:b.r(19),numberformat:b.r(29),readonly:b.r(31),comments:b.r(22)},system:{sort:b.r(187),input:b.r(186),_paste:b.r(185)}}}},b[6]={value:function(){var a=b.r(0).create("Cell",{reference:null,base:b.r(140),init:function(){this.registerCommonService({"c.cell.viewrect":this.getViewRect,"c.cell.compare":this.compare,"c.cell.coordinate":this.getCellCoordinate,"c.cell.global.coordinate":this.getGlobalCoordinate,"c.columns.width":this.getColumnsWidth,"c.rows.height":this.getRowsHeight})},getViewRect:function(a,b,c){var d,e=this.compare(b,c),f=e.min,g=e.max,h=a.getViewStart(),i=a.getViewEnd();if(f.row>i.row||g.row<h.row||f.col>i.col||g.col<h.col)return null;var j={overflow:{top:!1,left:!1,bottom:!1,right:!1}};return f.row<h.row&&(j.overflow.top=!0,f.row=h.row),f.col<h.col&&(j.overflow.left=!0,f.col=h.col),g.row>i.row&&(j.overflow.bottom=!0,g.row=i.row),g.col>i.col&&(j.overflow.right=!0,g.col=i.col),d=this.getCellCoordinate(a,f.row,f.col),j.x=d.x,j.y=d.y,j.width=this.getColumnsWidth(a,f.col,g.col),j.height=this.getRowsHeight(a,f.row,g.row),j},getColumnsWidth:function(a,b,c){for(var d,e=a.getBorderWidth(),f=-1,g=b;c>=g;g++)d=a.getColumnWidth(g),0!==d&&(f+=d+e);return 0>f?0:f},getRowsHeight:function(a,b,c){for(var d,e=a.getBorderWidth(),f=-1,g=b;c>=g;g++)d=a.getRowHeight(g),0!==d&&(f+=d+e);return 0>f?0:f},getGlobalCoordinate:function(a,b,c){var d=a.getViewStart(),e=a.getBorderWidth(),f=a.getGrid(),g={y:f.row[0],x:f.col[0]},h=0,i=0;if(d.col>c){for(var j=d.col-1;j>=c;j--)h+=a.getColumnWidth(j)+e;g.x-=h}else if(d.col<c){for(var j=d.col;c>j;j++)h+=a.getColumnWidth(j)+e;g.x+=h}if(d.row>b){for(var j=d.row-1;j>=b;j--)i+=a.getRowHeight(j)+e;g.y-=i}else if(d.row<b){for(var j=d.row;b>j;j++)i+=a.getRowHeight(j)+e;g.y+=i}return g},getCellCoordinate:function(a,b,c){var d,e,f,g=a.getViewStart(),h=a.getViewEnd(),i=a.getGrid(),j=a.getBorderWidth(),k=a.getOffset(),l=a.getVisibleCount();if(b<g.row)for(d=g.row,f=i.row[0];d>b;)d--,f-=i.height[d-g.row]+j;else if(b>h.row)for(d=h.row,f=i.row[l.row];b>d;)d++,f+=i.height[d-g]+j;else f=i.row[b-g.row];if(c<g.col)for(d=g.col,e=i.col[0];d>c;)d--,e-=i.width[d-g.col]+j;else if(c>h.col)for(d=h.col,e=i.col[l.col];c>d;)d++,e+=i.width[d-g.col]+j;else e=i.col[c-g.col];return{x:e+k,y:f+k}},compare:function(a,b){return{min:{row:Math.min(a.row,b.row),col:Math.min(a.col,b.col)},max:{row:Math.max(a.row,b.row),col:Math.max(a.col,b.col)}}}});return a.getGlobalCoordinate=a.prototype.getGlobalCoordinate,a}},b[7]={value:function(){var a={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return b.r(0).create("Color",{base:b.r(140),init:function(){this.registerCommonService({"parse.color":this.parse})},parse:function(b){if(!b)return void 0;if(b=b.replace(/\s+/g,""),/^#[0-9a-f]{3}$/i.test(b))return b=b.split(""),"#"+b[0]+b[0]+b[1]+b[1]+b[2]+b[2];if(/^#[0-9a-f]{6}$/i.test(b))return b;var c,d,e,f;return/^rgb\((\d{1,3}),(\d{1,3}),(\d{1,3})\)$/i.test(b)?(c=parseInt(RegExp.$1,10),d=parseInt(RegExp.$2,10),e=parseInt(RegExp.$3,10),isNaN(c)||isNaN(d)||isNaN(e)?void 0:this.__toStandardColor(c.toString(16),d.toString(16),e.toString(16))):/^rgba\((\d{1,3}),(\d{1,3}),(\d{1,3}),([0-1.]+)\)$/i.test(b)?(c=parseInt(RegExp.$1,10),d=parseInt(RegExp.$2,10),e=parseInt(RegExp.$3,10),f=parseFloat(RegExp.$4),0===f?void 0:isNaN(c)||isNaN(d)||isNaN(e)?void 0:this.__toStandardColor(c.toString(16),d.toString(16),e.toString(16))):a[b.toLowerCase()]},__toStandardColor:function(a,b,c){return 1===a.length&&(a="0"+a),1===b.length&&(b="0"+b),1===c.length&&(c="0"+c),"#"+a+b+c}})}},b[8]={value:function(){var a={};return function(){for(var b=1;27>b;b++)a[String.fromCharCode(65+b-1)]=b.toString(27).toUpperCase()}(),{toName:function(){},toIndex:function(b){return b=b.split("").map(function(b){return a[b.toUpperCase()]}),parseInt(b.join(""),26)-1}}}},b[9]={value:function(){return b.r(0).create("Content",{base:b.r(140),init:function(){this.registerCommonService({"c.encode.content":this.encodeContent,"c.decode.content":this.decodeContent})},decodeContent:function(a){return a?a.replace(/\n/g,"<br>"):a},encodeContent:function(a){return a?a.replace(/<br[^>]*>/gi,"\n").replace(/<[^>]+>/gi,""):a}})}},b[10]={value:function(){function a(a){return a.replace(/[A-Z]/g,function(a){return"-"+a.toLowerCase()})}return b.r(0).create("Cell",{reference:null,base:b.r(140),init:function(){this.registerCommonService({"style.to.text":this.toCssText})},toCssText:function(b){var c=[];for(var d in b)b.hasOwnProperty(d)&&b[d]&&c.push(a(d)+": "+b[d]);return c.join("; ")}})}},b[11]={value:function(){var a=26;return b.r(0).create("Title",{titles:null,indexMapping:{},charMapping:{},carryIndexMapping:{},base:b.r(140),init:function(){this.initTitles(),this.registerCommonService({"c.title.index2char":this.indexToChar,"c.title.char2index":this.chartToIndex})},initTitles:function(){this.titles="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split("")},indexToChar:function(b){var c,d=[];b=b.toString(a).split("");var e=b.length-1;c=parseInt(b[e],a),d[e]=this.titles[c];for(var f=0,g=b.length-1;g>f;f++)c=parseInt(b[f],a)-1,d[f]=this.titles[c];return d.join("")},chartToIndex:function(a){var b=[];a=a.toUpperCase().split("");for(var c=0,d=a.length;d>c;c++)b[c]=this.charMapping[a[c]];return parseInt(b.join(""),10)-1}})}},b[12]={value:{inputlock:!0}},b[13]={value:{numberFormats:{numberFormat:"none"},fonts:{color:"#000000",name:"\u5b8b\u4f53",bold:!1,italic:!1,underline:!1,throughline:!1,size:13},fills:{fill:"none"},borders:{border:{top:"none",left:"none",right:"none",bottom:"none"}},alignments:{wraptext:!1,horizontal:"left",vertical:"bottom"}}},b[14]={value:{head:{width:50,height:25,color:"#000000",focusColor:"#dddddd",font:"12px/1 \u5b8b\u4f53"},scrollbar:{width:9,background:"#f8f8f8"},cell:{width:100,height:22},border:{width:1,color:"#cccccc",offset:.5},PANE_LINE_COLOR:"#999999",canvas:{background:"#ffffff",tailSpace:20},COMMENTS_ICON_COLOR:"#ff0000",LINE_HEIGHT:1.2,background:"#f8f8f8",enableScroll:!0,CONTENT_PADDING:2,CANDIDATE_FONT:["Arial","sans","sans-serif"].join(","),ZOOM:Math.ceil(window.devicePixelRatio),stack:50}},b[15]={value:function(){var a=b.r(14).canvas.tailSpace,c=b.r(0).create("Actuary",{cell:null,dataAccess:null,reverse:null,cellConfig:null,base:b.r(138),init:function(a,b){this.dataAccess=a,this.cell=b,this.initData(),this.plug(this.calculate),this.initMessageHook()},reinit:function(){this.initData()},initData:function(){var a=this.getConfig();this.reverse={},this.cellConfig=a.cell},initMessageHook:function(){this.onMessage({"c.row.calculation.reverse":this.reverseRow,"c.col.calculation.reverse":this.reverseColumn})},calculate:function(){var a=this.dataAccess,b=this.getContentSize();this.dataAccess.setSpace(b.width,b.height);var c=this.genGrid();this.reverse.row||this.reverse.col||this.patchGrid(c);var d=this.getBoundary(c),e={row:c.viewHeight.length,col:c.viewWidth.length};a.setGrid(c),a.setVisibleCount(e.row,e.col);var f=a.getViewStart();a.setViewEnd(f.row+e.row-1,f.col+e.col-1),a.setBoundary(d.width,d.height),this.reverse={},this.postMessage("c.refresh")},genGrid:function(){var a=this.getPaneGrid();return this.getNormalGrid(a)},getPaneGrid:function(){var a=this.dataAccess,b=a.getPane(),c=a.getOffset(),d=[],e=[],f={},g={},h=[c],i=[c],j=[],k=[],l=this.cell,m={rowIndex:b.row,colIndex:b.col,rowMap:d,colMap:e,rMap:f,cMap:g,viewRowPoints:h,viewColPoints:i,viewWidth:j,viewHeight:k};if(-1===b.row&&-1===b.col)return m;var n,a=this.dataAccess,o=(this.cellConfig,a.getSpace()),p=a.getBorderWidth(),q=[],r=[],s=c;if(-1!==b.row){q.push(c);for(var t=0,u=b.row;u>=t&&(n=l.getRowHeight(t),!(0!==n&&(s+=p+n,r.push(n),k.push(n),q.push(s),h.push(s),d[t]=t,f[t]=t,s>o.height)));t++);m.row=q,m.height=r}else m.row=null,m.height=null;if(q=[],r=[],s=c,-1!==b.col){q.push(c);for(var t=0,u=b.col;u>=t&&(n=l.getColumnWidth(t),!(0!==n&&(s+=p+n,r.push(n),j.push(n),q.push(s),i.push(s),e[t]=t,g[t]=t,s>o.width)));t++);m.col=q,m.width=r}else m.col=null,m.width=null;return m},getNormalGrid:function(a){var b=this.dataAccess,c=this.cell;this.reverse.row&&this.resetViewStartRow(),this.reverse.col&&this.resetViewStartCol();var d,e=b.getSpace(),f=b.getTotal(),g=b.getBorderWidth(),h=b.getViewStart(),i=b.getOffset(),j=[i],k=[i],l=[],m=[],n=h.row,o=h.col,p=e.width,q=e.height,r=a.rowMap,s=a.colMap,t=a.rMap,u=a.cMap,v=a.viewRowPoints,w=a.viewColPoints,x=a.viewHeight,y=a.viewWidth,z={row:0,col:0};-1===a.rowIndex?q-=g:(z.row=a.row[a.row.length-1]-i,q-=z.row,n+=a.rowIndex+1,n>=f.row&&(n=f.row-1)),-1===a.colIndex?p-=g:(z.col=a.col[a.col.length-1]-i,p-=z.col,o+=a.colIndex+1,o>=f.col&&(o=f.col-1));var A=i,B=v[v.length-1];if(B&&(B-=i),q>0)for(var C=n,D=f.row;D>C&&(d=c.getRowHeight(C),!(0!==d&&(A+=g+d,l.push(d),x.push(d),j.push(A),v.push(A+B),t[C]=r.length,r.push(C),A>=q)));C++);var E=q-(A+i);if(A=i,B=w[w.length-1]||0,B&&(B-=i),p>0)for(var C=o,D=f.col;D>C&&(d=c.getColumnWidth(C),!(0!==d&&(A+=g+d,m.push(d),y.push(d),k.push(A),w.push(A+B),u[C]=s.length,s.push(C),A>=p)));C++);var F=p-(A+i);return{row:j,col:k,width:m,height:l,startRow:n,startCol:o,rowMap:r,colMap:s,rMap:t,cMap:u,spaceOffset:z,viewRowPoints:v,viewColPoints:w,viewWidth:y,viewHeight:x,paneGrid:a,rowOverflow:E,colOverflow:F}},reverseRow:function(){this.reverse.row=!0},reverseColumn:function(){this.reverse.col=!0},resetViewStartRow:function(){var b,c=this.dataAccess,d=c.getSpace(),e=c.getTotal(),f=c.getBorderWidth(),g=c.getViewEnd(),h=this.cell,i=d.height,j=g.row;j>=e.row&&(j=e.row-1),j===e.row-1&&(i-=a);var k=0,l=f;i-=h.getRowHeight(j)+f;for(var m=j-1;m>=0;m--)if(b=h.getRowHeight(m),0!==b){if(l+=f+b,l>i)break;k++}c.setViewStartRow(j-k)},resetViewStartCol:function(){var b,c=this.dataAccess,d=c.getSpace(),e=c.getTotal(),f=c.getBorderWidth(),g=c.getViewEnd(),h=this.cell,i=d.width,j=g.col;j>=e.col&&(j=e.col-1),j===e.col-1&&(i-=a);var k=0,l=f;i-=h.getColumnWidth(j)+f;for(var m=j-1;m>=0;m--)if(b=h.getColumnWidth(m),0!==b){if(l+=f+b,l>i)break;k++}c.setViewStartCol(j-k)},getBoundary:function(a){var b=this.dataAccess.getOffset(),c=this.getContentSize(),d=a.viewColPoints[a.viewColPoints.length-1]+b,e=a.viewRowPoints[a.viewRowPoints.length-1]+b;return{width:Math.min(c.width,d),height:Math.min(c.height,e)}},patchGrid:function(a){var b,c;a.rowOverflow>0&&(b=this.__patchRow(a),void 0!==b&&this.dataAccess.setViewStartRow(b)),a.colOverflow>0&&(c=this.__patchCol(a),void 0!==c&&this.dataAccess.setViewStartCol(c))},__patchRow:function(b){var c=this.__getRowPatchInfo(b.rowOverflow-a,b.startRow-1);if(c){var d=c.heightList,e=c.height,f=b.paneGrid;if(0!==e){b.startRow-=d.length;var g,h,i=this.dataAccess.getBorderWidth(),j=this.dataAccess.getOffset(),k=b.startRow,l=[j],m=[],n={};if(-1===f.rowIndex){g=d.concat(b.viewHeight),h=j;for(var o=0,p=g.length;p>o;o++,k++)h+=g[o]+i,m[o]=k,n[k]=o,l.push(h);b.rowMap=m,b.rMap=n,b.viewRowPoints=l,b.viewHeight=g}else{d.unshift(f.rowIndex+1,0),b.viewHeight.splice.apply(b.viewHeight,d),g=b.viewHeight,m=b.rowMap,n=b.rMap,l=b.viewRowPoints,h=l[f.rowIndex+1];for(var o=f.rowIndex+1,p=g.length;p>o;o++,k++)h+=g[o]+i,m[o]=k,n[k]=o,l[o+1]=h}return b.startRow-(f.rowIndex+1)}}},__patchCol:function(b){var c=this.__getColPatchInfo(b.colOverflow-a,b.startCol-1);if(c){var d=c.widthList,e=c.width,f=b.paneGrid;if(0!==e){b.startCol-=d.length;var g,h,i=this.dataAccess.getBorderWidth(),j=this.dataAccess.getOffset(),k=b.startCol,l=[j],m=[],n={};if(-1===f.colIndex){g=d.concat(b.viewWidth),h=j;for(var o=0,p=g.length;p>o;o++,k++)h+=g[o]+i,m[o]=k,n[k]=o,l.push(h);b.colMap=m,b.cMap=n,b.viewColPoints=l,b.viewWidth=g}else{d.unshift(f.colIndex+1,0),b.viewWidth.splice.apply(b.viewWidth,d),g=b.viewWidth,m=b.colMap,n=b.cMap,l=b.viewColPoints,h=l[f.colIndex+1];for(var o=f.colIndex+1,p=g.length;p>o;o++,k++)h+=g[o]+i,m[o]=k,n[k]=o,l[o+1]=h}return b.startCol-(f.colIndex+1)}}},__getRowPatchInfo:function(a,b){var c=this.dataAccess,d=c.getBorderWidth(),e=this.cell;if(0>b)return null;for(var f,g=[],h=0,i=0,j=b;j>=0;j--)if(f=e.getRowHeight(j),0!==f){if(i+=f+d,i>a)break;h=i,g.push(f)}return{heightList:g.reverse(),height:h}},__getColPatchInfo:function(a,b){var c=this.dataAccess,d=c.getBorderWidth(),e=this.cell;if(0>b)return null;for(var f,g=[],h=0,i=0,j=b;j>=0;j--)if(f=e.getColumnWidth(j),0!==f){if(i+=f+d,i>a)break;h=i,g.push(f)}return{widthList:g.reverse(),width:h}}});return c.deps=["dataAccess","cell"],c}},b[16]={value:function(){var a=(b.r(37),b.r(14)),c=(a.cell.height,a.CONTENT_PADDING),d=a.LINE_HEIGHT,e=b.r(0).create("AutoSize",{dataAccess:null,wraptext:null,styleModule:null,sizeRecord:[],base:b.r(138),init:function(a,b,c){this.dataAccess=a,this.wraptext=c,this.styleModule=b,this.initMessageHook()},initMessageHook:function(){this.onMessage({"c.contentchange":this.__contentChange,"c.stylechange":this.__styleChange,"c.columnresize":this.__columnResize,"c.rowresize":this.__rowResize,"c.mergechange":this.__mergeChange})},getRowHeight:function(a){var b=this.dataAccess.getAutoSize(a);return void 0===b&&(b=this.__calculateRowHeight(a),this.dataAccess.setAutoSize(b,a)),b},__calculateRowHeight:function(a){for(var b,e,f,g,h=this.dataAccess.getTotalIndex(),i=this.sizeRecord,j=h.col,k=0,l=0;j>=l;l++)b=this.wraptext.getDisplayValue(a,l),b&&(g=this.styleModule.getComputedStyle("alignments",a,l),this.dataAccess.isMergeCell(a,l)||(i[a]&&i[a][l]?f=i[a][l]:(e=this.styleModule.getComputedStyle("fonts",a,l),f=Math.ceil(e.size*d*b.split("\n").length),f+=2*c),k=Math.max(k,f)));return k},__contentChange:function(a,b){var c=a,d=b;if(isNaN(+a))for(var e=c.row,f=d.row;f>=e;e++)for(var g=c.col,h=d.col;h>=g;g++)this.__clear(e,g);else this.__clear(a,b)},__styleChange:function(a,b){for(var c=a.row,d=b.row;d>=c;c++)for(var e=a.col,f=b.col;f>=e;e++)this.__clear(c,e)},__mergeChange:function(a,b){for(var c=a.row,d=b.row;d>=c;c++)for(var e=a.col,f=b.col;f>=e;e++)this.__clear(c,e)},__columnResize:function(a){for(var b=this.dataAccess.getTotalIndex(),c=0,d=b.row;d>=c;c++)this.__clear(c,a)},__rowResize:function(a){for(var b=this.dataAccess.getTotalIndex(),c=0,d=b.col;d>=c;c++)this.__clear(a,c)},__clear:function(a,b){var c=this.sizeRecord;this.dataAccess.resetAutoSize(a),c[a]&&c[a][b]&&(c[a][b]=void 0)}});return e.deps=["dataAccess","style","wraptext"],e}},b[17]={value:function(){var a=b.r(37),c=b.r(0).create("Border",{dataAccess:null,base:b.r(138),init:function(a){this.dataAccess=a,this.initService()},initService:function(){this.registerService({"c.set.border":this.setBorder,"c.clear.border":this.clearBorder,"c.outer.border":this.setOuterBorder})},getBorder:function(a,b){return this.dataAccess.getBorder(a,b)},getBorders:function(a,b){return this.dataAccess.getBorders(a,b)},setBorder:function(a,b,c){this.dataAccess.setBorder(a,b,c),this.coreRefresh(!0)},clearBorder:function(a,b){this.dataAccess.clearBorder(a,b),this.coreRefresh(!0)},setOuterBorder:function(b,c,d){var e=a.formatCellIndex(c,d);this.dataAccess.setOuterBorder(b,e.start,e.end),this.coreRefresh(!0)}});return c.deps=["dataAccess"],c}},b[18]={value:function(){var a=b.r(2),c=b.r(0).create("Cell",{contentPanel:null,$contentPanel:null,style:null,dataAccess:null,valueModule:null,autosize:null,base:b.r(138),init:function(b,c,d,e){this.dataAccess=b,this.valueModule=c,this.style=d,this.autosize=e,this.contentPanel=this.createElement("div","btb-core-content"),this.$contentPanel=a(this.contentPanel),this.getContentContainer().appendChild(this.contentPanel),this.initService()},initService:function(){this.registerService({"c.exchange.row":this.exchangeRow,"c.exchange.column":this.exchangeColumn,"c.resize.column":this.resizeCol,"c.resize.row":this.resizeRow,"c.cell.merge":this.merge,"c.cell.unmerge":this.unmergeCell,"c.is.merge.cell":this.isMergeCell,"c.has.merge.cell":this.hasMergeCell,"c.get.merge.cell":this.getMergeCell,"c.standard.cell.range":this.standardCellRange,"c.merge.cells.in.range":this.getMergeCellsInRange,"c.set.horizontal.merge":this.horizontalMerge,"c.set.vertical.merge":this.verticalMerge})},getAllMergeCell:function(){return this.dataAccess.getMergeCell()},getMergeCell:function(a,b){return this.dataAccess.getMergeCell(a,b)},getMergeCellsInRange:function(a){return this.dataAccess.getMergeCellsInRange(a)},merge:function(a){this.dataAccess.setMerge(a),this.postMessage("c.mergechange",a.start,a.end),this.coreRefresh(!0)},unmergeCell:function(a){this.dataAccess.unmergeCell(a),this.postMessage("c.mergechange",a.start,a.end),this.coreRefresh(!0)},horizontalMerge:function(a){this.dataAccess.setHorizontalMerge(a),this.postMessage("c.mergechange",a.start,a.end),this.coreRefresh(!0)},verticalMerge:function(a){this.dataAccess.setVerticalMerge(a),this.postMessage("c.mergechange",a.start,a.end),this.coreRefresh(!0)},getRowHeight:function(a){var b=this.dataAccess.getRowHeight(a);return void 0!==b?b:(b=this.autosize.getRowHeight(a),Math.max(this.getConfig("cell").height,b))},getColumnWidth:function(a){var b=this.getConfig("cell"),c=this.dataAccess.getColumnWidth(a);return void 0===c?b.width:c},isMergeCell:function(a,b){return this.dataAccess.isMergeCell(a,b)},hasMergeCell:function(a){return this.dataAccess.hasMergeCell(a)},resizeRow:function(a,b){this.dataAccess.setRowHeight(a,b),this.postMessage("c.rowresize",b),this.coreRefresh(!0)},resizeCol:function(a,b){this.dataAccess.setColumnWidth(a,b),this.postMessage("c.columnresize",b),this.coreRefresh(!0)},exchangeRow:function(a,b){this.dataAccess.exchangeRow(a,b),this.coreRefresh(!0)},exchangeColumn:function(){},standardCellRange:function(a,b){for(var c,d=a.row,e=b.row,f=a.col,g=b.col,h=f,i=g;i>=h;h++){if(c=this.getMergeCell(d,h),c&&c.start.row!==d)return this.standardCellRange({row:c.start.row,col:f},b);if(c=this.getMergeCell(e,h),c&&c.end.row!==e)return this.standardCellRange(a,{row:c.end.row,col:g})}for(var h=d,i=e;i>=h;h++){if(c=this.getMergeCell(h,f),c&&c.start.col!==f)return this.standardCellRange({row:d,col:c.start.col},b);if(c=this.getMergeCell(h,g),c&&c.end.col!==g)return this.standardCellRange(a,{row:e,col:c.end.col})}return{start:{row:d,col:f},end:{row:e,col:g}}},isSameMergeCell:function(){return this.dataAccess.isSameMergeCell(arguments)}});return c.deps=["dataAccess","value","style","autosize"],c}},b[19]={value:function(){var a={color:"color",fontsize:"fontSize",font:"fontFamily",bold:"fontWeight",italic:"fontStyle",fill:"backgroundColor",underline:"underline",throughline:"throughline",horizontal:"textAlign",vertical:"verticalAlign"};return b.r(0).create("BatchStyleCommand",{name:"columnstyle rowstyle",base:b.r(141),execBefore:function(){var a=[].slice.call(arguments,1);switch(a[0]){case"bold":a[1]=a[1]?"bold":void 0;break;case"italic":a[1]=a[1]?"italic":void 0}return a},execute:function(a){return this[a].apply(this,[].slice.call(arguments,1))},columnstyle:function(b,c,d,e){return(b=a[b])?(this.rs("c.set.column.style",b,c,d,e),void this.coreRefresh(!0)):!1},rowstyle:function(b,c,d,e){return(b=a[b])?(this.rs("c.set.row.style",b,c,d,e),void this.coreRefresh(!0)):!1}})}},b[20]={value:function(){return b.r(0).create("BorderCommand",{name:"border clearborder outerborder",base:b.r(141),execute:function(a){return this[a].apply(this,[].slice.call(arguments,1))},border:function(a,b,c){var d=this.__getCells(b,c);this.rs("c.setstyle","border",a,d.start,d.end)},clearborder:function(a,b){var c=this.__getCells(a,b);this.rs("c.setstyle","border",null,c.start,c.end)},outerborder:function(a,b,c){var d=this.__getCells(b,c);this.rs("c.outer.border",a,d.start,d.end)},__getCells:function(a,b){if(void 0===a){var c=this.rs("c.range");return c.isValid()?{start:c.getStart(),end:c.getEnd()}:null}return{start:a,end:b}}})}},b[21]={value:function(){return b.r(0).create("ClearCommand",{name:"clearcontent clearstyle clearall",base:b.r(141),execBefore:function(a,b,c){var d=this.__getRanges(b,c);return[d]},execute:function(a){return this[a].apply(this,[].slice.call(arguments,1))},clearcontent:function(a){this.rs("c.clear.content",a)},clearstyle:function(a){this.rs("c.clear.style",a[0].start,a[0].end)},clearall:function(a){this.corePrepareRefresh(),this.clearcontent(a),this.clearstyle(a),this.coreRefresh()},__getRanges:function(a,b){var c;return void 0===a?(c=this.rs("c.range"),c.getAllSelection()):isNaN(+a)?$.isArray(a)?a:[{start:a,end:b}]:[{start:{row:a,col:b},end:{row:a,col:b}}]}})}},b[22]={value:function(){return b.r(0).create("RangeCommand",{base:b.r(134),name:"comments",execute:function(a,b,c,d){this.rs("c.set.comments",b,c,d)},queryValue:function(a,b,c){return this.rs("c.clear.comments",b,c)}})}},b[23]={value:function(){return b.r(0).create("WriteCommand",{base:b.r(141),name:"content write batchwrite",execBefore:function(a,b,c,d){var e=this.__getCells(c,d);return[b,e.row,e.col]},execute:function(a,b,c,d){return"write"===a?this.rs("c.write",b,c,d):"batchwrite"!==a?this.rs("c.content",c,d):void this.rs("c.batchwrite",b,c,d)},unexecute:function(a,b,c,d){this.rs("c.write",b,c,d)},getStackInfo:function(a,b,c,d){var e=this.rs("c.struct");return b=e.getRawValue(c,d),[b,c,d]},__getCells:function(a,b){if(void 0===a){var c=this.rs("c.range");return c.isValid()?c.getFocus():null}return isNaN(+a)?void 0:{row:a,col:b}}})}},b[24]={value:function(){return b.r(0).create("ExportCommand",{base:b.r(134),name:"export",execute:function(a){return this[a].apply(this,[].slice.call(arguments,1))},"export":function(){return this.rs("c.exportworkbook")}})}},b[25]={value:function(){return b.r(0).create("FormatCommand",{base:b.r(134),name:"format",execBefore:function(a,b,c,d){var e=this.__getRanges(c,d);return[b,e.start,e.end]},execute:function(a){return this[a].apply(this,[].slice.call(arguments,1))},format:function(a,b,c){this.rs("c.set.format",a,b,c)},__getRanges:function(a,b){if(void 0===a){var c=this.rs("c.range");return c.isValid()?{start:c.getStart(),end:c.getEnd()}:null}return $.isNumeric(a)?{start:{row:a,col:b},end:{row:a,col:b}}:{start:a,end:b}}})}},b[26]={value:function(){return b.r(0).create("InitCommand",{base:b.r(134),name:"init load",execute:function(a,b){this.rs("c.load",b)}})}},b[27]={value:function(){return b.r(0).create("MergeCommand",{name:"merge verticalmerge horizontalmerge centermerge unmerge",base:b.r(141),execBefore:function(a,b,c){return[this.__getCells(b,c)]},execute:function(a){return this[a].apply(this,[].slice.call(arguments,1))},centermerge:function(a){this.rs("c.has.merge.cell",a)?this.rs("c.cell.unmerge",a):(this.rs("c.cell.merge",a),this.execCommand("horizontal","center",a.start,a.end)),this.rs("c.range.set",a.start,a.start,a.end)},merge:function(a){this.rs("c.cell.merge",a)},unmerge:function(a){this.rs("c.cell.unmerge",a)},verticalmerge:function(a){this.rs("c.set.vertical.merge",a)},horizontalmerge:function(a){this.rs("c.set.horizontal.merge",a)},__getCells:function(a,b){if(void 0===a){var c=this.rs("c.range");return c.isValid()?{start:c.getStart(),end:c.getEnd()}:null}var d=this.cs("c.cell.compare",a,b);return{start:d.min,end:d.max}}})}},b[28]={value:function(){return b.r(0).create("MoveCommand",{base:b.r(134),name:"moveright moveup movedown moveleft",execute:function(a,b){this[a](b)},moveright:function(a){var b=this.rs("c.range"),c=b.getOriginalFocus();this.corePrepareRefresh();var d=this.rs("c.range.right",a);this.__updateView(c.row,d),this.coreRefresh()},moveleft:function(a){var b=this.rs("c.range"),c=b.getOriginalFocus();this.corePrepareRefresh();var d=this.rs("c.range.left",a);this.__updateView(c.row,d),this.coreRefresh()},moveup:function(a){var b=this.rs("c.range"),c=b.getOriginalFocus();this.corePrepareRefresh();var d=this.rs("c.range.up",a);this.__updateView(d,c.col),this.coreRefresh()},movedown:function(a){var b=this.rs("c.range"),c=b.getOriginalFocus();this.corePrepareRefresh();var d=this.rs("c.range.down",a);this.__updateView(d,c.col),this.coreRefresh()},__updateView:function(a,b){var c=this.rs("c.struct");switch(c.getViewPosition(a,b)){case"leftTop":this.rs("c.updateview",{rowTo:a,columnTo:b});break;case"leftBottom":this.rs("c.updateview",{rowToEnd:a,columnTo:b});break;case"rightTop":this.rs("c.updateview",{rowTo:a,columnToEnd:b});break;case"rightBottom":this.rs("c.updateview",{rowToEnd:a,columnToEnd:b});break;case"left":this.rs("c.col.scrollto",b);break;case"top":this.rs("c.row.scrollto",a);break;case"bottom":this.rs("c.scroll.row.to.end",a);break;case"right":this.rs("c.scroll.column.to.end",b);break;case"in":}}})}},b[29]={value:function(){return b.r(0).create("NumberFormatCommand",{base:b.r(141),execBefore:function(){var a,b=[];return a=this.__getCells(arguments[2],arguments[3]),b[0]=arguments[1],b[1]=a.start,b[2]=a.end,b},execute:function(a,b,c,d){this.rs("c.numberformat",b,c,d)},__getCells:function(a,b){if(void 0===a){var c=this.rs("c.range");return c.isValid()?{start:c.getStart(),end:c.getEnd()}:null}if($.isNumeric(a))return{start:{row:a,col:b},end:{row:a,col:b}};var d=this.cs("c.cell.compare",a,b);return{start:d.min,end:d.max}}})}},b[30]={value:function(){return b.r(0).create("RangeCommand",{base:b.r(134),name:"focus expandright expandleft expanddown expandup selectall selectcolumn selectrow",execute:function(a){this[a].apply(this,[].slice.call(arguments,1))},focus:function(a,b){this.__update(a,b),this.rs("c.range.focus",a,b)},selectall:function(){this.rs("c.select.all")},selectcolumn:function(a,b){this.rs("c.select.column",a,b)
},selectrow:function(a,b){this.rs("c.select.row",a,b)},expandright:function(a){this.rs("c.selection.expand.right",a);var b=this.rs("c.range"),c=b.getFocus(),b=this.rs("c.range"),d=b.getStart(),e=b.getEnd();d.col===c.col?this.__update(e.row,e.col):this.__update(d.row,d.col)},expandleft:function(a){this.rs("c.selection.expand.left",a);var b=this.rs("c.range"),c=b.getFocus(),b=this.rs("c.range"),d=b.getStart(),e=b.getEnd();d.col===c.col?this.__update(e.row,e.col):this.__update(d.row,d.col)},expanddown:function(a){this.rs("c.selection.expand.down",a);var b=this.rs("c.range"),c=b.getFocus(),b=this.rs("c.range"),d=b.getStart(),e=b.getEnd();d.row===c.row?this.__update(e.row,e.col):this.__update(d.row,d.col)},expandup:function(a){this.rs("c.selection.expand.up",a);var b=this.rs("c.range"),c=b.getFocus(),b=this.rs("c.range"),d=b.getStart(),e=b.getEnd();d.row===c.row?this.__update(e.row,e.col):this.__update(d.row,d.col)},__update:function(a,b){var c=(this.rs("c.range"),this.rs("c.struct")),d=c.getViewStart(),e=c.getViewEnd(),f=[];a<d.row?f.push({command:"scrollrowto",args:[a]}):a>=e.row&&f.push({command:"scrollrowto",args:[a,!0]}),b<d.col?f.push({command:"scrollcolumnto",args:[b]}):b>=e.col&&f.push({command:"scrollcolumnto",args:[b,!0]}),f.length&&this.execCommand(f)}})}},b[31]={value:function(){return b.r(0).create("FormatCommand",{base:b.r(134),name:"readonly",execute:function(a,b){this.rs("c.set.readonly",!!b)},queryValue:function(){return this.rs("c.is.readonly")}})}},b[32]={value:function(){return b.r(0).create("ResizeCommand",{name:"resizerow resizecol",base:b.r(141),execute:function(a,b,c){return"resizerow"===a?this.rs("c.resize.row",b,c):this.rs("c.resize.column",b,c)},unexecute:function(a,b,c){return this.execute(a,b,c)},getStackInfo:function(a,b,c){var b,d=this.rs("c.struct");return b="resizerow"===a?d.getRawRowHeight(c):d.getRawColumnWidth(c),[b,c]}})}},b[33]={value:function(){return b.r(0).create("ScrollCommand",{base:b.r(134),name:"scroll scrollto scrollrowto scrollcolumnto scrollrow scrollcolumn updateview",execute:function(a,b,c){this[a](b,c)},scroll:function(a,b){return this.rs("c.scroll",a,b)},scrollto:function(a,b){return this.rs("c.scrollto",a,b)},scrollrowto:function(a,b){return this.rs("c.row.scrollto",a,!!b)},scrollcolumnto:function(a,b){return this.rs("c.col.scrollto",a,!!b)},scrollrow:function(a){return this.rs("c.row.scroll",a)},scrollcolumn:function(a){return this.rs("c.col.scroll",a)},updateview:function(a){return this.rs("c.updateview",a)}})}},b[34]={value:function(){return b.r(0).create("StyleCommand",{name:"createsheet switchsheet sheetname sheetnames sheetindex importsheet",base:b.r(141),execute:function(a){return this[a].apply(this,[].slice.call(arguments,1))},createsheet:function(a){this.rs("c.createsheet",a)},switchsheet:function(a){this.rs("c.switchsheet",a)},importsheet:function(a,b){this.rs("c.importsheet",a,b)},queryValue:function(a){return this["query"+a].apply(this,[].slice.call(arguments,1))},querysheetname:function(){return this.rs("c.get.sheetname")},querysheetnames:function(){return this.rs("c.get.sheetnames")},querysheetindex:function(){return this.rs("c.get.sheetindex")}})}},b[35]={value:function(){return b.r(0).create("StyleCommand",{name:"color fontsize font bold italic fill horizontal vertical underline throughline wraptext cellstyles",base:b.r(141),execBefore:function(a){var b,c=[];switch(a){case"bold":case"underline":case"throughline":case"italic":case"wraptext":b=this.__getCells(arguments[1],arguments[2]),c[0]=b.start,c[1]=b.end;break;default:b=this.__getCells(arguments[2],arguments[3]),c[0]=arguments[1],c[1]=b.start,c[2]=b.end}return c},queryValueBefore:function(){if(void 0!==arguments[1])return[arguments[1],arguments[2]];var a=this.rs("c.range");if(!a.isValid())return!1;var b=a.getFocus();return[b.row,b.col]},execute:function(a){return this[a].apply(this,[].slice.call(arguments,1))},queryValue:function(a){return this["query"+a].apply(this,[].slice.call(arguments,1))},color:function(a,b,c){this.rs("c.setstyle","color",a,b,c)},fontsize:function(a,b,c){this.rs("c.setstyle","size",a,b,c)},font:function(a,b,c){this.rs("c.setstyle","name",a,b,c)},italic:function(a,b){var c=this.rs("c.struct"),d=c.getUserStyle("fonts",a.row,a.col);d&&d.italic?this.rs("c.setstyle","italic",!1,a,b):this.rs("c.setstyle","italic",!0,a,b)},bold:function(a,b){var c=this.rs("c.struct"),d=c.getUserStyle("fonts",a.row,a.col);d&&d.bold?this.rs("c.setstyle","bold",!1,a,b):this.rs("c.setstyle","bold",!0,a,b)},wraptext:function(a,b){var c=this.rs("c.struct"),d=c.getUserStyle("alignments",a.row,a.col);d&&d.wraptext?this.rs("c.setstyle","wraptext",!1,a,b):this.rs("c.setstyle","wraptext",!0,a,b)},underline:function(a,b){var c=this.rs("c.struct"),d=c.getUserStyle("fonts",a.row,a.col);d&&d.underline?this.rs("c.setstyle","underline",!1,a,b):this.rs("c.setstyle","underline",!0,a,b)},throughline:function(a,b){var c=this.rs("c.struct"),d=c.getUserStyle("fonts",a.row,a.col);d&&d.throughline?this.rs("c.setstyle","throughline",!1,a,b):this.rs("c.setstyle","throughline",!0,a,b)},fill:function(a,b,c){this.rs("c.setstyle","fill",a,b,c)},horizontal:function(a,b,c){this.rs("c.setstyle","horizontal",a,b,c)},vertical:function(a,b,c){this.rs("c.setstyle","vertical",a,b,c)},cellstyles:function(a,b,c){this.rs("c.struct");this.rs("c.set.cellstyles",a,b,c)},queryfont:function(a,b){var c=this.rs("c.struct"),d=c.getUserStyle("fonts",a,b);return d&&"none"!==d.name?d.name:void 0},querycolor:function(a,b){var c=this.rs("c.struct"),d=c.getUserStyle("fonts",a,b);return d&&"none"!==d.color?d.color:void 0},queryfontsize:function(a,b){var c=this.rs("c.struct"),d=c.getUserStyle("fonts",a,b);return d&&"none"!==d.size?d.size:void 0},querybold:function(a,b){var c=this.rs("c.struct"),d=c.getUserStyle("fonts",a,b);return d?!!d.bold:!1},querywraptext:function(a,b){var c=this.rs("c.struct"),d=c.getUserStyle("alignments",a,b);return d?!!d.wraptext:!1},queryunderline:function(a,b){var c=this.rs("c.struct"),d=c.getUserStyle("fonts",a,b);return d?!!d.underline:!1},querythroughline:function(a,b){var c=this.rs("c.struct"),d=c.getUserStyle("fonts",a,b);return d?!!d.throughline:!1},queryitalic:function(a,b){var c=this.rs("c.struct"),d=c.getUserStyle("fonts",a,b);return d?!!d.italic:!1},queryfill:function(a,b){var c=this.rs("c.struct"),d=c.getUserStyle("fills",a,b);return d&&"none"!==d.fill?d.fill:void 0},queryhorizontal:function(a,b){var c=this.rs("c.struct"),d=c.getUserStyle("alignments",a,b);return d&&"none"!==d.horizontal?d.horizontal:void 0},queryvertical:function(a,b){var c=this.rs("c.struct"),d=c.getUserStyle("alignments",a,b);return d&&"none"!==d.vertical?d.vertical:void 0},__getCells:function(a,b){if(void 0===a){var c=this.rs("c.range");return c.isValid()?{start:c.getStart(),end:c.getEnd()}:null}if($.isNumeric(a))return{start:{row:a,col:b},end:{row:a,col:b}};var d=this.cs("c.cell.compare",a,b);return{start:d.min,end:d.max}}})}},b[36]={value:function(){var a=b.r(0).create("Comments",{cache:null,cellModule:null,base:b.r(138),init:function(a,b){this.dataAccess=a,this.cellModule=b,this.initService(),this.initMessageHook()},initService:function(){this.registerService({"c.set.comments":this.setComments,"c.get.comments":this.getComments,"c.clear.comments":this.clearComments})},initMessageHook:function(){this.onMessage({"c.refresh":this.refresh})},refresh:function(){this.cache=null},getCommentsInView:function(){if(this.cache)return this.cache;for(var a,b,c,d,e,f=this.cellModule,g={},h=this.dataAccess.getGrid(),i=h.rowMap,j=h.colMap,k={},l=0,m=i.length;m>l;l++){a=i[l];for(var n=0,o=j.length;o>n;n++)b=j[n],d=f.getMergeCell(a,b),d&&(a=d.start.row,b=d.start.col),e=a+","+b,k[e]||(k[e]=!0,c=this.dataAccess.getComments(a,b),c&&(g[a+","+b]={row:a,col:b,content:c}))}return this.cache=g,g},getComments:function(a,b){return this.dataAccess.getComments(a,b)},setComments:function(a,b,c){this.dataAccess.setComments(a,b,c),this.coreRefresh(!0)},clearComments:function(a,b){this.dataAccess.clearComments(a,b),this.coreRefresh(!0)}});return a.deps=["dataAccess","cell"],a}},b[37]={value:function(){b.r(2);return{formatCellIndex:function(a,b){return void 0!==b?"number"==typeof a?{row:a,col:b}:{start:{row:a.row,col:a.col},end:{row:b.row,col:b.col}}:a}}}},b[38]={value:function(){return{auto:{},formula:{},type:{},viewStart:{row:0,col:0},focus:{row:-1,col:-1},originalFocus:{row:-1,col:-1},selections:[],viewEnd:{row:0,col:0},grid:{},effective:{row:0,col:0},visibleCount:{},offset:0,borderWidth:1,writable:!1,boundary:{},space:{},local:{},wraptextRecord:{},computedValue:{},formattedValue:{},standardValue:{},formatColor:{},formulaToken:[],formulaValue:[],formulaToCellRel:[],cellToFormulaRel:{row:{},column:{},cell:[]}}}},b[39]={value:function(){var a=b.r(38),c=b.r(14),d=b.r(151);return b.r(0).create("DataAccess",$.extend({base:b.r(138),data:null,init:function(){this.importWorkbook(this.createWorkbook())},createWorkbook:function(){var a=this.kernelCreateWorkbook();return this.__extendData(a),a},createSheet:function(){var b=this.kernelCreateSheet();return $.extend(b,$._clone(a)),b},importWorkbook:function(a){a=this.kernelImportWorkbook(a),this.__extendData(a),this.data=a},importSheet:function(b,c){c=this.kernelImportSheet(c),this.kernelInertSheet(b,c),$.extend(c,$._clone(a))},exportWorkbook:function(){return this.kernelExportWorkbook()},__extendData:function(b){for(var c=b.sheets,d=0,e=c.length;e>d;d++)$.extend(c[d],$._clone(a))},getGrid:function(){return this.kernelGetActiveData().grid},getSheetName:function(){return this.kernelGetSheetName()},getSheetNames:function(){return this.kernelGetSheetNames()},getSheetIndex:function(){return this.kernelGetSheetIndex()},getPane:function(){return this.kernelGetPane()},getOffset:function(){return c.border.offset},getViewStart:function(){return this.kernelGetActiveData().viewStart},getViewEnd:function(){return this.kernelGetActiveData().viewEnd},getVisibleCount:function(){return this.kernelGetActiveData().visibleCount},getBorderWidth:function(){return c.border.width},getTotal:function(){return this.kernelGetTotal()},getTotalIndex:function(){return this.kernelGetTotalIndex()},getBoundary:function(){return this.kernelGetActiveData().boundary},getSpace:function(){return this.kernelGetActiveData().space},getAutoSize:function(a){return this.kernelGetActiveData().auto[a]},getColumnWidth:function(a){return this.kernelGetColumnWidth(a)},getRowHeight:function(a){return this.kernelGetRowHeight(a)},getComputedValue:function(a,b){return this.kernelGetActiveData().computedValue[this.indexToKey(a,b)]},getFormattedValue:function(a,b){return this.kernelGetActiveData().formattedValue[this.indexToKey(a,b)]},getStandardValue:function(a,b){return this.kernelGetActiveData().standardValue[this.indexToKey(a,b)]},getNumberFormat:function(a,b){return this.kernelGetNumberFormat(a,b)},getDefaultStyle:function(a){return this.kernelGetDefaultStyle(a)},getValue:function(a,b){return this.kernelGetValue(a,b)},getStyle:function(a,b,c){return this.kernelGetStyle(a,b,c)},getStyleById:function(a,b){return this.kernelGetStyleById(a,b)},getStyleIds:function(a,b,c){return this.kernelGetStyleIds(a,b,c)},getEffectiveIndex:function(){var a=this.kernelGetActiveData().effective;return{row:a.row,col:a.col}},getDimension:function(){return this.kernelGetDimension()},getCellType:function(a,b){return this.kernelGetCellType(a,b)},getBorder:function(a,b){return this.kernelGetBorder(a,b)},getBorders:function(a,b){return this.kernelGetBorders(a,b)},getMergeCell:function(a,b){return this.kernelGetMergeCell(a,b)},getMergeCellsInRange:function(a){return this.kernelGetMergeCellsInRange(a)},isMergeCell:function(a,b){return this.kernelIsMergeCell(a,b)},isReadonly:function(){return this.data.readonly},hasMergeCell:function(a){return this.kernelHasMergeCellInRange(a)},isSameMergeCell:function(a){return this.kernelIsSameMergeCell(a)},getWraptextRecord:function(a,b){return this.kernelGetActiveData().wraptextRecord[this.indexToKey(a,b)]},getFormatColor:function(a,b){return this.kernelGetActiveData().formatColor[this.indexToKey(a,b)]},clearContent:function(a){this.kernelClearValue(a)},switchSheet:function(a){this.kernelSwitchSheet(a)},setTotal:function(a,b){this.kernelSetTotal(a,b)},addSheetName:function(a){return this.kernelAddSheetName(a)},setSpace:function(a,b){this.kernelGetActiveData().space={width:a,height:b}},setGrid:function(a){this.kernelGetActiveData().grid=a},setNumberFormat:function(a,b,c){this.kernelSetNumberFormat(a,b,c)},clearNumberFormat:function(a,b){this.kernelClearNumberFormat(a,b)},setBorder:function(a,b,c){this.kernelSetBorder(a,b,c)},setOuterBorder:function(a,b,c){this.kernelSetOuterBorder(a,b,c)},clearBorder:function(a,b){this.kernelClearBorder(a,b)},setVisibleCount:function(a,b){this.kernelGetActiveData().visibleCount={row:a,col:b}},setViewStart:function(a,b){this.kernelGetActiveData().viewStart={row:a,col:b}},setViewStartRow:function(a){this.kernelGetActiveData().viewStart.row=a},setViewStartCol:function(a){this.kernelGetActiveData().viewStart.col=a},setViewEnd:function(a,b){this.kernelGetActiveData().viewEnd={row:a,col:b}},setComputedValue:function(a,b,c){a?this.kernelGetActiveData().computedValue[this.indexToKey(b,c)]=a:this.clearComputedValue(b,c)},clearComputedValue:function(a,b){this.kernelGetActiveData().computedValue[this.indexToKey(a,b)]=void 0},setFormattedValue:function(a,b,c){a?this.kernelGetActiveData().formattedValue[this.indexToKey(b,c)]=a:this.clearFormattedValue(b,c)},clearFormattedValue:function(a,b){this.kernelGetActiveData().formattedValue[this.indexToKey(a,b)]=void 0},setFormatColor:function(a,b,c){a?this.kernelGetActiveData().formatColor[this.indexToKey(b,c)]=a:this.clearFormatColor(b,c)},clearFormatColor:function(a,b){this.kernelGetActiveData().formatColor[this.indexToKey(a,b)]=void 0},setStandardValue:function(a,b,c){a?this.kernelGetActiveData().standardValue[this.indexToKey(b,c)]=a:this.clearStandardValue(b,c)},setReadonly:function(a){this.data.readonly=!!a},clearStandardValue:function(a,b){this.kernelGetActiveData().standardValue[this.indexToKey(a,b)]=void 0},setBoundary:function(a,b){this.kernelGetActiveData().boundary={width:a,height:b}},setCellType:function(a,b,c){this.kernelSetCellType(a,b,c)},clearCellType:function(a,b){this.kernelClearCellType(a,b)},setMerge:function(a){return this.kernelSetMerge(a)},unmergeCell:function(a){return this.kernelUnmerge(a)},setHorizontalMerge:function(a){return this.kernelSetHorizontalMerge(a)},setVerticalMerge:function(a){return this.kernelSetVerticalMerge(a)},setValue:function(a,b,c){var d=this.kernelGetActiveData().effective;return this.kernelSetValue(a,b,c),a?(d.row=Math.max(d.row,b),void(d.col=Math.max(d.col,c))):void 0},clearValue:function(a,b){this.setValue(void 0,a,b)},batchSetValue:function(a,b,c){this.kernelBatchSetValue(a,b,c)},setStyle:function(){this.kernelSetStyle.apply(this,arguments)},batchSetStyle:function(a,b,c){this.kernelBatchSetStyle(a,b,c)},setCellStyles:function(a,b,c){this.kernelSetXfStyle(a,b,c)},clearStyle:function(){this.kernelClearStyle.apply(this,arguments)},setColumnStyle:function(){this.kernelSetColumnStyle.apply(this,arguments)},setRowStyle:function(){this.kernelSetRowStyle.apply(this,arguments)},setAutoSize:function(a,b){this.kernelGetActiveData().auto[b]=a||void 0},clearAutoSize:function(){this.kernelGetActiveData().auto={}},resetAutoSize:function(a){this.kernelGetActiveData().auto[a]=void 0},setColumnWidth:function(a,b){this.kernelSetColumnWidth(a,b)},setRowHeight:function(a,b){this.kernelSetRowHeight(a,b)},recordWraptext:function(a,b,c){this.kernelGetActiveData().wraptextRecord[this.indexToKey(b,c)]=a},clearWraptextRecord:function(a,b){this.kernelGetActiveData().wraptextRecord[this.indexToKey(a,b)]=void 0},exchangeRow:function(a,b){var c=this.kernelGetActiveData().auto;this.kernelExchangeRow(a,b),d.exchangeRow(this.data.type,a,b);for(var e=b.start.row,f=b.end.row;f>=e;e++)c[e]=void 0}},b.r(162),b.r(43),b.r(42),b.r(40),b.r(41)))}},b[40]={value:{getComments:function(a,b){return this.kernelGetComments(a,b)},setComments:function(a,b,c){return this.kernelSetComments(a,b,c)},clearComments:function(a,b){return this.kernelClearComments(a,b)}}},b[41]={value:{expandRow:function(a){this.kernelExpandRow(a)},expandCol:function(a){this.kernelExpandCol(a)}}},b[42]={value:{getArrayReference:function(a,b){return this.kernelGetArrayReference(a,b)},setArrayReference:function(a,b){this.kernelSetArrayReference(a,b)},clearArrayReference:function(a,b){this.kernelClearArrayReference(a,b)},getFormulaToken:function(a,b){var c=this.kernelGetActiveData().formulaToken;return c[a]&&c[a][b]?c[a][b]:void 0},setFormulaToken:function(a,b,c){c||this.clearFormulaToken(a,b);var d=this.kernelGetActiveData().formulaToken,e=d[a];e||(d[a]=[],e=d[a]),e[b]=c},clearFormulaToken:function(a,b){var c=this.kernelGetActiveData().formulaToken;c[a]&&c[a][b]&&(c[a][b]=void 0)},getFormulaValue:function(a,b){var c=this.kernelGetActiveData().formulaValue;return c[a]&&c[a][b]?c[a][b]:void 0},setFormulaValue:function(a,b,c){c||this.clearFormulaValue(a,b);var d=this.kernelGetActiveData().formulaValue,e=d[a];e||(d[a]=[],e=d[a]),e[b]=c},clearFormulaValue:function(a,b){var c=this.kernelGetActiveData().formulaValue;c[a]&&c[a][b]&&(c[a][b]=void 0)},getFormulaToCellRel:function(a,b){var c=this.kernelGetActiveData().formulaToCellRel;return c[a]&&c[a][b]?c[a][b]:void 0},setFormulaToCellRel:function(a,b,c){c||this.clearFormulaToCellRel(a,b);var d=this.kernelGetActiveData().formulaToCellRel,e=d[a];e||(d[a]=[],e=d[a]),e[b]=c},clearFormulaToCellRel:function(a,b){var c=this.kernelGetActiveData().formulaToCellRel;c[a]&&c[a][b]&&(c[a][b]=void 0)},getCellToFormulaRel:function(){return this.kernelGetActiveData().cellToFormulaRel}}},b[43]={value:{getFocus:function(){return this.kernelGetActiveData().focus},getStart:function(){return this.kernelGetActiveData().selections[0].start},getEnd:function(){return this.kernelGetActiveData().selections[0].end},getSelection:function(){return this.kernelGetActiveData().selections},getOriginalFocus:function(){return this.kernelGetActiveData().originalFocus},setFocus:function(a,b){this.kernelGetActiveData().focus={row:a,col:b}},setOriginalFocus:function(a,b){this.kernelGetActiveData().originalFocus={row:a,col:b}},setSelection:function(a,b){this.kernelGetActiveData().selections[0]={start:{row:a.row,col:a.col},end:{row:b.row,col:b.col}}},getWritable:function(){return this.kernelGetActiveData().writable},setWritable:function(a){this.kernelGetActiveData().writable=a},clearRange:function(){var a=this.kernelGetActiveData();a.focus={row:-1,col:-1},a.originalFocus={row:-1,col:-1},a.selections=[]}}},b[44]={value:function(){var a=864e5,c=new Date(Date.UTC(1899,11,31,0,0,0));return b.r(0).create("DateTime",{base:b.r(138),dateValueOf:function(b){var d=new Date(b);return d=new Date(Date.UTC(d.getFullYear(),d.getMonth(),d.getDate(),0,0,0)),(d-c)/a+1}})}},b[45]={value:{ARRAY:"ARRAY",TEXT:"TEXT",NUMBER:"NUMBER",LOGICAL:"LOGICAL",ERROR:"ERROR",UNDEFINED:"UNDEFINED"}},b[46]={value:function(){return $.extend($._clone(b.r(45)),{UNION:"UNION",RANGE:"RANGE"})}},b[47]={value:{TYPE:{NOOP:"NOOP",OPERAND:"OPERAND",FUNCTION:"FUNCTION",SUBEXPR:"SUBEXPR",ARGUMENT:"ARGUMENT",OP_PRE:"OP_PRE",OP_IN:"OP_IN",OP_POST:"OP_POST",WSPACE:"WSPACE",UNKNOWN:"UNKNOWN",ARRAY:"ARRAY",ARRAYROW:"ARRAYROW",LEFT_BRACKET:"(",RIGHT_BRACKET:")"},SUBTYPE:{START:"START",STOP:"STOP",TEXT:"TEXT",NUMBER:"NUMBER",LOGICAL:"LOGICAL",ERROR:"ERROR",RANGE:"RANGE",MATH:"MATH",CONCAT:"CONCAT",INTERSECT:"INTERSECT",UNION:"UNION"}}},b[48]={value:function(){b.r(2);return b.r(0).create("Device",{contentPanel:null,$contentPanel:null,style:null,dataAccess:null,valueModule:null,base:b.r(138),init:function(){this.initService()},initService:function(){this.registerService({"c.zoom.refresh":this.refreshZoom,"c.update.viewport":this.updateViewport})},refreshZoom:function(){var a=Math.ceil(window.devicePixelRatio),b=this.getConfig();b.ZOOM!==a&&(b.ZOOM=a,this.postMessage("c.container.resize"),this.coreRefresh(!0))},updateViewport:function(){this.resizeContianer(),this.postMessage("c.container.resize"),this.coreRefresh(!0)}})}},b[49]={value:function(){var a=b.r(0).create("ExportManager",{dataAccess:null,base:b.r(138),init:function(a){this.dataAccess=a,this.initService()},initService:function(){this.registerService({"c.exportworkbook":this["export"]})},"export":function(){return this.dataAccess.exportWorkbook()}});return a.deps=["dataAccess"],a}},b[50]={value:function(){var a=b.r(0).create("Value",{base:b.r(138),init:function(){},isNumber:function(a){return $.isNumeric(a)},isDatetime:function(a){var b=a.split(/\s+/);if(b.length>2)return!1;1===b.length&&b.unshift("1970-1-1 ");var c=new Date(b.join(" "));return isNaN(c-0)?!1:!0},isFraction:function(a){return/^([\d]+ )?\d+\/\d+$/.test(a)}});return a.deps=["dataAccess","formula","valueSecurity"],a}},b[51]={value:function(){var a=b.r(47),c=a.TYPE,d=a.SUBTYPE;return{getCells:function(a){for(var b,e,f,g=[],h={},i=0,j=a.length;j>i;i++)if(b=a[i],b.type===c.OPERAND&&(b=b.value,b.type===d.RANGE||b.type===d.UNION)){e=b.value;for(var k=0,l=e.length;l>k;k++){f=e[k];for(var m=0,n=f.length;n>m;m++)g.push(f[m])}}for(var o,p,q=[],i=0,j=g.length;j>i;i++)o=g[i],p=o.row+","+o.col,h[p]||(h[p]=!0,q.push(o));return q}}}},b[52]={value:function(){function a(a,b,c,d){var f=a.getArrayReference(c,d);if(f)for(var g=f.start.row,h=f.end.row;h>=g;g++)for(var i=f.start.col,j=f.end.col;j>=i;i++)b.clearCache(g,i),a.clearFormulaValue(g,i),e(a,b,g,i);else a.clearFormulaValue(c,d),e(a,b,c,d)}function c(a,b,c,d){for(var e,g=a.getCellToFormulaRel(),h={row:[],column:[],cell:[]},i={row:b,col:c},j=f(b,c),k=0,l=d.length;l>k;k++)e=d[k],b=e.row,c=e.col,void 0===b?(g.column[c]||(g.column[c]={}),g.column[c][j]=i,h.column.push(c)):void 0===c?(g.row[b]||(g.row[b]={}),g.row[b][j]=i,h.row.push(b)):(g.cell[b]||(g.cell[b]={}),g.cell[b][c]||(g.cell[b][c]={}),g.cell[b][c][j]=i,h.cell.push({row:b,col:c}));return h}function d(a,b,c,d){if(d){for(var e,g=a.getCellToFormulaRel(),h=d.row,i=d.column,j=d.cell,k=f(b,c),l=0,m=h.length;m>l;l++)e=h[l],delete g.row[e][k];for(var l=0,m=i.length;m>l;l++)e=i[l],delete g.column[e][k];for(var l=0,m=j.length;m>l;l++)e=j[l],delete g.cell[e.row][e.col][k]}}function e(b,c,d,e){var f,g=b.getCellToFormulaRel(),h=g.row,i=g.column,j=g.cell;if(h[d]){h=h[d];for(var k in h)h.hasOwnProperty(k)&&(f=h[k],c.clearCache(f.row,f.col),a(b,c,f.row,f.col))}if(i[d]){i=i[d];for(var k in i)i.hasOwnProperty(k)&&(f=i[k],c.clearCache(f.row,f.col),a(b,c,f.row,f.col))}if(j[d]&&j[d][e]){j=j[d][e];for(var k in j)j.hasOwnProperty(k)&&(f=j[k],c.clearCache(f.row,f.col),a(b,c,f.row,f.col))}}function f(a,b){return a+","+b}var g=b.r(72),h=b.r(51),i=b.r(66),j=b.r(0).create("Formula",{dataAccess:null,valueModule:null,base:b.r(138),init:function(a){this.dataAccess=a,this.mathRuntime=this.createComponent(i)},bind:function(a){this.valueModule=a,this.mathRuntime.bind(a)},isArrayFormula:function(a,b){return!!this.dataAccess.getArrayReference(a,b)},getComputedValueInfo:function(a,b){var c=this.dataAccess.getFormulaValue(a,b);if(c)return c;var d=this.dataAccess.getArrayReference(a,b);if(d)return this.__getComputedArrayValueInfo(a,b,d);var e=this.getTokens(a,b),f=this.mathRuntime.exec(e);return this.dataAccess.setFormulaValue(a,b,f),f},__getComputedArrayValueInfo:function(a,b,c){for(var d,e,f=c.start.row,g=c.start.col,h=c.end.row,i=c.end.col,j=this.getTokens(f,g),k=this.mathRuntime.execArray(j,c.start,c.end),l=0,d=f,m=h-f;m>=l;l++,d++)for(var n=0,e=g,o=i-g;o>=n;n++,e++)this.dataAccess.setFormulaValue(d,e,k[l][n]);return k[a-f][b-g]},getTokens:function(a,b){var c=this.dataAccess.getFormulaToken(a,b);if(c)return c;var d=this.valueModule.getRawValue(a,b);return this.setFormula(a,b,d),this.dataAccess.getFormulaToken(a,b)},setArrayFormula:function(a,b,c){this.dataAccess.setArrayReference(a,b),this.setFormula(a.row,a.col,c)},setFormula:function(a,b,d){var e=g.parse(d),f=h.getCells(e);this.dataAccess.setFormulaToken(a,b,e);var i=c(this.dataAccess,a,b,f);this.dataAccess.setFormulaToCellRel(a,b,i)},clearFormula:function(a,b){var c=this.dataAccess.getArrayReference(a,b);if(c)for(var d=c.start.row,e=c.end.row;e>=d;d++)for(var f=c.start.col,g=c.end.col;g>=f;f++)this.__clearFormula(d,f);else this.__clearFormula(a,b)},__clearFormula:function(b,c){this.dataAccess.clearFormulaToken(b,c);var e=this.dataAccess.getFormulaToCellRel(b,c);this.dataAccess.clearFormulaToCellRel(b,c),d(this.dataAccess,b,c,e),a(this.dataAccess,this.valueModule,b,c)}});return j.deps=["dataAccess"],j}},b[53]={value:function(){function a(a,b){var c,d=0,e=0;if(a.type===b.ARRAY){a=a.value;for(var f=0,g=a.length;g>f;f++)switch(c=a[f],c.type){case b.NUMBER:d+=+c.value,e++;break;case b.ERROR:return c}}else switch(a.type){case b.NUMBER:d+=+a.value,e++;break;case b.ERROR:return a}return{value:d,count:e}}return{_all:!0,_error:!0,exec:function(b,c,d){for(var e,f,g=0,h=0,i=0,j=b.length;j>i;i++){if(e=b[i],e.type===c.ERROR)return e;if(f=a(e,c),f.type===c.ERROR)return f;g+=f.value,h+=f.count}return 0===h?{type:c.ERROR,value:d.DIV0}:{type:c.NUMBER,value:g/h+""}}}}},b[54]={value:function(){function a(a,b){var c=0;if(a.type===b.ARRAY){a=a.value;for(var d=0,e=a.length;e>d;d++)a[d].type===b.NUMBER&&c++}else a.type===b.NUMBER&&c++;return console.log(c),c}return{_all:!0,_error:!1,exec:function(b,c,d){for(var e,f=0,g=0,h=b.length;h>g;g++){if(e=b[g],e.type===d.ERROR)return e;switch(e.type){case d.NUMBER:case d.LOGICAL:f++;break;case d.TEXT:(c.isNumber(e.value)||c.isDatetime(e.value))&&f++}f+=a(e,d)}return{type:d.NUMBER,value:f+""}}}}},b[55]={value:function(){function a(a,b){var c=0;if(a.type===b.ARRAY){a=a.value;for(var d=0,e=a.length;e>d;d++)a[d].type===b.NUMBER&&c++}else a.type===b.NUMBER&&c++;return console.log(c),c}return{_all:!0,_error:!1,exec:function(b,c){for(var d,e=0,f=0,g=b.length;g>f;f++){if(d=b[f],d.type===c.ERROR)return d;e+=a(d,c)}return{type:c.NUMBER,value:e+""}}}}},b[56]={value:function(){function a(a,b){var c,d=0;if(a.type===b.ARRAY){a=a.value;for(var e=0,f=a.length;f>e;e++)switch(c=a[e],c.type){case b.NUMBER:d+=+c.value;break;case b.ERROR:return c}}else switch(a.type){case b.NUMBER:d+=+a.value;break;case b.ERROR:return a}return{value:d}}return{_all:!0,_error:!0,exec:function(b,c){for(var d,e,f=0,g=0,h=b.length;h>g;g++){if(d=b[g],d.type===c.ERROR)return d;if(e=a(d,c),e.type===c.ERROR)return e;f+=e.value}return{type:c.NUMBER,value:f+""}}}}},b[57]={value:function(){return{SUM:b.r(56),AVERAGE:b.r(53),COUNT:b.r(54),MAX:b.r(55)}}},b[58]={value:function(){var a=b.r(57);return{getFunctionImplementation:function(b){return a[b.toUpperCase()]}}}},b[59]={value:function(){function a(a,b,d,e){switch(a){case"pre-":b.unshift({type:f.NUMBER,value:"0"}),a="-";break;case"post%":b.push({type:f.NUMBER,value:"100"}),a="/"}var g=b[0],h=b[1];return g=g.type!==f.ARRAY?[[g]]:g.value,h=h.type!==f.ARRAY?[[h]]:h.value,c(a,g,h,d,e)}function c(a,b,c,e,f){var g,h,i=[],k=!1;if(1===b.length&&1===b[0].length)b=1===b[0].length?j.fillAllArray(b,e,f):j.fillRowArray(b,e,f);else{k=!1;for(var l=0,m=b.length;m>l;l++)if(b[l].length>1){k=!0;break}k||(b=j.fillColumnArray(b,e,f))}if(1===c.length)c=1===c[0].length?j.fillAllArray(c,e,f):j.fillRowArray(c,e,f);else{k=!1;for(var l=0,m=b.length;m>l;l++)if(c[l].length>1){k=!0;break}k||(c=j.fillColumnArray(c,e,f))}h=Math.min(b[0].length,c[0].length);for(var l=0,m=Math.min(b.length,c.length);m>l;l++){g=[],i.push(g);for(var n=0,o=h;o>n;n++)g.push(d(a,b[l][n],c[l][n]))}return i}function d(a,b,c){if(b.type===g.ERROR)return b;if(c.type===g.ERROR)return c;switch(a){case"+":case"-":case"*":case"/":case"^":if(b=i.getNumber(b),c=i.getNumber(c),isNaN(b)||isNaN(c))return{type:f.ERROR,value:e.VALUE};break;case"&":b=i.getText(b),c=i.getText(c)}switch(a){case"+":return{type:f.NUMBER,value:b+c+""};case"-":return{type:f.NUMBER,value:b-c+""};case"*":return{type:f.NUMBER,value:b*c+""};case"/":return 0===c?{type:f.ERROR,value:e.DIV0}:{type:f.NUMBER,value:b/c+""};case"^":return{type:f.NUMBER,value:Math.pow(b,c)+""};case"&":return{type:f.TEXT,value:b+c+""};default:return h.exec(a,b,c)}}var e=b.r(115),f=b.r(45),g=b.r(46),h=b.r(60),i=b.r(67),j=b.r(68);return{exec:function(b,c,d,h,i){for(var k,l,m=0,n=d.length;n>m;m++){if(k=d[m].value,k.type===g.UNION)return{type:f.ERROR,value:e.VALUE};if(k.type===g.ERROR)return k;if(k.type===g.RANGE){if(l=j.getCellsValue(b,k.value,h,i),null===l)return{type:f.ERROR,value:e.NULL};d[m]={type:f.ARRAY,value:l}}else d[m]=k}return{type:f.ARRAY,value:a(c.value,d,h,i)}}}}},b[60]={value:function(){function a(a,b){var c=a.type,e=b.type,f=a.value,g=b.value;return c===e?c===d.UNDEFINED?0:(f=f.toLowerCase(),g=g.toLowerCase(),f===g?0:f>g?1:-1):c===d.LOGICAL?1:e===d.LOGICAL?-1:c===d.TEXT?1:e===d.TEXT?-1:(f=+(f||0),g=+(g||0),f-g)}var c=b.r(45),d=b.r(46);return{exec:function(b,d,e){var f=a(d,e);switch(b){case"=":f=0===f;break;case">":f=f>0;break;case"<":f=0>f;break;case">=":f=f>=0;break;case"<=":f=0>=f;break;case"<>":f=0!==f}return{type:c.LOGICAL,value:f?"1":"0"}}}}},b[61]={value:function(){function a(a,b,c,e){var h,i,j=g.getCellsValue(a,b,c,e);if(null===j)return{type:d.ERROR,value:f.NULL};for(var k=0,l=j.length;l>k;k++){h=j[k];for(var m=0,n=h.length;n>m;m++)i=h[m],i.type===d.UNDEFINED&&(h[m]={type:d.NUMBER,value:"0"})}return{type:d.ARRAY,value:j}}function c(a,b,c){var e,g,h=[],i=b.row,j=b.col,k=c.row,l=c.col,m={type:d.ERROR,value:f.NAN},n=a.length,o=!1;if(1===n)if(1===a[0].length)for(var p=0,q=k-i;q>=p;p++){e=[],h.push(e);for(var r=0,s=l-j;s>=r;r++)e.push(a[0][0])}else for(var p=0,q=k-i;q>=p;p++){e=[],h.push(e);for(var r=0,s=l-j;s>=r;r++)e.push(a[0][r]||m)}else{for(var p=0;n>p;p++)if(a[p].length>1){o=!0;break}if(o)for(var p=0,q=k-i;q>=p;p++){g=a[p]||[],e=[],h.push(e);for(var r=0,s=l-j;s>=r;r++)e.push(g[r]||m)}else for(var p=0,q=k-i;q>=p;p++){g=a[p]||[],e=[],h.push(e);for(var r=0,s=l-j;s>=r;r++)e.push(g[0]||m)}}return h}var d=b.r(45),e=b.r(46),f=b.r(115),g=b.r(68);return{analyze:function(b,g,h,i){if(1!==g.length)return{type:d.ERROR,value:f.VALUE};var j=g[0].value;return j.type===e.UNION?j={type:d.ERROR,value:f.VALUE}:j.type===e.RANGE&&(j=a(b,j.value,h,i)),j=j.type!==e.ARRAY?[[j]]:j.value,c(j,h,i)}}}},b[62]={value:function(){function a(a,b){var e=b[0],f=b[1];switch(a){case"+":case"-":case"*":case"/":case"^":if(e=h.getNumber(e),f=h.getNumber(f),isNaN(e)||isNaN(f))return{type:d.ERROR,value:c.VALUE};break;case"pre-":case"post%":if(e=h.getNumber(e),isNaN(e))return{type:d.ERROR,value:c.VALUE};break;case"&":e=h.getText(e),f=h.getText(f)}switch(a){case"+":return{type:d.NUMBER,value:e+f+""};case"-":return{type:d.NUMBER,value:e-f+""};case"*":return{type:d.NUMBER,value:e*f+""};case"/":return 0===f?{type:d.ERROR,value:c.DIV0}:{type:d.NUMBER,value:e/f+""};case"^":return{type:d.NUMBER,value:Math.pow(e,f)+""};case"pre-":return{type:d.NUMBER,value:-e+""};case"post%":return{type:d.NUMBER,value:e/100+""};case"&":return{type:d.TEXT,value:e+f+""};default:return g.exec(a,e,f)}}var c=b.r(115),d=b.r(114),e=b.r(47),f=e.SUBTYPE,g=b.r(63),h=b.r(67);return{exec:function(b,e,g){for(var h,i=0,j=g.length;j>i;i++)if(h=g[i],"RESULT"!==h.type)if(h.subtype===f.RANGE){if(h=h.cells,0===h.length||0===h[0].length)return{type:"RESULT",result:{type:d.ERROR,value:c.NULL}};for(var k=0,l=h.length;l>k;k++)if(0===h[k].length)return{type:"RESULT",result:{type:d.ERROR,value:c.NULL}};if(h.length>1||h[0].length>1)return{type:"RESULT",result:{type:d.ERROR,value:c.VALUE}};if(h=h[0][0],void 0!==h.row&&void 0!==h.col){if(h=b.getComputedValueInfo(h.row,h.col),h.type===d.ERROR)return{type:"RESULT",result:h};g[i]=h}else g[i]={type:d.NUMBER,value:"0"}}else{if(h.subtype===d.ERROR)return{type:"RESULT",result:{type:d.ERROR,value:h.value}};g[i]={type:h.subtype,value:h.value}}else{if(h=h.result,h.type===d.ERROR)return{type:"RESULT",result:h};g[i]=h}return{type:"RESULT",result:a(e.value,g)}}}}},b[63]={value:function(){function a(a,b){var d=a.type,e=b.type,f=a.value,g=b.value;return d===e?d===c.UNDEFINED?0:(f=f.toLowerCase(),g=g.toLowerCase(),f===g?0:f>g?1:-1):d===c.LOGICAL?1:e===c.LOGICAL?-1:d===c.TEXT?1:e===c.TEXT?-1:(f=+(f||0),g=+(g||0),f-g)
}var c=b.r(114);return{exec:function(b,d,e){var f=a(d,e);switch(b){case"=":f=0===f;break;case">":f=f>0;break;case"<":f=0>f;break;case">=":f=f>=0;break;case"<=":f=0>=f;break;case"<>":f=0!==f}return{type:c.LOGICAL,value:f?"1":"0"}}}}},b[64]={value:function(){var a=b.r(115),c=b.r(45),d=b.r(58),e=b.r(75);return{exec:function(b,f,g,h,i){var j={row:i.row-h.row,col:i.col-h.col};if(f=d.getFunctionImplementation(f.name),!f)return{type:c.ERROR,value:a.NAME};g=e.read(b,f,g,j);var k=f.exec(g,c,a);return k.type===c.ARRAY&&(k.value=[k.value]),k}}}},b[65]={value:function(){function a(a,b,d,f){var g,i,j=h.getCellsValue(a,b,d,f);if(null===j)return{type:c.ERROR,value:e.NULL};for(var k=0,l=j.length;l>k;k++){g=j[k];for(var m=0,n=g.length;n>m;m++)i=g[m],i.type===c.UNDEFINED&&(g[m]={type:c.NUMBER,value:"0"})}return{type:c.ARRAY,value:j}}var c=b.r(45),d=b.r(46),e=b.r(115),f=b.r(47),g=f.TYPE,h=b.r(68);return{analyze:function(b,f,h,i){if(1!==f.length)return{type:c.ERROR,value:e.VALUE};var j=f[0];return j.type!==g.OPERAND?{type:c.ERROR,value:e.VALUE}:(j=j.value,j.type===d.UNION?{type:c.ERROR,value:e.VALUE}:(j.type===d.RANGE&&(j=a(b,j.value,h,i)),j.type!==d.ARRAY?j:(j=j.value,0===j.length||0===j[0].length?{type:c.ERROR,value:e.NULL}:j.length>1||j[0].length>1?{type:c.ERROR,value:e.VALUE}:j[0][0])))}}}},b[66]={value:function(){var a=b.r(47),c=a.TYPE,d=b.r(64),e=b.r(59),f=b.r(65),g=b.r(61);return b.r(0).create("MathRuntime",{valueModule:null,base:b.r(135),bind:function(a){this.valueModule=a},exec:function(a){var b,g=[],h={row:0,col:0},i={row:0,col:0};a=$._clone(a);for(var j=0,k=a.length;k>j;j++)switch(b=a[j],b.type){case c.OPERAND:g.push(b);break;case c.FUNCTION:g.push({type:c.OPERAND,value:d.exec(this.valueModule,b,g.splice(g.length-b.argCount,b.argCount),h,i)});break;case c.OP_IN:g.push({type:c.OPERAND,value:e.exec(this.valueModule,b,g.splice(g.length-2,2),h,i)});break;case c.OP_PRE:case c.OP_POST:g.push({type:c.OPERAND,value:e.exec(this.valueModule,b,g.splice(g.length-1,1),h,i)})}return f.analyze(this.valueModule,g,h,i)},execArray:function(a,b,f){var h,i=[];a=$._clone(a);for(var j=0,k=a.length;k>j;j++)switch(h=a[j],h.type){case c.OPERAND:i.push(h);break;case c.FUNCTION:i.push({type:c.OPERAND,value:d.exec(this.valueModule,h,i.splice(i.length-h.argCount,h.argCount),b,f)});break;case c.OP_IN:i.push({type:c.OPERAND,value:e.exec(this.valueModule,h,i.splice(i.length-2,2),b,f)});break;case c.OP_PRE:case c.OP_POST:i.push({type:c.OPERAND,value:e.exec(this.valueModule,h,i.splice(i.length-1,1),b,f)})}return g.analyze(this.valueModule,i,b,f)}})}},b[67]={value:function(){var a=b.r(114),c=b.r(117);return{getNumber:function(b){return b.type===a.UNDEFINED?0:parseFloat(b.value)},getText:function(b){return b.type===a.UNDEFINED?"":b.type===a.LOGICAL?"1"===b.value?c.TRUE:c.FALSE:b.value}}}},b[68]={value:function(){return{getCellsValue:function(a,b,c,d){var e,f,g=[];if(0===b.length)return null;for(var h,i,j=0,k=b.length;k>j;j++){e=b[j];for(var l=0,m=e.length;m>l;l++)if(f=e[l],h=f.row,i=f.col,void 0===h)for(var n=0,o=d.col-c.col;o>=n;n++)g[n]||(g[n]=[]),g[n].push(a.getComputedValueInfo(n,i));else if(void 0===i)for(var n=0,o=d.row-c.row;o>=n;n++)g[h]||(g[h]=[]),g[h].push(a.getComputedValueInfo(h,n));else g[j]||(g[j]=[]),g[j][l]=a.getComputedValueInfo(h,i)}return $._clone(g)},fillAllArray:function(a,b,c){for(var d,e=[],f=a[0][0],g=0,h=c.row-b.row;h>=g;g++){d=[],e.push(d);for(var i=0,j=c.col-b.col;j>=i;i++)d.push(f)}return e},fillRowArray:function(a,b,c){var d=[];a=a[0];for(var e=b.col,f=c.col;f>=e;e++)d.push(a);return d},fillColumnArray:function(a,b,c){for(var d,e,f=[],g=0,h=a.length;h>g;g++){d=[],f.push(d),e=a[g][0];for(var i=b.col,j=c.col;j>=i;i++)d.push(e)}return f}}}},b[69]={value:function(){function a(a,b){for(var c,f,i,j=a.cells,k=b.cells,l=d(j),m=[],n=0,o=k.length;o>n;n++){i=k[n],c=[];for(var p=0,q=i.length;q>p;p++)f=e(i[p],l),f&&(c=c.concat(f));m.push(c)}var r=a.subtype===h.RANGE,s=b.subtype===h.RANGE;return{type:g.OPERAND,subtype:r&&s?h.RANGE:h.UNION,cells:m}}function c(a,b){return{type:g.OPERAND,subtype:h.UNION,cells:a.cells.concat(b.cells)}}function d(a){for(var b,c,d={row:{},column:{}},e=0,f=a.length;f>e;e++){c=a[e];for(var g=0,h=c.length;h>g;g++)b=c[g],void 0===b.row?d.column[b.col]=!0:void 0===b.col?d.column[b.row]=!0:(d.row[b.row]||(d.row[b.row]={}),d.row[b.row]!==!0&&(d.row[b.row][b.col]=!0),d.column[b.col]||(d.column[b.col]={}),d.column[b.col]!==!0&&(d.column[b.col][b.row]=!0))}return d}function e(a,b){var c,d,e,f,g=[];if("region"===a.type)if(c=a.start.row,d=a.start.col,e=a.end.row,f=a.end.col,void 0===c){for(var h=d;f>=h;h++)if(b.column[h]===!0)g.push({row:void 0,col:h});else if(b.column[h])for(var i in b.column[h])g.push({row:void 0,col:i})}else if(void 0===d){for(var h=c;e>=h;h++)if(b.row[h]===!0)g.push({row:h,col:void 0});else if(b.row[h])for(var i in b.row[h])g.push({row:i,col:void 0})}else for(var h=c;e>=h;h++)for(var j=d;f>=j;j++)b.row[h]===!0?g.push({row:h,col:j}):b.column[j]===!0?g.push({row:h,col:j}):b.row[h]&&b.row[h][j]&&g.push({row:h,col:j});else if(b.row[a.row]===!0)g.push({row:a.row,col:a.col});else if(b.column[a.col]===!0)g.push({row:a.row,col:a.col});else if(void 0===a.row&&b.column[a.col])for(var i in b.column[a.col])g.push({row:void 0,col:i});else if(void 0===a.col&&b.row[a.row])for(var i in b.row[a.row])g.push({row:i,col:void 0});else b.row[a.row]&&b.row[a.row][a.col]&&g.push({row:a.row,col:a.col});return g.length>0?g:null}var f=b.r(47),g=f.TYPE,h=f.SUBTYPE;return{parse:function(b){for(var d,e,f=[],g=0,i=b.length;i>g;g++)d=b[g],d.subtype===h.INTERSECT?(e=f.splice(f.length-2,2),f.push(a(e[0],e[1]))):d.subtype===h.UNION?(e=f.splice(f.length-2,2),f.push(c(e[0],e[1]))):f.push(d);return f}}}},b[70]={value:function(){function a(a,b){for(var e;a.moveNext();)switch(e=a.current(),e.type){case l.FUNCTION:if(e.subtype===m.STOP)return;c(a,e,b);break;case l.SUBEXPR:b.push(e.subtype===m.START?{type:l.LEFT_BRACKET}:{type:l.RIGHT_BRACKET});break;case l.OPERAND:0===b.count&&(b.count=1),d(a,e,b);break;case l.NOOP:break;case l.OP_PRE:case l.OP_IN:case l.OP_POST:b.push({type:e.type,subtype:e.subtype,value:p[e.type]+e.value});break;case l.ARGUMENT:0===b.count&&(b.count=1),b.count++,b.push({type:l.ARGUMENT});break;case l.WSPACE:break;case l.UNKNOWN:}}function c(b,c,d){var e={type:l.FUNCTION,name:c.value};d.push(e),d.push({type:l.LEFT_BRACKET});var f=[];f.count=0,a(b,f),f.unshift(d.length,0),d.splice.apply(d,f),e.argCount=f.count,d.push({type:l.RIGHT_BRACKET})}function d(a,b,c){switch(b.subtype){case m.RANGE:c.push({type:l.OPERAND,subtype:b.subtype,cells:e(b.value)});break;default:c.push({type:l.OPERAND,subtype:b.subtype,value:b.value})}}function e(a){var b,c,d=a.split(":");if(1===d.length)b=f(d[0]);else{c=[];for(var e=0,h=d.length;h>e;e++)c[e]=[f(d[e])];b=g(c)}var i,j=[];if("region"===b.type)if(void 0===b.start.row){i=[],j.push(i);for(var e=b.start.col,k=b.end.col;k>=e;e++)i.push({row:void 0,col:e})}else if(void 0===b.start.col)for(var e=b.start.row,k=b.end.row;k>=e;e++)j.push([{row:e,col:void 0}]);else for(var e=b.start.row,k=b.end.row;k>=e;e++){i=[],j.push(i);for(var l=b.start.col,m=b.end.col;m>=l;l++)i.push({row:e,col:l})}else j.push([b]);return j}function f(a){var b,c;if(o.test(a)){if(b=RegExp.$2,c=RegExp.$1,!b&&!c)throw new Error("Invalid cell reference");return b?b-=1:b=void 0,c=c?n.toIndex(c):void 0,{row:b,col:c}}throw new Error("Invalid cell reference")}function g(a){for(var b=a[0],c=0,d=a.length-1;d>c;c++)b=h(b,a[c+1]);return b[0]}function h(a,b){var c=i(a),d=i(b),e=j(b),f=j(b),g=Math.min(c.row,d.row),h=Math.min(c.col,d.col),k=Math.max(e.row,f.row),l=Math.max(e.col,f.col);return g=isNaN(g)?void 0:g,h=isNaN(h)?void 0:h,k=isNaN(k)?void 0:k,l=isNaN(l)?void 0:l,(void 0===g||void 0===k)&&(g=void 0,k=void 0),(void 0===h||void 0===l)&&(h=void 0,l=void 0),[{type:"region",start:{row:g,col:h},end:{row:k,col:l}}]}function i(a){for(var b,c=99999999,d=99999999,e=0,f=a.length;f>e;e++)b=a[e],"region"===b.type?(c=Math.min(c,b.start.row),d=Math.min(d,b.start.col)):(c=Math.min(c,b.row),d=Math.min(d,b.col));return isNaN(c),isNaN(d),{row:isNaN(c)?void 0:c,col:isNaN(d)?void 0:d}}function j(a){for(var b,c=0,d=0,e=0,f=a.length;f>e;e++)b=a[e],"region"===b.type?(c=Math.max(c,b.end.row),d=Math.max(d,b.end.col)):(c=Math.max(c,b.row),d=Math.max(d,b.col));return isNaN(c),isNaN(d),{row:c,col:d}}var k=b.r(47),l=k.TYPE,m=k.SUBTYPE,n=b.r(8),o=/^\$?([a-z]+)?\$?(\d+)?$/i,p={};return p[l.OP_PRE]="pre",p[l.OP_IN]="",p[l.OP_POST]="post",{parse:function(b){var c=[];return a(b,c),c}}}},b[71]={value:function(){var a=b.r(47),c=a.TYPE,d=a.SUBTYPE;return{parse:function(a){for(var b,e=0,f=a.length;f>e;e++)b=a[e],b.type===c.OPERAND&&(a[e]=b.subtype===d.RANGE||b.subtype===d.UNION?{type:c.OPERAND,value:{type:b.subtype,value:b.cells}}:{type:c.OPERAND,value:{type:b.subtype,value:b.value}});return a}}}},b[72]={value:function(){var a=b.r(74),c=b.r(70),d=b.r(73),e=b.r(69),f=b.r(71);return{parse:function(b){var g=a.getTokens(b);return g=c.parse(g),g=d.parse(g),g=e.parse(g),g=f.parse(g)}}}},b[73]={value:function(){var a=b.r(47),c=a.TYPE,d={intersect:111,",":110,"pre-":99,"post%":98,"^":97,"*":96,"/":96,"+":95,"-":95,"&":94,"=":93,"<":92,">":92,"<=":91,">=":91,"<>":90};return{parse:function(a){for(var b,e,f=[],g=[],h=0,i=a.length;i>h;h++)switch(b=a[h],b.type){case c.OPERAND:f.push(b);break;case c.OP_IN:case c.OP_POST:for(;g.length&&(e=g[g.length-1],d[b.value]<=d[e.value]);)f.push(g.pop());g.push(b);break;case c.OP_PRE:for(;g.length&&(e=g[g.length-1],d[b.value]<d[e.value]);)f.push(g.pop());g.push(b);break;case c.FUNCTION:g.push(b);break;case c.ARGUMENT:g[g.length-1].type!==c.LEFT_BRACKET&&f.push(g.pop());break;case c.LEFT_BRACKET:g.push(b);break;case c.RIGHT_BRACKET:for(e=g.pop();e&&e.type!==c.LEFT_BRACKET;)f.push(e),e=g.pop();for(e=g[g.length-1];e&&e.type===c.FUNCTION;)f.push(g.pop()),e=g[g.length-1]}return f.concat(g.reverse())}}}},b[74]={value:function(){function a(a,b,c){this.value=a,this.type=b,this.subtype=c}function c(){this.items=new Array,this.add=function(b,c,d){return d||(d=""),token=new a(b,c,d),this.addRef(token),token},this.addRef=function(a){this.items.push(a)},this.index=-1,this.reset=function(){this.index=-1},this.BOF=function(){return this.index<=0},this.EOF=function(){return this.index>=this.items.length-1},this.moveNext=function(){return this.EOF()?!1:(this.index++,!0)},this.current=function(){return-1==this.index?null:this.items[this.index]},this.next=function(){return this.EOF()?null:this.items[this.index+1]},this.previous=function(){return this.index<1?null:this.items[this.index-1]}}function d(){this.items=new Array,this.push=function(a){this.items.push(a)},this.pop=function(){var b=this.items.pop();return new a("",b.type,v)},this.token=function(){return this.items.length>0?this.items[this.items.length-1]:null},this.value=function(){return this.token()?this.token().value:""},this.type=function(){return this.token()?this.token().type:""},this.subtype=function(){return this.token()?this.token().subtype:""}}function e(a){for(var b=new c,e=new d,f=0,g=function(){return a.substr(f,1)},h=function(){return a.substr(f,2)},F=function(){return a.substr(f+1,1)},G=function(){return f>=a.length},H="",I=!1,J=!1,K=!1,L=!1;a.length>0;){if(" "!=a.substr(0,1)){"="==a.substr(0,1)&&(a=a.substr(1));break}a=a.substr(1)}for(var M=/^[1-9]{1}(\.[0-9]+)?E{1}$/;!G();)if(I)'"'==g()?'"'==F()?(H+='"',f+=1):(I=!1,b.add(H,j,w),H=""):H+=g(),f+=1;else if(J)"'"==g()?"'"==F()?(H+="'",f+=1):J=!1:H+=g(),f+=1;else if(K)"]"==g()&&(K=!1),H+=g(),f+=1;else if(L)H+=g(),f+=1,-1!=",#NULL!,#DIV/0!,#VALUE!,#REF!,#NAME?,#NUM!,#N/A,".indexOf(","+H.toUpperCase()+",")&&(L=!1,H=H.toUpperCase(),b.add(H,j,z),H="");else if(-1!="+-".indexOf(g())&&H.length>1&&H.match(M))H+=g(),f+=1;else if('"'!=g())if("'"!=g())if("["!=g())if("#"!=g())if("{"!=g())if(";"!=g())if("}"!=g())if(" "!=g())-1==",>=,<=,<>,".indexOf(","+h()+",")?-1=="+-*/^&=><".indexOf(g())?-1=="%".indexOf(g())?"("!=g()?","!=g()?")"!=g()?(H+=g(),f+=1):(H.length>0&&(b.add(H,j),H=""),b.addRef(e.pop()),f+=1):(H.length>0&&(b.add(H,j),H=""),e.type()!=k&&e.type()!=l&&e.type()!=m?b.add(g(),q,E):b.add(g(),o),f+=1):(H.length>0?(e.push(b.add(H,k,u)),H=""):e.push(b.add("",n,u)),f+=1):(H.length>0&&(b.add(H,j),H=""),b.add(g(),r),f+=1):(H.length>0&&(b.add(H,j),H=""),b.add(g(),q),f+=1):(H.length>0&&(b.add(H,j),H=""),b.add(h(),q,y),f+=2);else for(H.length>0&&(b.add(H,j),H=""),b.add("",s),f+=1;" "==g()&&!G();)f+=1;else H.length>0&&(b.add(H,j),H=""),b.addRef(e.pop()),b.addRef(e.pop()),f+=1;else H.length>0&&(b.add(H,j),H=""),b.addRef(e.pop()),b.add(",",o),e.push(b.add("ARRAYROW",m,u)),f+=1;else H.length>0&&(b.add(H,t),H=""),e.push(b.add("ARRAY",l,u)),e.push(b.add("ARRAYROW",m,u)),f+=1;else H.length>0&&(b.add(H,t),H=""),L=!0,H+=g(),f+=1;else K=!0,H+=g(),f+=1;else H.length>0&&(b.add(H,t),H=""),J=!0,f+=1;else H.length>0&&(b.add(H,t),H=""),I=!0,f+=1;H.length>0&&b.add(H,j);for(var N=new c;b.moveNext();)H=b.current(),H.type!=s?N.addRef(H):b.BOF()||b.EOF()||((b.previous().type==k||b.previous().type==l||b.previous().type==m)&&b.previous().subtype==v||b.previous().type==n&&b.previous().subtype==v||b.previous().type==j)&&((b.next().type==k||b.next().type==l||b.next().type==m)&&b.next().subtype==u||b.next().type==n&&b.next().subtype==u||b.next().type==j)&&(H.value="intersect",N.add(H.value,q,D));for(;N.moveNext();)H=N.current(),H.type!=q||"-"!=H.value?H.type!=q||"+"!=H.value?H.type!=q||0!=H.subtype.length?H.type!=j||0!=H.subtype.length?H.type!=k&&H.type!=l&&H.type!=m||"@"==H.value.substr(0,1)&&(H.value=H.value.substr(1)):isNaN(parseFloat(H.value))?"TRUE"==H.value.toUpperCase()||"FALSE"==H.value.toUpperCase()?(H.value="TRUE"==H.value.toUpperCase()?"1":"0",H.subtype=y):H.subtype=A:H.subtype=x:H.subtype=-1!="<>=".indexOf(H.value.substr(0,1))?y:"&"==H.value?C:B:N.BOF()?H.type=i:(N.previous().type==k||N.previous().type==l||N.previous().type==m)&&N.previous().subtype==v||N.previous().type==n&&N.previous().subtype==v||N.previous().type==r||N.previous().type==j?H.subtype=B:H.type=i:N.BOF()?H.type=p:(N.previous().type==k||N.previous().type==l||N.previous().type==m)&&N.previous().subtype==v||N.previous().type==n&&N.previous().subtype==v||N.previous().type==r||N.previous().type==j?H.subtype=B:H.type=p;for(N.reset(),b=new c;N.moveNext();)N.current().type!=i&&b.addRef(N.current());return b.reset(),b}var f=b.r(47),g=f.TYPE,h=f.SUBTYPE,i=g.NOOP,j=g.OPERAND,k=g.FUNCTION,l=g.ARRAY,m=g.ARRAYROW,n=g.SUBEXPR,o=g.ARGUMENT,p=g.OP_PRE,q=g.OP_IN,r=g.OP_POST,s=g.WSPACE,t=g.UNKNOWN,u=h.START,v=h.STOP,w=h.TEXT,x=h.NUMBER,y=h.LOGICAL,z=h.ERROR,A=h.RANGE,B=h.MATH,C=h.CONCAT,D=h.INTERSECT,E=h.UNION;return{getTokens:e}}},b[75]={value:function(){function a(a,b,c){for(var e,f,g=[],h=0,i=c.length;i>h;h++)if(e=c[h].value,e.type===k.ARRAY){e=e.value,f=[];for(var j=0,l=e.length;l>j;j++)f=f.concat(e[j]);g.push({type:k.ARRAY,value:f})}else g.push(e.type!==k.RANGE&&e.type!==k.UNION?e:d(a,b,e.value));return g}function c(a,b,c,d){for(var e,f,h=[],i=0,j=c.length;j>i;i++)if(e=c[i],e.type===k.ARRAY){e=e.value,f=[];for(var l=0,m=e.length;m>l;l++)f=f.concat(e[l]);h.push({type:k.ARRAY,value:f})}else h.push(e.type!==k.RANGE&&e.type!==k.UNION?e:g(a,b,e.value,d));return h}function d(a,b,c){return b?e(a,c):f(a,c)}function e(a,b){for(var c,d,e,f,g,h=100,i=[],k=0,l=b.length;l>k;k++){c=b[k];for(var m=0,n=c.length;n>m;m++)if(d=c[m],f=d.row,g=d.col,void 0===f)for(var o=0,p=h;p>=o;o++){if(e=a.getComputedValueInfo(o,g),e.type===j.ERROR)return e;e.type!==j.UNDEFINED&&i.push(e)}else if(void 0===g)for(var o=0,p=h;p>=o;o++){if(e=a.getComputedValueInfo(f,o),e.type===j.ERROR)return e;e.type!==j.UNDEFINED&&i.push(e)}else{if(e=a.getComputedValueInfo(f,g),e.type===j.ERROR)return e;if(e.type===j.UNDEFINED)continue;i.push(e)}}return{type:j.ARRAY,ref:!0,value:i}}function f(a,b){for(var c,d,e,f,g,h=100,i=[],k=0,l=b.length;l>k;k++){c=b[k];for(var m=0,n=c.length;n>m;m++)if(d=c[m],f=d.row,g=d.col,void 0===f)for(var o=0,p=h;p>=o;o++)e=a.getComputedValueInfo(o,g),e.type!==j.UNDEFINED&&i.push(e);else if(void 0===g)for(var o=0,p=h;p>=o;o++)e=a.getComputedValueInfo(f,o),e.type!==j.UNDEFINED&&i.push(e);else{if(e=a.getComputedValueInfo(f,g),e.type===j.d)continue;i.push(e)}}return{type:j.ARRAY,ref:!0,value:i}}function g(a,b,c,d){return b?h(a,c,d):i(a,c,d)}function h(a,b){for(var c,d=0,e=b.length;e>d;d++){c=b[d];for(var f=0,g=c.length;g>f;f++);}}function i(){}var j=b.r(45),k=b.r(46);return{read:function(b,d,e,f){return d._all?a(b,d._error,e):c(b,d._error,e,f)}}}},b[76]={value:function(){var a=b.r(0).create("Hidden",{dataAccess:null,base:b.r(138),init:function(a){this.dataAccess=a},initService:function(){this.registerService({"c.is.hidden.row":this.isHiddenRow,"c.is.hidden.column":this.isHiddenColumn})},isHiddenRow:function(a){return 0===this.dataAccess.getRowHeight(a)},isHiddenColumn:function(a){return 0===this.dataAccess.getColumnWidth(a)}});return a.deps=["dataAccess"],a}},b[77]={value:function(){var a=b.r(0).create("Mode",{base:b.r(138),init:function(a){this.dataAccess=a,this.initService()},initService:function(){this.registerService({"c.is.readonly":this.isReadonly,"c.set.readonly":this.setReadonly})},isReadonly:function(){return this.dataAccess.isReadonly()},setReadonly:function(a){this.dataAccess.setReadonly(a)}});return a.deps=["dataAccess"],a}},b[78]={value:function(){var a=(b.r(37),b.r(0).create("Paster",{dataAccess:null,valueModule:null,styleModule:null,base:b.r(138),init:function(a,b,c){this.dataAccess=a,this.valueModule=b,this.styleModule=c,this.initService()},initService:function(){this.registerService({"c.paste":this.paste})},paste:function(a,b,c){for(var d,e,f,g,h=a.length,i=0,j=this.dataAccess.getTotalIndex(),k=this.valueModule,l=this.styleModule,m=0,n=a.length;n>m;m++)i=Math.max(i,a[m].length);this.corePrepareRefresh(),b+h>j.row&&this.dataAccess.expandRow(100*Math.ceil((b+h-j.row)/100)),c+i>j.col&&this.dataAccess.expandCol(26*Math.ceil((c+i-j.col)/26));for(var m=0,n=a.length;n>m;m++)if(d=a[m])for(var o=0,p=d.length;p>o;o++)e=d[o],e&&(f=b+m,g=c+o,k.writeCell(e.content,f,g),e.style&&l.batchSetStyle(e.style,f,g));this.coreRefresh()}}));return a.deps=["dataAccess","value","style"],a}},b[79]={value:function(){return b.r(0).create("RangeFacade",{dataAccess:null,cell:null,base:b.r(135),init:function(a,b){this.cell=a,this.dataAccess=b},getFocus:function(){return this.dataAccess.getFocus()},getStart:function(){return this.dataAccess.getStart()},getEnd:function(){return this.dataAccess.getEnd()},getOriginalFocus:function(){return this.dataAccess.getOriginalFocus()},getAllSelection:function(){return this.dataAccess.getSelection()},isWritable:function(){return this.dataAccess.getWritable()},isMultiple:function(){var a=this.getFocus(),b=this.getStart(),c=this.getEnd();return b.row===c.row&&b.col===c.col?!1:!this.cell.isSameMergeCell(a,b,c)},isValid:function(){return-1!==this.getFocus().row}})}},b[80]={value:function(){var a=b.r(79),c=b.r(0).create("Range",{cell:null,hiddenModule:null,dataAccess:null,facade:null,base:b.r(138),init:function(b,c,d){this.dataAccess=b,this.cell=c,this.hiddenModule=d,this.facade=this.createComponent(a,c,b),this.registerService({"c.range.focus":this.setFocus,"c.range.selection":this.setSelection,"c.range.disable":this.disable,"c.range.set":this.setRange,"c.range":this.getRange,"c.range.down":this.moveDown,"c.range.up":this.moveUp,"c.range.left":this.moveLeft,"c.range.right":this.moveRight,"c.selection.expand.down":this.expandDown,"c.selection.expand.right":this.expandRight,"c.selection.expand.up":this.expandUp,"c.selection.expand.left":this.expandLeft,"c.select.column":this.selectColumn,"c.select.row":this.selectRow,"c.select.all":this.selectAll})},setRange:function(a,b,c){b||(b=a.getStart(),c=a.getEnd(),a=a.getFocus()),this.setFocus(a.row,a.col),this.setSelection(b,c),this.postMessage("c.range.change")},selectColumn:function(a,b){var c=this.dataAccess.getTotalIndex(),d=c.row,e=a;void 0===b&&(b=a),a>b&&(e=b,b=a,a=e);for(var f,g=0;d>=g&&this.cell.isMergeCell(g,a);)f=this.cell.getMergeCell(g,a),g=f.end.row+1;return g>d?void this.setRange({row:0,col:a},{row:0,col:a},{row:d,col:b}):(this.setFocus(g,a),void this.setSelection({row:0,col:a},{row:d,col:b}))},selectAll:function(){var a=this.dataAccess.getTotalIndex();this.setSelection({row:0,col:0},{row:a.row,col:a.col}),this.postMessage("c.range.change")},selectRow:function(a,b){var c=this.dataAccess.getTotalIndex(),d=a,e=c.col;void 0===b&&(b=a),a>b&&(d=b,b=a,a=d);for(var f,g=0;e>=g&&this.cell.isMergeCell(a,g);)f=this.cell.getMergeCell(a,g),g=f.end.col+1;return g>e?void this.setRange({row:a,col:0},{row:a,col:0},{row:b,col:e}):(this.setFocus(a,g),void this.setSelection({row:a,col:0},{row:b,col:e}))},setFocus:function(a,b){var c,d,e,f=this.dataAccess.getFocus();a===f.row&&b===f.col&&this.dataAccess.getWritable()||(this.dataAccess.setOriginalFocus(a,b),this.cell.isMergeCell(a,b)?(c=this.cell.getMergeCell(a,b),f={row:c.start.row,col:c.start.col},d={row:c.start.row,col:c.start.col},e={row:c.end.row,col:c.end.col}):(f={row:a,col:b},d={row:a,col:b},e={row:a,col:b}),this.dataAccess.setFocus(f.row,f.col),this.setSelection(d,e),this.postMessage("c.focus.change"),this.postMessage("c.range.change"))},setSelection:function(a,b){var c=this.cs("c.cell.compare",a,b);a=c.min,b=c.max,this.dataAccess.setWritable(!0),c=this.cell.standardCellRange(a,b),this.dataAccess.setSelection(c.start,c.end),this.postMessage("c.range.change")},expandDown:function(a){var b=this.dataAccess.getStart(),c=this.dataAccess.getFocus(),d=this.dataAccess.getEnd(),e=this.dataAccess.getTotal().row-1;b.row===c.row?(d.row+=a,d.row>e&&(d.row=e)):(b.row+=a,b.row>e&&(b.row=e));var f=this.cs("c.cell.compare",b,d);this.setSelection(f.min,f.max)},expandRight:function(a){var b=this.dataAccess.getStart(),c=this.dataAccess.getFocus(),d=this.dataAccess.getEnd(),e=this.dataAccess.getTotal().col-1;b.col===c.col?(d.col+=a,d.col>e&&(d.col=e)):(b.col+=a,b.col>e&&(b.col=e));var f=this.cs("c.cell.compare",b,d);this.setSelection(f.min,f.max)},expandUp:function(a){var b=this.dataAccess.getStart(),c=this.dataAccess.getFocus(),d=this.dataAccess.getEnd();b.row===c.row?(d.row-=a,d.row<0&&(d.row=0)):(b.row-=a,b.row<0&&(b.row=0));var e=this.cs("c.cell.compare",b,d);this.setSelection(e.min,e.max)},expandLeft:function(a){var b=this.dataAccess.getStart(),c=this.dataAccess.getFocus(),d=this.dataAccess.getEnd();b.col===c.col?(d.col-=a,d.col<0&&(d.col=0)):(b.col-=a,b.col<0&&(b.col=0));var e=this.cs("c.cell.compare",b,d);this.setSelection(e.min,e.max)},disable:function(){this.dataAccess.setWritable(!1),this.postMessage("c.range.change")},getRange:function(){return this.facade},moveDown:function(a){var b=this.dataAccess.getOriginalFocus(),c=this.dataAccess.getTotalIndex().row;a=0|a;var d=this.cell.getMergeCell(b.row,b.col);if(a+=d?d.end.row:b.row,a>c)return c;for(;this.hiddenModule.isHiddenRow(a);)a++;return a>c?c:(this.setFocus(a,b.col),this.postMessage("c.range.change"),this.dataAccess.getFocus().row)},moveUp:function(a){var b=this.dataAccess.getFocus(),c=this.dataAccess.getOriginalFocus();if(a=0|a,a=b.row-a,0>a)return 0;for(;this.hiddenModule.isHiddenRow(a);)a--;return 0>a?0:(this.setFocus(a,c.col),this.postMessage("c.range.change"),this.dataAccess.getFocus().row)},moveLeft:function(a){var b=this.dataAccess.getFocus(),c=this.dataAccess.getOriginalFocus();if(a=0|a,a=b.col-a,0>a)return 0;for(;this.hiddenModule.isHiddenColumn(a);)a--;return 0>a?0:(this.setFocus(c.row,a),this.postMessage("c.range.change"),this.dataAccess.getFocus().col)},moveRight:function(a){var b=this.dataAccess.getOriginalFocus(),c=this.dataAccess.getTotalIndex().col;a=0|a;var d=this.cell.getMergeCell(b.row,b.col);if(a+=d?d.end.col:b.col,a>c)return c;for(;this.hiddenModule.isHiddenColumn(a);)a++;return a>c?c:(this.setFocus(b.row,a),this.postMessage("c.range.change"),this.dataAccess.getFocus().col)}});return c.deps=["dataAccess","cell","hidden"],c}},b[81]={value:function(){var a=b.r(2),c=b.r(0).create("Sheet",{base:b.r(138),init:function(a){this.dataAccess=a,this.initService()},initService:function(){this.registerService({"c.get.sheetname":this.getSheetName,"c.get.sheetnames":this.getSheetNames,"c.get.sheetindex":this.getSheetIndex,"c.createsheet":this.createSheet,"c.switchsheet":this.switchSheet,"c.importsheet":this.importSheet})},createSheet:function(a){var b=this.dataAccess.addSheetName(a);this.dataAccess.importSheet(b),this.postMessage("c.sheetschange"),this.coreRefresh(!0)},importSheet:function(b,c){this.dataAccess.importSheet(b,a._clone(c))},switchSheet:function(a){this.dataAccess.switchSheet(a),this.coreRefresh(!0),this.postMessage("c.sheetschange"),this.postMessage("c.range.change")},getSheetName:function(){return this.dataAccess.getSheetName()},getSheetIndex:function(){return this.dataAccess.getSheetIndex()},getSheetNames:function(){return this.dataAccess.getSheetNames()}});return c.deps=["dataAccess"],c}},b[82]={value:function(){return b.r(0).create("Struct",{dataAccess:null,valueModule:null,style:null,border:null,cell:null,wraptext:null,visible:null,comments:null,init:function(a,b,c,d,e,f,g,h){this.dataAccess=a,this.valueModule=b,this.style=c,this.border=d,this.cell=e,this.wraptext=f,this.visible=g,this.comments=h},getGrid:function(){return this.dataAccess.getGrid()},getOffset:function(){return this.dataAccess.getOffset()},getViewStart:function(){return this.dataAccess.getViewStart()},getViewEnd:function(){return this.dataAccess.getViewEnd()},getVisibleCount:function(){return this.dataAccess.getVisibleCount()},getBorderWidth:function(){return this.dataAccess.getBorderWidth()},getTotal:function(){return this.dataAccess.getTotal()},getComments:function(a,b){return this.comments.getComments(a,b)},getCommentsInView:function(){return this.comments.getCommentsInView()},getTotalIndex:function(){return this.dataAccess.getTotalIndex()},getBoundary:function(){return this.dataAccess.getBoundary()},getDimension:function(){return this.dataAccess.getDimension()},getSpace:function(){return this.dataAccess.getSpace()},getCellByName:function(){return this.dataAccess.getCellByName()},getComputedStyle:function(a,b,c){return this.style.getComputedStyle(a,b,c)},getAllComputedStyle:function(a,b){return this.style.getAllComputedStyle(a,b)},getRawStyle:function(a,b,c){return this.style.getStyle(a,b,c)},getUserStyle:function(a,b,c){return this.style.getUserStyle(a,b,c)},getDefaultStyle:function(a){return this.dataAccess.getDefaultStyle(a)},getStyleIds:function(a,b,c){return this.dataAccess.getStyleIds(a,b,c)},getStyleById:function(a,b){return this.dataAccess.getStyleById(a,b)},getPane:function(){return this.dataAccess.getPane()},getDisplayValue:function(a,b){return this.wraptext.getDisplayValue(a,b)},getComputedValue:function(a,b){return this.valueModule.getComputedValue(a,b)},getFormattedValue:function(a,b){return this.valueModule.getFormattedValue(a,b)},getStandardValue:function(a,b){return this.valueModule.getStandardValue(a,b)},getComputedValueInfo:function(a,b){return this.valueModule.getComputedValueInfo(a,b)},getFormattedValueInfo:function(a,b){return this.valueModule.getFormattedValueInfo(a,b)},getRawValue:function(a,b){return this.valueModule.getRawValue(a,b)},getEffectiveIndex:function(){return this.dataAccess.getEffectiveIndex()},getBorder:function(a,b){return this.border.getBorder(a,b)},getBorders:function(a,b){return this.border.getBorders(a,b)},getAllMergeCell:function(){return this.cell.getAllMergeCell()},getMergeCell:function(a,b){return this.cell.getMergeCell(a,b)},isMergeCell:function(a,b){return this.cell.isMergeCell(a,b)},getMergeCellsInRange:function(a){return this.cell.getMergeCellsInRange(a)},getColumnWidth:function(a){return this.cell.getColumnWidth(a)},getRowHeight:function(a){return this.cell.getRowHeight(a)},getRawRowHeight:function(a){return this.dataAccess.getRowHeight(a)},getRawColumnWidth:function(a){return this.dataAccess.getColumnWidth(a)},columnIsVisible:function(a){return this.visible.columnIsVisible(a)},rowIsVisible:function(a){return this.visible.rowIsVisible(a)},rowIsFullVisible:function(a){return this.visible.rowIsFullVisible(a)},columnIsFullVisible:function(a){return this.visible.columnIsFullVisible(a)},getViewPosition:function(a,b){return this.visible.getViewPosition(a,b)}})}},b[83]={value:function(){var a=b.r(82),c=(b.r(38),b.r(0).create("Struct",{base:b.r(138),actuary:null,dataAccess:null,init:function(b,c,d,e,f,g,h,i,j){this.dataAccess=b,this.actuary=c,this.structFacade=this.createComponent(a,b,d,e,f,g,h,i,j),this.initService()},load:function(a){this.dataAccess.importWorkbook(a),this.actuary.reinit(),this.actuary.calculate()},getStruct:function(){return this.structFacade},initService:function(){this.registerService({"c.struct":this.getStruct,"c.load":this.load})}}));return c.deps=["dataAccess","actuary","value","style","border","cell","wraptext","visible","comments"],c}},b[84]={value:function(){var a=b.r(85),c=b.r(0).create("Style",{dataAccess:null,valueModule:null,base:b.r(138),init:function(a,b){this.dataAccess=a,this.valueModule=b,this.initService()},initService:function(){this.registerService({"c.setstyle":this.setStyle,"c.batch.setstyle":this.batchSetStyle,"c.clear.style":this.clearStyle,"c.set.column.style":this.setColumnStyle,"c.set.row.style":this.setRowStyle,"c.set.cellstyles":this.setCellStyles})},getStyle:function(a,b,c){var d=this.valueModule.getRawType(b,c),e=this.getUserStyle(a,b,c),f=this.__getTypeStyle(d,a),g=$._extend($._clone(this.dataAccess.getDefaultStyle(a)),f,e);return"alignments"===a&&1===b&&3===c&&console.log(e),g},getAllComputedStyle:function(a,b){var c=this.getComputedStyle("fonts",a,b),d=this.getComputedStyle("fills",a,b),e=this.getComputedStyle("alignments",a,b);return $.extend({},c,d,e)},getComputedStyle:function(a,b,c){var d,e,f=this.valueModule.getComputedValueInfo(b,c).type,g=this.getUserStyle(a,b,c),h=this.__getTypeStyle(f,a);return e=$._extend($._clone(this.dataAccess.getDefaultStyle(a)),h,g),"fonts"===a&&(d=this.valueModule.getFormatColor(b,c)),d&&(e.color=d),e},getUserStyle:function(a,b,c){return this.dataAccess.getStyle(a,b,c)},setStyle:function(a,b,c,d){this.dataAccess.setStyle(a,b,c,d),this.postMessage("c.stylechange",c,d),this.coreRefresh(!0)},batchSetStyle:function(a,b,c){this.dataAccess.batchSetStyle(a,{row:b,col:c},{row:b,col:c}),this.postMessage("c.stylechange",{row:b,col:c},{row:b,col:c}),this.coreRefresh(!0)},setColumnStyle:function(a,b,c,d){var e=this.dataAccess.getTotalIndex();this.dataAccess.setColumnStyle(a,b,c,d),this.postMessage("c.stylechange",{row:0,col:c},{row:e.row,col:d}),this.coreRefresh(!0)},setCellStyles:function(a,b,c){this.dataAccess.setCellStyles(a,b,c),this.coreRefresh(!0)},setRowStyle:function(a,b,c,d){var e=this.dataAccess.getTotalIndex();this.dataAccess.setRowStyle(a,b,c,d),this.postMessage("c.stylechange",{row:c,col:0},{row:d,col:e.col}),this.coreRefresh(!0)},clearStyle:function(a,b){this.dataAccess.clearStyle(a,b),this.postMessage("c.stylechange",a,b),this.coreRefresh(!0)},__getTypeStyle:function(b,c){var d=a[b];if(d)return d[c]}});return c.deps=["dataAccess","value"],c}},b[85]={value:{TEXT:{},NUMBER:{alignments:{horizontal:"right"}},LOGICAL:{alignments:{horizontal:"center"}},ERROR:{alignments:{horizontal:"center"}}}},b[86]={value:function(){var a=b.r(0).create("ValueSecurity",{dataAccess:null,base:b.r(138),init:function(a){this.dataAccess=a},check:function(a,b,c){if(c)return!0;var d=this.dataAccess.getArrayReference(a,b);return d?!1:!0}});return a.deps=["dataAccess"],a}},b[87]={value:function(){return{DECIMAL:0,SCIENTIFIC:1,DATETIME:2,FRACTION:4}}},b[88]={value:function(){function a(a){if(f[a])return f[a];var b=[];f[a]=b;var e,g,l,m,n,o=c(a),p=o.effectiveSymbols;a=o.symbols;for(var q=0,r=p.length;r>q;q++)if(e={},b.push(e),n=p[q],g=a[q],e.color=g.color,e.condition=g.condition,h.test(n)){for(e.flag=k.DATETIME,e.value=g,n=n.replace("AM/PM",""),i.test(n)&&(e.hasDate=!0),j.test(n)&&(e.hasTime=!0),m=0;l=g[m++];)if("AM/PM"===l||"A/P"===l){e.dSign=l;break}}else if(-1===n.indexOf("e"))-1===n.indexOf("/")?(e.flag=k.DECIMAL,e.value=g):(e.flag=k.FRACTION,e.value=g);else for(e.flag=k.SCIENTIFIC,m=0;l=g[m++];)if("e+"===l||"e-"===l){e.eSign=l,e.value=g.slice(0,m),e.exponent=g.slice(m);
break}for(var q=0,r=b.length;r>q;q++)e=b[q],e.value=d(e.value),e.eSign&&(e.exponent=d(e.exponent));return b}function c(a){var b,c,d,f=[[]],g=[[]],h=0,i=a.split("");a=a.toLowerCase().split("");for(var j=0,k=a.length;k>j;j++)switch(b=a[j]){case"!":case"\\":f[h].push({str:i[++j],index:g[h].length});break;case'"':for(c=[];(b=i[++j])&&'"'!==b;)c.push(b);f[h].push({str:c.join(""),index:g[h].length});break;case"[":for(c=[];(b=a[++j])&&"]"!==b;)c.push(b);e(g[h],c.join(""));break;case";":h++,g[h]=[],f[h]=[];break;case"_":g[h].push(" "),j++;break;case"a":"m/pm"===a.slice(j+1,j+5).join("")?(g[h].push(i.slice(j,j+5).join("").toUpperCase()),j+=5):"/p"===a.slice(j+1,j+3).join("")&&(g[h].push(i.slice(j,j+3).join("").toUpperCase()),j+=3);break;case"e":g[h].push(b+a[j+1]),j++;break;case"y":case"d":case"h":case"s":case"m":for(c=b;(d=a[j+1])&&b===d;)c+=d,j++;(-1!==c.indexOf("h")||-1!==c.indexOf("s"))&&(c=c.toUpperCase()),g[h].push(c);break;default:g[h].push(b.toLowerCase())}for(var l,m,n,o=-1,p=[],j=0,k=g.length;k>j;j++){l=g[j],n=!1,o=-1;for(var q=0,r=l.length;r>q;q++)b=l[q],-1===b.indexOf("H")?-1===b.indexOf("m")?-1!==b.indexOf("S")&&-1!==o&&(o=-1,l[q]=l[q].toUpperCase()):n?(n=!1,l[q]=b.toUpperCase()):o=q:n=!0;p[j]=l.join("")}for(var s=-1,j=0,k=g.length;k>j;j++){m=f[j],d=[],s=-1;for(var q=0,r=m.length;r>q;q++)b=m[q],-1!==s&&b.index===s?d[d.length-1].str+=b.str:d.push(b),s=b.index;f[j]=d}for(var j=0,k=g.length;k>j;j++){m=f[j],l=g[j];for(var q=m.length-1;q>=0;q--)b=m[q],l.splice(b.index,0,[b.str])}return{symbols:g,effectiveSymbols:p}}function d(a){for(var b,c=0,d=!0,e={front:[],back:[],frontCount:0,backCount:0},f=e.front;b=a[c++];)if(f.push(b),!$.isArray(b)&&"["!==b.charAt(0))switch(b){case".":d&&(d=!1,f=e.back);break;case"0":case"#":case"?":d?e.frontCount++:e.backCount++}return e}function e(a,b){return-1!==l.indexOf("["+b+"]")?void(a.color=b):g.test(b)?void(a.condition=[RegExp.$1,parseFloat(RegExp.$2)]):void a.push("["+b+"]")}var f={},g=/^(>=|<=|>|<|=)(\d+)/,h=/[HMSymd]/,i=/[ymd]/,j=/[HMS]/,k=b.r(87),l="[black][blue][cyan][green][magenta][red][white][yellow]";return{getFormatColor:function(b,c){var d=a(b);return(d[c]||d[0]).color},getNumberSegment:function(b,c){var d=a(c);return b>0?{index:0,select:0,segment:d[0]}:0>b?d[1]?{index:1,select:1,segment:d[1]}:{index:1,select:0,segment:d[0]}:d[2]?{index:2,select:2,segment:d[2]}:{index:2,select:0,segment:d[0]}},getTextSegment:function(b){var c=a(b);return c[3]}}}},b[89]={value:function(){var a=b.r(114),c=b.r(104),d=b.r(117),e=b.r(88);return b.r(0).create("Formatter",{dataAccess:null,base:b.r(135),init:function(a){this.dataAccess=a},calculateFormatColor:function(b,c,d){if(!d||!c)return void 0;var f;switch(b){case a.UNDEFINED:case a.ERROR:return void 0;case a.NUMBER:f=c>0?0:0>c?1:2;break;case a.TEXT:case a.LOGICAL:f=4}return e.getFormatColor(d,f)},getStandardValue:function(b,e){var f=this.dataAccess.getCellType(b,e);if(!f)return void 0;var g=this.dataAccess.getValue(b,e);switch(f){case a.TEXT:case a.ERROR:return g;case a.NUMBER:return c.getStandardValue(g,this.dataAccess.getNumberFormat(b,e));case a.LOGICAL:return g?d.TRUE:d.FALSE}}})}},b[90]={value:function(){var a=b.r(114),c=b.r(91);return{exec:function(b,d){return b?c.exec(b,d):{type:a.UNDEFINED,value:void 0}}}}},b[91]={value:function(){var a=b.r(114),c=b.r(94),d=b.r(93),e=b.r(92);return{exec:function(b,f){var g;if(!b)return{type:a.UNDEFINED,value:void 0};if("="===b.charAt("0")&&b.length>1)return{type:a.FORMULA,value:b};var h=b.trim();return(g=c.exec(h,f))?g:(g=d.exec(h))?g:(g=e.exec(h),g?g:{type:a.TEXT,value:b})}}}},b[92]={value:function(){var a=b.r(114),c=b.r(115),d=[];for(var e in c)c.hasOwnProperty(e)&&d.push(c[e]);return d=","+d.join(",")+",",{exec:function(b){return b=b.toUpperCase(),-1===b.indexOf(",")&&-1!==d.indexOf(","+b+",")?{type:a.ERROR,value:b}:!1}}}},b[93]={value:function(){var a=b.r(114),c=b.r(117);return{exec:function(b){return b=b.toUpperCase(),b===c.TRUE||b===c.FALSE?{type:a.LOGICAL,value:+(b===c.TRUE)+""}:!1}}}},b[94]={value:function(){var a=b.r(98),c=b.r(96),d=b.r(95),e=b.r(99),f=b.r(97),g=b.r(88),h=b.r(87);return{exec:function(b,i){var j,k;return $.isNumeric(b)&&(j=a.exec(b)),i&&(k=g.getNumberSegment(b,i).segment),!i||k.flag&(h.DATE|h.TIME|h.DATETIME)?(j||(j=c.exec(b)),j||(j=f.exec(b))):(j||(j=f.exec(b)),j||(j=c.exec(b))),j||(j=d.exec(b)),j||(j=e.exec(b)),j?j:!1}}}},b[95]={value:function(){var a=b.r(114),c=b.r(119),d=/^(?:\$|\xa5)([\s\S]+)$/,e=b.r(116);return{exec:function(b){return d.test(b)&&$.isNumeric(RegExp.$1)?{type:a.NUMBER,subType:c.CURRENCY,format:e._default[c.CURRENCY],value:+RegExp.$1+""}:!1}}}},b[96]={value:function(){function a(a){var b,c,e;if(/^(\d{1,4})\u5e74(\d{1,2})\u6708(\d{1,2})\u65e5$/i.test(a)||/^(\d{1,4})[\/\-](\d{1,2})[\/\-](\d{1,2})$/i.test(a))b=RegExp.$1,c=RegExp.$2,e=RegExp.$3,2===b.length?b="20"+b:1===b.length&&(b="200"+b);else if(/^\d{1,2}\u6708\d{1,2}\u65e5$/i.test(a)||/^(\d{1,2})[\/\-](\d{1,2})$/i.test(a))b=(new Date).getFullYear()+"",c=RegExp.$1,e=RegExp.$2;else{if(!/^\d{1,4}\u5e74\d{1,2}\u6708$/i.test(a))return!1;b=RegExp.$1,c=RegExp.$2,e=(new Date).getDate()+""}return d(+b,+c,+e)?{year:+b,month:+c,day:+e}:!1}function c(a){var b,c,d;if(/^(\d{1,2})\u65f6(\d{1,2})\u5206(\d{1,2})\u79d2$/i.test(a)||/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/i.test(a))b=RegExp.$1,c=RegExp.$2,d=RegExp.$3;else if(/^\d{1,2}\u65f6\d{1,2}\u5206$/i.test(a)||/^(\d{1,2}):(\d{1,2})$/i.test(a))b=RegExp.$1,c=RegExp.$2,d="0";else{if(!/^\d{1,2}\u5206\d{1,2}\u79d2$/i.test(a))return!1;b="0",c=RegExp.$1,d=RegExp.$2}return e(+b,+c,+d)?{hour:+b,minute:+c,second:+d}:!1}function d(a,b,c){if(a>j||k>a)return!1;var d=new Date(Date.UTC(a,b-1,c));return d.getUTCDate()!==c?!1:d.getUTCMonth()!==b-1?!1:d.getUTCFullYear()!==a?!1:!0}function e(a,b,c){return a>=24||0>a?!1:b>=60||0>b?!1:c>=60||0>c?!1:!0}var f=b.r(114),g=b.r(119),h=b.r(100),i=b.r(116),j=9999,k=1900;return{exec:function(b){var d;return(d=a(b))?{type:f.NUMBER,subType:g.DATE,format:i._default[g.DATE],value:h.dateToNumber(d.year,d.month,d.day)+""}:(d=c(b),d?{type:f.NUMBER,subType:g.TIME,format:i._default[g.TIME],value:h.timeToNumber(d.hour,d.minute,d.second)+""}:!1)}}}},b[97]={value:function(){var a=b.r(114),c=b.r(119),d=/^(?:(\d+)\s)?(\d+)\/(\d+)$/,e=b.r(116);return{exec:function(b){var f,g,h;return d.test(b)?(f=+RegExp.$1,g=+RegExp.$2,h=+RegExp.$3,{type:a.NUMBER,subType:c.FRACTION,format:e._default[c.FRACTION],value:f+g/h+""}):!1}}}},b[98]={value:function(){var a=b.r(114),c=b.r(119),d=b.r(116);return{exec:function(b){return-1!==b.toLowerCase().indexOf("e")?{type:a.NUMBER,subType:c.SCIENTIFIC,format:d._default[c.SCIENTIFIC],value:+b+""}:{type:a.NUMBER,subType:c.GENERAL,value:+b+""}}}}},b[99]={value:function(){var a=b.r(114),c=b.r(119),d=/^([\s\S]+)%$/,e=b.r(116);return{exec:function(b){return d.test(b)&&$.isNumeric(RegExp.$1)?{type:a.NUMBER,subType:c.PERCENT,format:e._default[c.PERCENT],value:+RegExp.$1+""}:!1}}}},b[100]={value:function(){var a=Date.UTC(1900,0,0),b=864e5,c=3600,d=86400,e=1/d;return{dateToNumber:function(c,d,e){var f=Date.UTC(c,d-1,e)-a;return f/b},timeToNumber:function(a,b,d){return(a*c+60*b+d)*e},numberToDate:function(c){c=parseInt(c,10);var d=new Date(c*b+a);return{year:d.getUTCFullYear(),month:d.getUTCMonth()+1,day:d.getUTCDate(),weekday:d.getUTCDay()}},numberToTime:function(a){if(a-=parseInt(a,10),0===a)return{hour:0,minute:0,second:0,totalSecond:0};var b=Math.round(a/e),d=Math.floor(b/c);return{hour:d,minute:Math.floor(b%c/60),second:b%60,totalSecond:b,am:12>d}}}}},b[101]={value:function(){var a=b.r(90);return b.r(0).create("Format",{dataAccess:null,base:b.r(135),init:function(a){this.dataAccess=a},analyzeFormatInfo:function(b,c,d){return a.exec(b,this.dataAccess.getNumberFormat(c,d))}})}},b[102]={value:function(){function a(a,b){var d,e,f=[],g="",h=0;$.isArray(b[0])&&(h=1,g=b[0][0]);for(var i=a.length-1,j=b.length-1;j>=h;j--)e=b[j],d=a[i],$.isArray(e)?f.push(e[0]):-1===c.indexOf(e)?"*"!==e&&(","===e&&d?f.push(e):"%"!==e?(i--,"0"!==e?"#"===e&&d?f.push(d):"?"===e&&d&&f.push(d||" "):f.push(d||0)):f.push(e)):f.push(e);return a=a.slice(0,i+1),g+a.join("")+f.reverse().join("")}function b(a,b){for(var d,e,f=[],g=0,h=0,i=b.length;i>h;h++)e=b[h],d=a[g],$.isArray(e)?f.push(e[0]):-1===c.indexOf(e)?"*"!==e&&(","!==e?"%"!==e?(g++,"0"!==e?"#"===e&&d?f.push(d):"?"===e&&d&&f.push(d||" "):f.push(d||0)):f.push(e):f.push(d)):f.push(e);return f.join("")}var c="$\xa5+(:^'{<=-/)&~}> .";return{formatLeftPart:function(b,c){return b=b.split(""),a(b,c)},formatRightPart:function(a,c){return a=a.split(""),b(a,c)}}}},b[103]={value:function(){var a=b.r(114),c=b.r(104),d=b.r(109),e=b.r(117);return b.r(0).create("Formatter",{dataAccess:null,base:b.r(135),init:function(a){this.dataAccess=a},getValue:function(b,f,g){if(!b)return void 0;switch(b){case a.LOGICAL:f="1"===f?e.TRUE:e.FALSE;case a.TEXT:return d.exec(f,g);case a.NUMBER:return c.exec(f,g);case a.ERROR:return f}},getStandardValue:function(b,d){var f=this.dataAccess.getCellType(b,d);if(!f)return void 0;var g=this.dataAccess.getValue(b,d);switch(f){case a.TEXT:case a.FORMULA:case a.ERROR:return g;case a.NUMBER:return c.getStandardValue(g,this.dataAccess.getNumberFormat(b,d));case a.LOGICAL:return g?e.TRUE:e.FALSE}}})}},b[104]={value:function(){var a=b.r(88),c=b.r(106),d=b.r(108),e=b.r(105),f=b.r(107),g=b.r(87),h=b.r(116);return{exec:function(b,h){if(void 0===b)return void 0;if(!h)return b;var i=a.getNumberSegment(b,h);switch(i.segment.flag){case g.DECIMAL:return c.exec(b,i);case g.SCIENTIFIC:return d.exec(b,i);case g.DATETIME:return e.exec(b,i);case g.FRACTION:return f.exec(b,i)}},getStandardValue:function(b,c){if(!c)return b;var d=a.getNumberSegment(b,c),f=d.segment;switch(f.flag){case g.DATETIME:return d=f.hasDate&&f.hasTime?a.getNumberSegment(b,h._default.DATETIME):f.hasDate?a.getNumberSegment(b,h._default.DATE):a.getNumberSegment(b,h._default.TIME),e.exec(b,d);default:return b}}}}},b[105]={value:function(){function a(a,b,j){var k=c.numberToDate(a),l=c.numberToTime(a);j&&(l.hour%=12);for(var m,n=[],o=0,p=b.length;p>o;o++)if(m=b[o],"string"==typeof m)if(-1===i.indexOf(m)){if("*"!==m)switch(m){case"m":n.push(k.month);break;case"mm":n.push(k.month<10?"0"+k.month:k.month);break;case"mmm":n.push(d[k.month]);break;case"mmmm":n.push(f[k.month]);break;case"mmmmm":n.push(e[k.month]);break;case"d":n.push(k.day);break;case"dd":n.push(k.day<10?"0"+k.day:k.day);break;case"ddd":n.push(g[k.weekday]);break;case"dddd":n.push(h[k.weekday]);break;case"yy":n.push((k.year+"").substring(2));break;case"yyyy":n.push(k.year);break;case"H":n.push(l.hour);break;case"HH":n.push(l.hour<10?"0"+l.hour:l.hour);break;case"M":n.push(l.minute);break;case"MM":n.push(l.minute<10?"0"+l.minute:l.minute);break;case"S":n.push(l.second);break;case"SS":n.push(l.second<10?"0"+l.second:l.second);break;case"A/P":n.push(l.am?"A":"P");break;case"AM/PM":n.push(l.am?"AM":"PM")}}else n.push(m);else n.push(m.join(""));return n.join("")}var c=b.r(100),d=["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],e=["","J","F","M","A","M","J","J","A","S","O","N","D"],f=["","January","February","March","April","May","June","July","August","September","October","November","December"],g=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],h=["Sunday","Monday","Tuesday","Wednesday","Thurday","Friday","Saturday"],i="$\xa5+(:^'{<=-/)&~}> .";return{exec:function(b,c){return 0>b||b>2958465?void 0:a(b,c.segment.value.front,c.segment.dSign)}}}},b[106]={value:function(){var a=b.r(102);return{exec:function(b,c){var d=c.segment;1==c.index&&1===c.select&&(b=Math.abs(b)+""),b=(+b).toFixed(d.value.backCount),b=(b+"").split(".");var e=b[0],f=b[1]||"";return e=a.formatLeftPart(e,d.value.front),f=a.formatRightPart(f,d.value.back),e+f}}}},b[107]={value:function(){b.r(102);return{exec:function(){}}}},b[108]={value:function(){var a=b.r(102),c=/(\d+)(?:\.(\d+))?e([+-])(\d+)/i;return{exec:function(b,d){var e=d.segment;1==d.index&&1===d.select&&(b=Math.abs(b)+""),b=(+b).toExponential(e.value.backCount);var f=c.exec(b),g=a.formatLeftPart(f[1],e.value.front),h="";f[2]&&(h=a.formatRightPart(f[2],e.value.back));var i,j=a.formatLeftPart(f[4],e.exponent.front),k=a.formatLeftPart("",e.exponent.back),l=e.eSign;return i="-"===f[3]?"-":"e+"===l?"+":"",g+h+"E"+i+j+k}}}},b[109]={value:function(){var a=b.r(88);return{exec:function(b,c){if(void 0===b)return void 0;if(!c)return b;var d=a.getTextSegment(c);return d?void 0:b}}}},b[110]={value:function(){var a=b.r(114),c=b.r(119),d=b.r(101),e=b.r(103),f=b.r(89),g=b.r(0).create("Value",{dataAccess:null,formulaModule:null,rangeFacade:null,valueSecurityModule:null,format:null,formatter:null,colorManager:null,base:b.r(138),init:function(a,b,c){this.dataAccess=a,this.formulaModule=b,this.valueSecurityModule=c,this.format=this.createComponent(d,a),this.formatter=this.createComponent(e,a),this.colorManager=this.createComponent(f,a),this.formulaModule.bind(this),this.initService()},run:function(){this.rangeFacade=this.getModule("range").getRange()},initService:function(){this.registerService({"c.write":this.writeCell,"c.batchwrite":this.batchWriteCell,"c.clear.content":this.clearContent,"c.set.format":this.setFormat})},writeCell:function(b,d,e,f){if(!this.valueSecurityModule.check(d,e,f))return!1;this.corePrepareRefresh(),this.__clearData(d,e),this.postMessage("c.contentchange",d,e);var b=this.cs("c.encode.content",b),g=this.format.analyzeFormatInfo(b,d,e);this.dataAccess.setCellType(g.type,d,e),this.dataAccess.setValue(g.value,d,e),g.type===a.NUMBER&&g.subType!==c.GENERAL&&this.dataAccess.setNumberFormat(g.format,{row:d,col:e},{row:d,col:e}),g.type===a.FORMULA&&(f?this.formulaModule.setArrayFormula(this.rangeFacade.getStart(),this.rangeFacade.getEnd(),g.value):this.formulaModule.setFormula(d,e,g.value)),this.coreRefresh()},batchWriteCell:function(a,b,c){for(var d,e,f=a.length,g=0,h=this.dataAccess.getTotalIndex(),i=0,j=a.length;j>i;i++)g=Math.max(g,a[i].length);this.corePrepareRefresh(),b+f>h.row&&this.dataAccess.expandRow(100*Math.ceil((b+f-h.row)/100)),c+g>h.col&&this.dataAccess.expandCol(26*Math.ceil((c+g-h.col)/26));for(var i=0,j=a.length;j>i;i++)if(d=a[i])for(var k=0,l=d.length;l>k;k++)e=d[k],e&&this.writeCell(e.content,b+i,c+k);this.coreRefresh()},setFormat:function(a,b,c){for(var d=b.row,e=c.row;e>=d;d++)for(var f=b.col,g=c.col;g>=f;f++)this.dataAccess.clearFormatColor(d,f),this.dataAccess.clearFormattedValue(d,f);this.dataAccess.setNumberFormat(a,b,c),this.coreRefresh(!0)},getFormatColor:function(a,b){var c=this.getComputedValueInfo(a,b),d=this.dataAccess.getFormatColor(a,b);if(!d){var e=this.dataAccess.getNumberFormat(a,b);d=this.colorManager.calculateFormatColor(c.type,c.value,e),d||(d="none"),this.dataAccess.setFormatColor(d,a,b)}return"none"===d?void 0:d},clearContent:function(a){for(var b,c,d,e=0,f=a.length;f>e;e++){b=a[e],c=b.start,d=b.end;for(var e=c.row,g=d.row;g>=e;e++)for(var h=c.col,i=d.col;i>=h;h++)this.__clearData(e,h);this.postMessage("c.contentchange",c,d)}this.coreRefresh(!0)},__clearData:function(a,b){this.dataAccess.clearCellType(a,b),this.dataAccess.clearValue(a,b),this.formulaModule.clearFormula(a,b),this.dataAccess.clearNumberFormat({row:a,col:b},{row:a,col:b}),this.clearCache(a,b)},clearCache:function(a,b){this.dataAccess.clearComputedValue(a,b),this.dataAccess.clearFormattedValue(a,b),this.dataAccess.clearWraptextRecord(a,b),this.dataAccess.clearFormatColor(a,b)},getComputedValue:function(a,b){return this.getComputedValueInfo(a,b).value},getComputedValueInfo:function(b,c){var d=this.dataAccess.getComputedValue(b,c);if(d)return d;if(this.formulaModule.isArrayFormula(b,c))return this.formulaModule.getComputedValueInfo(b,c);var e=this.dataAccess.getCellType(b,c);return void 0===e?{type:a.UNDEFINED,value:void 0}:e===a.FORMULA?this.formulaModule.getComputedValueInfo(b,c):(d={type:e,value:this.getRawValue(b,c)},this.dataAccess.setComputedValue(d,b,c),d)},getFormattedValue:function(a,b){return this.getFormattedValueInfo(a,b).value},getFormattedValueInfo:function(b,c){var d=this.dataAccess.getFormattedValue(b,c);if(d)return d;var e=this.getComputedValueInfo(b,c);if(e.type===a.UNDEFINED)return e;e=$._clone(e);var f=this.dataAccess.getNumberFormat(b,c);return e.value=this.formatter.getValue(e.type,e.value,f),this.dataAccess.setFormattedValue(e,b,c),e},getStandardValue:function(a,b){var c=this.dataAccess.getCellType(a,b);if(!c)return"";var d=this.dataAccess.getStandardValue(a,b);return d||(d=this.formatter.getStandardValue(a,b),this.dataAccess.setStandardValue(d)),d},getRawValue:function(a,b){return this.dataAccess.getValue(a,b)},getRawType:function(a,b){var c=this.dataAccess.getCellType(a,b);if(c)return c;var d=this.dataAccess.getValue(a,b),e=this.format.analyzeFormatInfo(d,a,b);return this.dataAccess.setCellType(e.type,a,b),e.type}});return g.deps=["dataAccess","formula","valueSecurity"],g}},b[111]={value:function(){var a=b.r(0).create("View",{dataAccess:null,base:b.r(138),init:function(a){this.dataAccess=a,this.initService()},initService:function(){this.registerService({"c.scroll":this.scroll,"c.scrollto":this.scrollTo,"c.row.scrollto":this.scrollRowTo,"c.col.scrollto":this.scrollColTo,"c.row.scroll":this.scrollRow,"c.col.scroll":this.scrollCol,"c.scroll.row.to.end":this.scrollRowToEnd,"c.scroll.column.to.end":this.scrollColumnToEnd,"c.scroll.to.end":this.scrollToEnd,"c.updateview":this.updateview})},updateview:function(a){(0!==a.row||0!==a.column)&&(this.corePrepareRefresh(),void 0!==a.row?this.scrollRow(a.row):void 0!==a.rowTo?this.scrollRowTo(a.rowTo):void 0!==a.rowToEnd&&this.scrollRowToEnd(a.rowToEnd),void 0!==a.column?this.scrollCol(a.column):void 0!==a.columnTo?this.scrollColTo(a.columnTo):void 0!==a.columnToEnd&&this.scrollColumnToEnd(a.columnToEnd),this.coreRefresh(),this.postMessage("c.view.change"))},scrollRowTo:function(a){this.__resetRowToStart(a),this.postMessage("c.view.change")},scrollColTo:function(a){this.__resetColumnToStart(a),this.postMessage("c.view.change")},scrollTo:function(a,b){this.__resetRowToStart(a),this.__resetColumnToStart(b),this.postMessage("c.view.change")},scroll:function(a,b){this.corePrepareRefresh();var c=this.dataAccess.getViewStart();this.__resetRowToStart(a+c.row),this.__resetColumnToStart(b+c.col),this.coreRefresh()},scrollRow:function(a){var b=this.dataAccess.getViewStart();this.__resetRowToStart(a+b.row),this.postMessage("c.view.change")},scrollCol:function(a){var b=this.dataAccess.getViewStart();this.__resetColumnToStart(a+b.col),this.postMessage("c.view.change")},scrollToEnd:function(a,b){this.corePrepareRefresh(),this.scrollRowToEnd(a),this.scrollColumnToEnd(b),this.coreRefresh()},scrollRowToEnd:function(a){var b=this.dataAccess.getTotal();0>a?a=0:a>=b.row&&(a=b.row-1);var c=this.dataAccess.getViewEnd();this.dataAccess.setViewEnd(a,c.col),this.postMessage("c.row.calculation.reverse"),this.coreRefresh(!0),this.postMessage("c.view.change")},scrollColumnToEnd:function(a){var b=this.dataAccess.getTotal();0>a?a=0:a>=b.col&&(a=b.col-1);var c=this.dataAccess.getViewEnd();this.dataAccess.setViewEnd(c.row,a),this.postMessage("c.col.calculation.reverse"),this.coreRefresh(!0),this.postMessage("c.view.change")},__resetRowToStart:function(a){var b=this.dataAccess.getTotal();0>a?a=0:a>=b.row&&(a=b.row-1);var c=this.dataAccess.getViewStart();a!==c.row&&(this.dataAccess.setViewStart(a,c.col),this.coreRefresh(!0))},__resetColumnToStart:function(a){var b=this.dataAccess.getTotal();0>a?a=0:a>=b.col&&(a=b.col-1);var c=this.dataAccess.getViewStart();a!==c.col&&(this.dataAccess.setViewStart(c.row,a),this.coreRefresh(!0))}});return a.deps=["dataAccess"],a}},b[112]={value:function(){var a=b.r(0).create("Visible",{dataAccess:null,base:b.r(138),init:function(a){this.dataAccess=a},rowIsVisible:function(a){var b=this.dataAccess.getGrid();return void 0!==b.rMap[a]},rowIsFullVisible:function(a){var b=this.dataAccess.getGrid(),c=b.rMap[a];return void 0===c?!1:c===b.rowMap.length-1?!1:!0},columnIsVisible:function(a){var b=this.dataAccess.getGrid();return void 0!==b.cMap[a]},columnIsFullVisible:function(a){var b=this.dataAccess.getGrid(),c=b.cMap[a];return void 0===c?!1:c===b.colMap.length-1?!1:!0},getViewPosition:function(a,b){var c=this.rs("c.struct"),d=c.getGrid(),e=d.rowMap,f=d.colMap,g=e[0],h=f[0],i=e[e.length-1],j=f[f.length-1],k=h>b?8:0,l=b>=j?4:0,m=g>a?2:0,n=a>=i?1:0;switch(k|l|m|n){case 10:return"leftTop";case 9:return"leftBottom";case 6:return"rightTop";case 5:return"rightBottom";case 8:return"left";case 4:return"right";case 2:return"top";case 1:return"bottom";default:return"in"}}});return a.deps=["dataAccess"],a}},b[113]={value:function(){var a=b.r(14),c=a.cell.width,d=a.CONTENT_PADDING,e=a.border.width,f=a.CANDIDATE_FONT,g=50,h=b.r(0).create("Wraptext",{shadowCanvas:null,canvasContext:null,dataAccess:null,valueModule:null,styleModule:null,cellModule:null,base:b.r(138),init:function(a,b,c){this.dataAccess=a,this.styleModule=c,this.valueModule=b,this.shadowCanvas=this.createElement("canvas"),this.canvasContext=this.shadowCanvas.getContext("2d"),this.shadowCanvas.width=1,this.shadowCanvas.height=1,this.initMessageHook()},initMessageHook:function(){this.onMessage({"c.contentchange":this.__contentChange,"c.stylechange":this.__styleChange,"c.columnresize":this.__columnResize,"c.rowresize":this.__rowResize,"c.mergechange":this.__mergeChange})},getDisplayValue:function(a,b){var c=this.styleModule.getComputedStyle("alignments",a,b),d=this.valueModule.getFormattedValue(a,b);return c.wraptext?this.__getContent(d,a,b):d},__getContent:function(a,b,c){if(a){var d=this.dataAccess.getMergeCell(b,c);d&&(b=d.start.row,c=d.start.col);var e=this.dataAccess.getWraptextRecord(b,c);if(e)return e;var f=this.styleModule.getComputedStyle("fonts",b,c),g=this.__getWrapText(f,a,b,c);return this.dataAccess.recordWraptext(g,b,c),g}},__getWrapText:function(a,b,c,e){var h,i,j=this.canvasContext;j.font=[a.italic?"italic":"normal",a.bold?"bold":"normal",a.size+"px",a.name+","+f].join(" "),i=this.dataAccess.getMergeCell(c,e),h=i?this.__getCellsWidth(i.start.col,i.end.col)-d:this.__getCellWidth(e)-d,0>=h&&(h=g);for(var k=[],l=b.split("\n"),m=0,n=l.length;n>m;m++)k.push(j.measureText(l[m]).width);return l=this.__checkText(h,k,l,parseInt(a.fontSize,10)),l.join("\n")},__checkText:function(a,b,c,d){for(var e,f=[],g=0,h=c.length;h>g;g++)e=b[g],a>=e?f.push(c[g]):this.__wraptext(f,a,e,c[g],"",2*d);return f},__wraptext:function(a,b,c,d,e,f){var g,h=this.canvasContext;if(c===b){if(a.push(d),0===e.length)return;d=e,e="",c=h.measureText(d).width}if(b>=c&&0===e.length)return void a.push(d);var i=Math.abs(c-b);if(c>b){for(;c>b;)g=d.length-1,e=d.charAt(g)+e,d=d.substring(0,g),c=h.measureText(d).width;if(a.push(d),0===e.length)return;c=h.measureText(e).width,this.__wraptext(a,b,c,e,"",f)}else if(f>i){for(;e.length&&(d+=e.charAt(0),e=e.substring(1),c=h.measureText(d).width,!(c>b)););if(c>b)return e=d.charAt(d.length-1)+e,d=d.substring(0,d.length-1),a.push(d),d=e,e="",c=h.measureText(d).width,this.__wraptext(a,b,c,d,e,f);a.push(d)}else g=Math.ceil(e.length/2),d+=e.substring(0,g),e=e.substring(g),c=h.measureText(d).width,this.__wraptext(a,b,c,d,e,f)},__contentChange:function(a,b){var c=a,d=b;if(isNaN(+a))for(var e=c.row,f=d.row;f>=e;e++)for(var g=c.col,h=d.col;h>=g;g++)this.__clear(e,g);else this.__clear(a,b)},__styleChange:function(a,b){for(var c,d=a.row,e=b.row;e>=d;d++)for(var f=a.col,g=b.col;g>=f;f++)c=this.dataAccess.getMergeCell(d,f),c?this.__clear(c.start.row,c.start.col):this.__clear(d,f)},__mergeChange:function(a,b){for(var c,d=a.row,e=b.row;e>=d;d++)for(var f=a.col,g=b.col;g>=f;f++)c=this.dataAccess.getMergeCell(d,f),c?this.__clear(c.start.row,c.start.col):this.__clear(d,f)},__columnResize:function(a){for(var b,c=this.dataAccess.getTotalIndex(),d=0,e=c.row;e>=d;d++)b=this.dataAccess.getMergeCell(d,a),b?this.__clear(b.start.row,b.start.col):this.__clear(d,a)},__rowResize:function(a){for(var b,c=this.dataAccess.getTotalIndex(),d=0,e=c.col;e>=d;d++)b=this.dataAccess.getMergeCell(a,d),b?this.__clear(b.start.row,b.start.col):this.__clear(a,d)},__clear:function(a,b){this.dataAccess.clearWraptextRecord(a,b)},__getCellsWidth:function(a,b){for(var c,d=0,f=a;b>=f;f++)c=this.__getCellWidth(f),0!==c&&(d+=c+e);return d},__getCellWidth:function(a){var b=this.dataAccess.getColumnWidth(a);return void 0===b?c:b}});return h.deps=["dataAccess","value","style"],h}},b[114]={value:{TEXT:"TEXT",NUMBER:"NUMBER",LOGICAL:"LOGICAL",ERROR:"ERROR",UNDEFINED:"UNDEFINED",FORMULA:"FORMULA",ARRAY:"ARRAY"}},b[115]={value:{NULL:"#NULL!",DIV0:"#DIV/0!",VALUE:"#VALUE!",REF:"#REF!",NAME:"#NAME?",NUM:"#NUM!",NAN:"#N/A",DATA:"#GETTING_DATA"}},b[116]={value:function(){var a={1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",5:'_ * #,##0_ ;_ * -#,##0_ ;_ * "-"_ ;_ @_ ',6:'_ * #,##0.00_ ;_ * -#,##0.00_ ;_ * "-"??_ ;_ @_ ',7:'_ \xa5* #,##0_ ;_ \xa5* -#,##0_ ;_ \xa5* "-"_ ;_ @_ ',8:'_ \xa5* #,##0.00_ ;_ \xa5* -#,##0.00_ ;_ \xa5* "-"??_ ;_ @_ ',9:"#,##0;-#,##0",10:"#,##0;[red]-#,##0",11:"#,##0.00;-#,##0.00",12:"#,##0.00;[red]-#,##0.00",13:"\xa5#,##0;\xa5-#,##0",14:"\xa5#,##0;[red]\xa5-#,##0",15:"\xa5#,##0.00;\xa5-#,##0.00",16:"\xa5#,##0.00;[red]\xa5-#,##0.00",17:"0%",18:"0.00%",19:"0.00E+00",20:"##0.0E+0",21:"# ?/?",22:"# ??/??",23:"$#,##0_);($#,##0)",24:"$#,##0_);[red]($#,##0)",25:"$#,##0.00_);($#,##0.00)",26:"$#,##0.00_);[red]($#,##0.00)",27:'yyyy"\u5e74"m"\u6708"',28:'m"\u6708"d"\u65e5"',29:"yyyy/m/d",30:'yyyy"\u5e74"m"\u6708"d"\u65e5"',31:"m/d/yy",32:"d-mmm-yy",33:"d-mmm",34:"mmm-yy",35:"h:mm AM/PM",36:"h:mm:ss AM/PM",37:"h:mm",38:"h:mm:ss",39:'h"\u65f6"mm"\u5206"',40:'h"\u65f6"mm"\u5206"ss"\u79d2"',41:'\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"',42:'\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2"',43:"yyyy/m/d h:mm",44:"mm:ss",45:"mm:ss.0",46:"@",47:"[h]:mm:ss",48:"0.00_);[red](0.00)",49:"0.00_);(0.00)",50:"0.00;[red]0.00",51:"0.00_ "};return a._default={DECIMAL:a[51],CURRENCY:a[15],PERCENT:a[18],SCIENTIFIC:a[19],FRACTION:a[21],DATE:a[29],TIME:a[38],DATETIME:a[22],TEXT:a[46]},a}},b[117]={value:{TRUE:"TRUE",FALSE:"FALSE"}},b[118]={value:function(){return"none"}},b[119]={value:{GENERAL:"GENERAL",DECIMAL:"DECIMAL",CURRENCY:"CURRENCY",PERCENT:"PERCENT",SCIENTIFIC:"SCIENTIFIC",FRACTION:"FRACTION",DATE:"DATE",TIME:"TIME",DATETIME:"DATETIME",TEXT:"TEXT"}},b[120]={value:function(){return b.r(0).create("RedoCommand",{base:b.r(134),execute:function(){return this.____ctx.redo()}})}},b[121]={value:function(){return b.r(0).create("UndoCommand",{base:b.r(134),execute:function(){return this.____ctx.undo()}})}},b[122]={value:function(){var a=b.r(14),c=b.r(2);return b.r(0).create("Configure",{constructor:function(){this.config=c.extend(!0,{},a)},getConfig:function(a){return a?this.config[a]||null:this.config}})}},b[123]={value:function(){var a=b.r(126),c=b.r(127),d=b.r(130),e=b.r(125),f=b.r(128),g=b.r(129),h=b.r(122),i=b.r(131),j=b.r(132),k=b.r(0).create("Context",{target:null,config:null,loader:null,____type:"core",manager:{},constructor:function(a){this.target=a,this.config=new h,this.loader=new i(this),this.init(),this.initModuleLoadListener(),this.manager.command.startBasic(),this.loader.start(),this.ready()},getConfig:function(a){return this.config.getConfig(a)},getDocument:function(){return this.manager.element.getDocument()},getContainer:function(a){return this.manager.container.getContainer(a)},getSize:function(a){return this.manager.container.getSize(a)},resizeContianer:function(){return this.manager.container.resize()},createElement:function(a,b){return this.manager.element.createElement(a,b)},execCommand:function(a,b,c){return this.manager.command.execCommand(a,b,c)},queryCommandValue:function(a,b,c){return this.manager.command.queryCommandValue(a,b,c)},undo:function(){return this.manager.command.undo()},redo:function(){return this.manager.command.redo()},getModule:function(a){return this.loader.getModule(this,a)},registerService:function(a,b,c){return this.manager.service.registerService(a.____type,a,b,c)},rs:function(a,b,c){return this.manager.service.rs(a.____type,b,c)},registerCommonService:function(a,b,c){return this.manager.service.registerCommonService(a,b,c)},cs:function(a,b){return this.manager.service.cs(a,b)},onMessage:function(a,b,c){return this.manager.message.onMessage(a.____type,a,b,c)},postMessage:function(a,b,c){return this.manager.message.postMessage(a.____type,b,c)},closeMessage:function(){this.manager.message.close()},openMessage:function(){this.manager.message.open()},addEventListener:function(){return this.manager.message.addEventListener.apply(this.manager.message,arguments)},on:function(){return this.manager.message.addInternalListener.apply(this.manager.message,arguments)},prepareRefresh:function(){this.manager.refresh.prepareRefresh()},refresh:function(a){this.manager.refresh.refresh(a)},plug:function(a,b){this.manager.refresh.plug(a,b)},init:function(){var b=this.target;this.manager.element=new c(this,b),this.manager.container=new a(this,b),this.manager.service=new d(this,b),this.manager.command=new e(this,b),this.manager.message=new f(this,b),this.manager.refresh=new g(this,b)},initModuleLoadListener:function(){var a=this;this.loader.onBeforeLoad(function(b){a.manager.command.start(b)})},ready:function(){this.target.appendChild(this.getContainer("main"))}});return $.extend(k,{registerModule:function(a){i.register(a)},addCommand:function(a){e.add(a)},mapEvent:function(){f.map.apply(f,arguments)},registerPlugin:function(a,b){i.registerPlugin(a,j.wrap(a,b))}}),k}},b[124]={value:function(){return b.r(0).create("CommandStack",{stack:[],max:50,topIndex:-1,validIndex:-1,stackItem:[],hold:!1,commandCount:0,constructor:function(a){this.max=a},pop:function(){var a=this.topIndex;return 0>a?null:(this.topIndex--,this.stack[a])},push:function(a,b){this.hold||this.stackItem.push({command:a,args:b})},holdOn:function(){this.hold=!0},goOn:function(){this.hold=!1},begin:function(){this.commandCount++},end:function(){this.commandCount--},moveUp:function(){return this.topIndex>=this.validIndex?null:(this.topIndex++,this.stack[this.topIndex])},complete:function(){this.hold||0===this.commandCount&&(this.topIndex++,this.validIndex=this.topIndex,this.stack[this.topIndex]=this.stackItem,this.stackItem=[])}})}},b[125]={value:function(){var a=b.r(124),c=b.r(2),d={core:{},system:{},ext:{},basic:{}},e=b.r(0).create("Command",{base:b.r(1),stack:null,commands:null,executeLock:0,init:function(){this.commands=c.extend(!0,{},d),this.stack=new a(this.getContext().getConfig("stack"))},startBasic:function(){this.start("basic")},start:function(a){var b,e=d[a],f=this.getContext(),g=/\s+/,h=this.commands[a];c.each(e,function(c,d){b=new d(f),c=b.name?b.name.trim().split(g):[c],b.____type=a,b.init();for(var e=0,i=c.length;i>e;e++)h[c[e]]=b})},execCommand:function(a,b,c){var d=null;if("string"!=typeof b)for(var e=0,f=b.length;f>e;e++)this.__execCommand(a,b[e].command,b[e].args);else d=this.__execCommand(a,b,c);return d},queryCommandValue:function(a,b,c){var d=this.__getCommand(a,b);if(!d)throw new Error("command notfound: "+b);return c.unshift(b),c=d.queryValueBefore.apply(d,c),c!==!1?(c.unshift(b),d.queryValue.apply(d,c)):void 0},__execCommand:function(a,b,d){var e,f=this.__getCommand(a,b);if(!f)throw new Error("command notfound: "+b);d=f.execBefore.apply(f,[b].concat(d)),d=[b].concat(d);var g=!!f.unexecute;this.stack.begin(),this.lock(),g&&(e=f.getStackInfo.apply(f,d),e=c._clone([b].concat(e)),this.stack.push(f,{redo:c._clone(d),undo:e,range:f.getRange()}));var h=f.execute.apply(f,d);return this.stack.end(),g&&this.stack.complete(),this.unlock(),this.emitCommandExecute(d),h},undo:function(){var a,b,c=this.stack.pop();if(null==c)return!1;this.stack.holdOn();for(var d=0,e=c.length;e>d;d++)a=c[d],b=a.command,b.unexecute.apply(b,a.args.undo),b.resetRange(a.args.range);return this.stack.goOn(),!0},redo:function(){var a,b,c=this.stack.moveUp();if(null==c)return!1;this.stack.holdOn();for(var d=0,e=c.length;e>d;d++)a=c[d],b=a.command,b.execute.apply(b,a.args.redo),b.resetRange(a.args.range);return this.stack.goOn(),!0},lock:function(){this.executeLock++},unlock:function(){this.executeLock--},__getCommand:function(a,b){var c,d=[];
switch(null===a&&(a="ext"),a){case"ext":d.push(this.commands.ext);case"system":d.push(this.commands.system);case"core":d.push(this.commands.core);case"basic":d.push(this.commands.basic)}for(var e=0,f=d.length;f>e;e++)if(c=d[e][b])return c;return null},emitCommandExecute:function(a){0===this.executeLock&&this.getContext().postMessage(this.getContext(),"c.command.exec",c._clone(a))}});return c.extend(e,{add:function(a){c.extend(!0,d,a)}}),e}},b[126]={value:function(){return b.r(0).create("Container",{base:b.r(1),containers:{},size:{},init:function(){this.__initContainer(),this.resize()},getContainer:function(a){return"scroll"===a?{h:this.containers.scrollbarBottom,v:this.containers.scrollbarRight}:this.containers[a]},getSize:function(a){return $.extend({},this.size[a])},resize:function(){this.__refreshSize();var a=this.size;$(this.containers.main).css({width:a.main.width,height:a.main.height}),$(this.containers.left).css({width:a.left.width,height:a.left.height}),$(this.containers.top).css({width:a.top.width,height:a.top.height}),$(this.containers.content).css({width:a.content.width,height:a.content.height}),$(this.containers.scrollbarRight).css({height:a.scroll.v.height}),$(this.containers.scrollbarBottom).css({width:a.scroll.h.width})},__initContainer:function(){var a=this.context.getConfig("head"),b=this.context.getConfig("scrollbar"),c=this.context.getConfig("background"),d=this.context.getConfig("border"),e=d.width,f=d.color;this.containers={main:this.createElement("btb-main-container",{background:c}),left:this.createElement("btb-left-container",{top:a.height}),top:this.createElement("btb-top-container",{left:a.width}),content:this.createElement("btb-content-container",{top:a.height,left:a.width}),scrollbarRight:this.createElement("btb-scrollbar-v-container",{width:b.width,top:a.height,right:0,borderWidth:e,borderColor:f,backgroundColor:b.background}),scrollbarBottom:this.createElement("btb-scrollbar-h-container",{height:b.width,bottom:0,left:a.width,borderWidth:e,borderColor:f,backgroundColor:b.background})},this.containers.main.appendChild(this.containers.top),this.containers.main.appendChild(this.containers.left),this.containers.main.appendChild(this.containers.content),this.containers.main.appendChild(this.containers.scrollbarRight),this.containers.main.appendChild(this.containers.scrollbarBottom)},__refreshSize:function(){var a=this.context.getConfig("head"),b=this.context.getConfig("scrollbar"),c=(this.context.getConfig("background"),this.context.getConfig("border")),d=c.width,e={width:this.target.clientWidth,height:this.target.clientHeight},f={width:e.width-b.width,height:e.height-b.width},g={width:f.width-a.width,height:f.height-a.height},h={width:g.width,height:a.height},i={width:a.width,height:g.height};this.size={main:e,left:i,top:h,content:g,scroll:{h:{width:g.width-2*d,height:b.width},v:{width:b.width,height:g.height-2*d}}}},createElement:function(a,b){return this.context.createElement("div",{attr:{"class":"btb-container "+a},style:b})}})}},b[127]={value:function(){var a=b.r(2);return b.r(0).create("ElementFactory",{base:b.r(1),doc:null,createElement:function(b,c){var d=this.doc.createElement(b);return"string"==typeof c?(d.className=c,d):(c&&(c.attr&&a(d).attr(c.attr),c.inner&&(d.innerHTML=c.inner),c.style&&a(d).css(c.style)),d)},getDocument:function(){return this.doc},init:function(){this.doc=this.target.ownerDocument}})}},b[128]={value:function(){var a=b.r(2),c={},d=b.r(0).create("Message",{base:b.r(1),pool:{core:{},system:{},ext:{}},eventPool:{},internalEventPool:{},chain:{},count:0,state:!0,addEventListener:function(a,b){var c={},d=this.eventPool;b?c[a]=b:c=a;for(var e in c)c.hasOwnProperty(e)&&(d[e]||(d[e]=[]),d[e].push(c[e]))},addInternalListener:function(a,b,c){var d={},e=this.internalEventPool;c?d[b]=c:d=b;for(var f in d)d.hasOwnProperty(f)&&(e[f]||(e[f]=[]),e[f].push({subscriber:a,handler:d[f]}))},onMessage:function(a,b,c,d){var e={},f=this.pool[a];"string"==typeof c?e[c]=d:e=c;for(var g in e)e.hasOwnProperty(g)&&(f[g]||(f[g]=[]),f[g].push({listener:b,handler:e[g]}))},postMessage:function(a,b,d){if(this.state){var e,f=[];if(this.chain[b])return void delete this.chain[b];switch(this.chain[b]=!0,a){case"core":f.push(this.pool.core);case"system":f.push(this.pool.system);case"ext":f.push(this.pool.ext)}try{for(var g=0,h=f.length;h>g;g++)if(e=f[g][b])for(var i=0,j=e.length;j>i;i++)e[i].handler.apply(e[i].listener,d)}finally{delete this.chain[b],c[b]&&this.emit(c[b],d)}}},emit:function(b,c){var d=this.internalEventPool[b]||[],e=this.eventPool[b]||[];c=[b].concat(c);for(var f=0,g=d.length;g>f;f++)d[f].handler.apply(d[f].subscriber,a._clone(c));for(var f=0,g=e.length;g>f;f++)e[f].apply(null,a._clone(c))},close:function(){this.count++,this.state=!1},open:function(){this.count--,0===this.count&&(this.state=!0)}});return d.map=function(b,d){var e={};d?e[b]=d:e=b,a.extend(c,a._clone(e))},d}},b[129]={value:function(){return b.r(0).create("Refresh",{provider:null,handler:null,count:0,base:b.r(1),prepareRefresh:function(){this.count++},refresh:function(a){a||this.count--,0===this.count&&this.handler&&this.handler.call(this.provider)},plug:function(a,b){this.provider=a,this.handler=b}})}},b[130]={value:function(){return b.r(0).create("Service",{base:b.r(1),commonPool:{},pool:{core:{},system:{},ext:{}},registerService:function(a,b,c,d){var e={},f=this.pool[a];"string"==typeof c?e[c]=d:e=c;for(var g in e)e.hasOwnProperty(g)&&(f[g]={provider:b,handler:e[g]})},rs:function(a,b,c){var d,e=[];switch(a){case"ext":e.push(this.pool.ext);case"system":e.push(this.pool.system);case"core":e.push(this.pool.core)}for(var f=0,g=e.length;g>f&&!(d=e[f][b]);f++);if(!d)throw new Error("service not found: "+b);return d.handler.apply(d.provider,c)},registerCommonService:function(a,b,c){var d={},e=this.commonPool;"string"==typeof b?d[b]=c:d=b;for(var f in d)d.hasOwnProperty(f)&&(e[f]={provider:a,handler:d[f]})},cs:function(a,b){var c=this.commonPool[a];if(!c)throw new Error("common service not found: "+a);return c.handler.apply(c.provider,b)}})}},b[131]={value:function(){var a={common:{},core:{},system:{},ext:{}},c=b.r(2),d=b.r(0).create("ModuleLoader",{context:null,instances:{common:[],core:[],system:[],ext:[]},instanceMap:{common:{},core:{},system:{},ext:{}},beforeListeners:[],afterListeners:[],constructor:function(a){this.context=a},getType:function(a){return a.____type},getModule:function(a,b){return this.instanceMap[a.____type][b]},createComponent:function(a,b){var c=b[0],d=new c(this.context);return b=b.slice(1),d.____type="string"!=typeof a?a.____type:a,d.init.apply(d,b),d},onBeforeLoad:function(a){this.beforeListeners.push(a)},start:function(){this.startupCommonModule(),this.startupModules("core"),this.startupModules("system"),this.startupModules("ext")},startupCommonModule:function(){var b=a.common,c=this.instances.common,d=null,e=this.context;for(var f in b)b.hasOwnProperty(f)&&(d=new b[f](e),d.init(),c.push(d))},startupModules:function(b){this.emitBefore(b);var c={},d=a[b],e=this.instances[b];for(var f in d)d.hasOwnProperty(f)&&this.initModule(c,d[f],b,f);for(var g=0,h=e.length;h>g;g++)e[g].run();this.emitAfter(b)},emitBefore:function(a){this.emit(this.beforeListeners,a)},emitAfter:function(a){this.emit(this.afterListeners,a)},emit:function(a,b){for(var c=0,d=a.length;d>c;c++)a[c].call(null,b)},initModule:function(b,c,d,e){if(!b[e]){var f,g=[],h=a[d];if(c.deps)for(var i=0,j=c.deps.length;j>i;i++)if(f=c.deps[i],b[f])g[i]=b[f];else{if(!h[f])throw new Error("notfound module: "+f);g[i]=this.initModule(b,h[f],d,f)}var k=new c(this.context);return k.____type=d,k.____loader=this,k.init.apply(k,g),b[e]=k,this.instances[d].push(k),this.instanceMap[d][e]=k,k}}});return c.extend(d,{register:function(b){c.extend(!0,a,b)},registerPlugin:function(b,c){a.ext[b]=c}}),d}},b[132]={value:function(){var a=b.r(0),c=b.r(139);return{wrap:function(b,d){return d.base=c,a.create("Plugin-"+b,d)}}}},b[133]={value:function(){return{"c.focus.change":"focuschange","c.range.disabled":"focusout","c.command.exec":"commandexecute","s.input.statechange":"inputmodelchange","c.refresh":"refresh","c.sheetschange":"sheetschange"}}},b[134]={value:function(){return b.r(0).create("Command",{base:b.r(135),queryValueBefore:function(){return[].slice.call(arguments,1)},execBefore:function(){return[].slice.call(arguments,1)},execute:function(){},queryValue:function(){}})}},b[135]={value:function(){return b.r(0).create("Component",{base:b.r(136),registerService:function(a,b){return this.____ctx.registerService(this,a,b)},execCommand:function(a){return this.____ctx.execCommand(this.____type,a,[].slice.call(arguments,1))},corePrepareRefresh:function(){this.____ctx.prepareRefresh()},coreRefresh:function(a){this.____ctx.refresh(a)},plug:function(a){this.____ctx.plug(this,a)},getModule:function(a){return this.____ctx.getModule(a)}})}},b[136]={value:function(){return b.r(0).create("Functional",{____ctx:null,____type:null,base:b.r(137),constructor:function(a){this.____ctx=a},getDocument:function(){return this.____ctx.getDocument()},getConfig:function(a){return this.____ctx.getConfig(a)},rs:function(a){var b=[].slice.call(arguments,1);return this.____ctx.rs(this,a,b)},cs:function(a){var b=[].slice.call(arguments,1);return this.____ctx.cs(a,b)},createElement:function(a,b){return this.____ctx.createElement(a,b)},postMessage:function(a){return this.____ctx.postMessage(this,a,[].slice.call(arguments,1))},onMessage:function(a,b){return this.____ctx.onMessage(this,a,b)},closeMessage:function(){return this.____ctx.closeMessage()},openMessage:function(){return this.____ctx.openMessage()},getMainContainer:function(){return this.____ctx.getContainer("main")},getTopContainer:function(){return this.____ctx.getContainer("top")},getLeftContainer:function(){return this.____ctx.getContainer("left")},getContentContainer:function(){return this.____ctx.getContainer("content")},resizeContianer:function(){return this.____ctx.resizeContianer()},getScrollContainer:function(){return this.____ctx.getContainer("scroll")},getTopSize:function(){return this.____ctx.getSize("top")},getLeftSize:function(){return this.____ctx.getSize("left")},getContentSize:function(){return this.____ctx.getSize("content")},getScrollSize:function(){return this.____ctx.getSize("scroll")}})}},b[137]={value:function(){return b.r(0).create("Lifecycle",{init:function(){},destroy:function(){}})}},b[138]={value:function(){return b.r(0).create("Module",{____loader:null,base:b.r(135),run:function(){},createComponent:function(){return this.____loader.createComponent(this,[].slice.call(arguments,0))}})}},b[139]={value:function(){return b.r(0).create("Plugin",{base:b.r(138),on:function(a,b){this.____ctx.on(this,a,b)}})}},b[140]={value:function(){return b.r(0).create("Component",{base:b.r(137),constructor:function(a){this.____ctx=a},init:function(){},registerCommonService:function(a,b){this.____ctx.registerCommonService(this,a,b)}})}},b[141]={value:function(){return b.r(0).create("UndoableCommand",{base:b.r(134),unexecute:function(){},getStackInfo:function(){},getRange:function(){return this.rs("c.range")},resetRange:function(a){this.rs("c.range.set",a)}})}},b[142]={value:function(){var a=b.r(146);return{"import":a.worksheets,importSheet:a.sheet,"export":b.r(143)}}},b[143]={value:function(){function a(a){a=JSON.parse(a);var b={cell:[],column:[],row:[],mergeCells:[],sheetView:{},styleSheet:{numFmts:[],fonts:[],fills:[],borders:[],alignments:[],cellStyleXfs:[],cellXfs:[]},dimension:{c:0,r:0}};return b.cell=c(a),b.styleSheet=d(a),b.sheetView=e(a),b.mergeCells=f(a),b.column=g(a),b.row=h(a),JSON.stringify(b)}function c(a){var b,c,d,e=[],f=a.value,g=a.cellStyle,h=a.cellType;for(var j in f)f.hasOwnProperty(j)&&(b=i.keyToIndex(j),c=b.row,d=b.col,e[c]||(e[c]=[]),e[c][d]||(e[c][d]={r:c,c:d}),e[c][d].v=f[j]);for(var j in g)g.hasOwnProperty(j)&&(b=i.keyToIndex(j),c=b.row,d=b.col,e[c]||(e[c]=[]),e[c][d]||(e[c][d]={r:c,c:d}),e[c][d].s=g[j]);for(var j in h)h.hasOwnProperty(j)&&(b=i.keyToIndex(j),c=b.row,d=b.col,e[c]||(e[c]=[]),e[c][d]||(e[c][d]={r:c,c:d}),e[c][d].t=h[j]);for(var k,l=[],m=0,n=e.length;n>m;m++){k=e[m];for(var o=0,p=k.length;p>o;o++)k[o]&&l.push(k[o])}return l}function d(a){var b={},c=a.styleIndex,d=a.xfList,e=a.styleGroup.fills,f=a.styleGroup.borders,g=[],h=[],i=[],j=[];b.numFmts=[],b.fonts=a.styleGroup.fonts,b.alignments=a.styleGroup.alignments;for(var k,l=0,m=c.length;m>l;l++)k=c[l],g.push({font:k.fonts,border:k.borders,fill:k.fills,align:k.alignments,xfId:k.xf,applyFont:k.applyFont,applyBorder:k.applyBorder,applyFill:k.applyFill,applyAlignment:k.applyAlignment});for(var l=0,m=d.length;m>l;l++)k=d[l],h.push({font:k.fonts,border:k.borders,fill:k.fills,align:k.alignments,applyFont:k.applyFont,applyBorder:k.applyBorder,applyFill:k.applyFill,applyAlignment:k.applyAlignment});for(var l=0,m=e.length;m>l;l++)k=e[l],i.push(k.fill);for(var l=0,m=f.length;m>l;l++)k=f[l],j.push(k.border);return b.fills=i,b.borders=j,b.cellXfs=g,b.cellStyleXfs=h,b}function e(a){return{pane:{r:a.pane.row,c:a.pane.col}}}function f(a){var b,c={},d=a.merge;for(var e in d)d.hasOwnProperty(e)&&(b=d[e],c.push({start:{r:b.start.row,c:b.start.col},end:{r:b.end.row,c:b.end.col}}));return c}function g(a){for(var b,c,d,e,f,g,h=[],i=a.columnStyle,j=a.column,k=Object.keys(i),m=Object.keys(j),n=Math.max(k[k.length-1]||0,m[m.length-1]||0),o=0;n>=o;)if(d=o,b=o,c=o,d=o,e=i[o],f=j[o],void 0!==e||void 0!==f){for(var p=o+1;n>=p&&(e===i[p]&&f===j[p]);p++)c=p;o=c+1,g={min:b,max:c},void 0!==e&&(g.s=e),void 0!==f&&(g.w=f),h.push(g)}else o++;var q=h[h.length-1];return-1!==a.allStyle&&q.max+1<l&&h.push({min:q.max+1,max:l,s:a.allStyle}),h}function h(a){for(var b,c,d,e=a.rowStyle,f=a.row,g=[],h=Object.keys(e),i=Object.keys(f),j=Math.max(h[h.length-1]||0,i[i.length-1]||0),k=0;j>=k;k++)c=e[k],d=f[k],(void 0!==c||void 0!==d)&&(b={r:k},void 0!==c&&(b.s=c),void 0!==d&&(b.h=d),g.push(b));return g}var i=b.r(150),j=b.r(116),k={},l=16383;for(var m in j)j.hasOwnProperty(m)&&"_default"!==m&&(k[j[m]]=m);return a}},b[144]={value:{horizontal:{none:"none",left:"left",right:"right",center:"center"},vertical:{none:"none",top:"top",middle:"middle",bottom:"bottom"}}},b[145]={value:function(){function a(a){"string"==typeof a&&(a=JSON.parse(a));var b={};return b.styleGroup=g(excelData),b.styleIndex=j(excelData),b.xfList=k(excelData),b.sheetNames=excelData.workbook.sheets,b.sheets=c(excelData.sheets),b}function c(a){for(var b,c,g,j,k,l,m,n=[],o=0,p=a.length;p>o;o++)b={},n[o]=b,c=a[o],m=c.dimension,b.dimension=m,b.total={row:100*Math.ceil(m.r/100)||100,col:26*Math.ceil(m.c/26)||26},g=d(c),j=e(c),k=f(c),l=i(c),b.value=g.value,b.cellType=g.type,b.cellStyle=g.cellStyle,b.arrayRef=g.arrayRef,b.comments=h(c.comment),b.pane=c.sheetView.pane?{row:c.sheetView.pane.r,col:c.sheetView.pane.c}:{row:-1,col:-1},b.row=j.height,b.rowStyle=j.style,b.allStyle=k.allStyle,b.column=k.width,b.columnStyle=k.style,b.merge=l.cells,b.mergeMap=l.map;return n}function d(a){for(var b,c,d=a.cell,e={},f={},g={},h=[],i=0,j=d.length;j>i;i++)b=d[i],c=l.indexToKey(b.r,b.c),"FORMULA"===b.t?(e[c]=b.f.v+"",f[c]=b.t+"","array"===b.f.t&&h.push({start:{row:b.f.ref.start.r,col:b.f.ref.start.c},end:{row:b.f.ref.end.r,col:b.f.ref.end.c}})):void 0!==b.v&&null!==b.v&&(e[c]=b.v+"",f[c]=b.t+""),void 0!==b.s&&(g[c]=+b.s);return{value:e,type:f,cellStyle:g,arrayRef:h}}function e(a){for(var b,c=a.row,d={},e={},f=0,g=c.length;g>f;f++)b=c[f],void 0!==b.h&&(d[b.r]=b.h),void 0!==b.s&&(e[b.r]=b.s);return{height:d,style:e}}function f(a){for(var b,c=a.column,d={},e={},f=-1,g=0,h=c.length;h>g;g++)if(b=c[g],b.max===n)f=b.s;else for(var i=b.min;i<=b.max;i++)void 0!==b.s&&(e[i]=b.s),void 0!==b.w&&(d[i]=b.w);return{allStyle:f,width:d,style:e}}function g(a){function b(){for(var a,b,c=[],d=h.fonts,e=q.fonts[0],f=0,g=d.length;g>f;f++){a={},b=d[f];for(var i in e)e.hasOwnProperty(i)&&(a[i]=b[i]||r[i]);c.push(a)}return c}function c(){for(var a,b,c=[],d=h.alignments,e=q.alignments[0],f=0,g=d.length;g>f;f++){a={},b=d[f];for(var i in e)if(e.hasOwnProperty(i))switch(i){case"horizontal":a[i]=t.horizontal[b[i]||r[i]];break;case"vertical":a[i]=t.vertical[b[i]||r[i]];break;case"wraptext":a[i]=+(b[i]||r[i])}c.push(a)}return c}function d(){for(var a,b=[],c=h.fills,d=0,e=c.length;e>d;d++)a=c[d],b.push({fill:a||r.fill});return b}function e(){for(var a,b,c=[],d=h.borders,e=q.borders[0].border,f=0,g=d.length;g>f;f++){a={},b=d[f];for(var i in e)e.hasOwnProperty(i)&&(a[i]=b[i]?b[i]===m?m:{style:o[b[i].style]||o.thin,color:b[i].color}:r.border[i]);c.push({border:a})}return c}function f(){var a,b=[],c=h.numFmts;for(var d in c)c.hasOwnProperty(d)&&(p[d]=b.length,a=c[d].code,"General"===a&&(a="none"),b.push({numberFormat:a}));return b}var g={},h=a.styleSheet;return g.fonts=b(),g.alignments=c(),g.fills=d(),g.borders=e(),g.numberFormats=f(),g}function h(a){for(var b,c={},d=0,e=a.length;e>d;d++)b=a[d],c[l.indexToKey(b.r,b.c)]=b.text;return c}function i(a){for(var b,c,d,e,f=a.mergeCells,g={},h={},i=0,j=f.length;j>i;i++){b=f[i],e=l.indexToKey(b.start.r,b.start.c),c=b.start,d=b.end,h[e]={start:{row:c.r,col:c.c},end:{row:d.r,col:d.c}};for(var k=c.r,m=d.r;m>=k;k++)for(var n=c.c,o=d.c;o>=n;n++)g[[l.indexToKey(k,n)]]=e}return{cells:h,map:g}}function j(a){for(var b=[],c=a.styleSheet.cellXfs,d=0,e=c.length;e>d;d++){var f=c[d];b.push({fonts:f.font?+f.font:0,borders:f.border?+f.border:0,fills:f.fill?+f.fill:0,alignments:f.align?+f.align:0,numberFormats:f.numberFormat?p[f.numberFormat]:0,xf:f.xfId?+f.xfId:0,applyFont:0===f.applyFont?0:1,applyBorder:0===f.applyBorder?0:1,applyFill:0===f.applyFill?0:1,applyAlignment:0===f.applyAlignment?0:1,applyNumberFormat:0===f.applyNumberFormat?0:1})}return b}function k(a){for(var b=[],c=a.styleSheet.cellStyleXfs,d=0,e=c.length;e>d;d++){var f=c[d];b.push({fonts:f.font?+f.font:0,borders:f.border?+f.border:0,fills:f.fill?+f.fill:0,alignments:f.align?+f.align:0,numberFormats:f.numberFormat?p[f.numberFormat]:0,applyFont:f.applyFont?1:0,applyBorder:f.applyBorder?1:0,applyFill:f.applyFill?1:0,applyAlignment:f.applyAlignment?1:0,applyNumberFormat:0===f.applyNumberFormat?0:1})}return b}var l=b.r(150),m="none",n=16383,o={thin:"thin",dashed:"dashed",dotted:"dotted"},p={},q=b.r(182).styleGroup,r=b.r(149),s=b.r(116),t=b.r(144),u={};for(var v in s)s.hasOwnProperty(v)&&"_default"!==v&&(u[s[v]]=v);return a}},b[146]={value:function(){function a(a){"string"==typeof a&&(a=JSON.parse(a));var b={};return r={},b.styleGroup=i(a),b.styleIndex=l(a),b.xfList=m(a),b.sheetNames=a.workbook.sheets,b.sheets=d(a.sheets),b}function c(a){return"string"==typeof a&&(a=JSON.parse(a)),e(a)}function d(a){for(var b=[],c=0,d=a.length;d>c;c++)b[c]=e(a[c]);return b}function e(a){var b={},c=a.dimension;b.dimension=c,b.total={row:100*Math.ceil(c.r/100)||100,col:26*Math.ceil(c.c/26)||26};var d=f(a),e=g(a),i=h(a),l=k(a);return b.value=d.value,b.cellType=d.type,b.cellStyle=d.cellStyle,b.arrayRef=d.arrayRef,b.comments=j(a.comment),b.pane=a.sheetView.pane?{row:a.sheetView.pane.r,col:a.sheetView.pane.c}:{row:-1,col:-1},b.row=e.height,b.rowStyle=e.style,b.allStyle=i.allStyle,b.column=i.width,b.columnStyle=i.style,b.merge=l.cells,b.mergeMap=l.map,b}function f(a){for(var b,c,d=a.cell,e={},f={},g={},h=[],i=0,j=d.length;j>i;i++)b=d[i],c=n.indexToKey(b.r,b.c),"FORMULA"===b.t?(e[c]=b.f.v+"",f[c]=b.t+"","array"===b.f.t&&h.push({start:{row:b.f.ref.start.r,col:b.f.ref.start.c},end:{row:b.f.ref.end.r,col:b.f.ref.end.c}})):void 0!==b.v&&null!==b.v&&(e[c]=b.v+"",f[c]=b.t+""),void 0!==b.s&&(g[c]=+b.s);return{value:e,type:f,cellStyle:g,arrayRef:h}}function g(a){for(var b,c=a.row,d={},e={},f=0,g=c.length;g>f;f++)b=c[f],void 0!==b.h&&(d[b.r]=b.h),void 0!==b.s&&(e[b.r]=b.s);return{height:d,style:e}}function h(a){for(var b,c=a.column,d={},e={},f=-1,g=0,h=c.length;h>g;g++)if(b=c[g],b.max===p)f=b.s;else for(var i=b.min;i<=b.max;i++)void 0!==b.s&&(e[i]=b.s),void 0!==b.w&&(d[i]=b.w);return{allStyle:f,width:d,style:e}}function i(a){function b(){for(var a,b,c=[],d=h.fonts,e=s.fonts[0],f=0,g=d.length;g>f;f++){a={},b=d[f];for(var i in e)e.hasOwnProperty(i)&&(a[i]=b[i]||t[i]);c.push(a)}return c}function c(){for(var a,b,c=[],d=h.alignments,e=s.alignments[0],f=0,g=d.length;g>f;f++){a={},b=d[f];for(var i in e)if(e.hasOwnProperty(i))switch(i){case"horizontal":a[i]=v.horizontal[b[i]||t[i]];break;case"vertical":a[i]=v.vertical[b[i]||t[i]];break;case"wraptext":a[i]=+(b[i]||t[i])}c.push(a)}return c}function d(){for(var a,b=[],c=h.fills,d=0,e=c.length;e>d;d++)a=c[d],b.push({fill:a||t.fill});return b}function e(){for(var a,b,c=[],d=h.borders,e=s.borders[0].border,f=0,g=d.length;g>f;f++){a={},b=d[f];for(var i in e)e.hasOwnProperty(i)&&(a[i]=b[i]?b[i]===o?o:{style:q[b[i].style]||q.thin,color:b[i].color}:t.border[i]);c.push({border:a})}return c}function f(){var a,b=[],c=h.numFmts;for(var d in c)c.hasOwnProperty(d)&&(r[d]=b.length,a=c[d].code,"General"===a&&(a="none"),b.push({numberFormat:a}));return b}var g={},h=a.styleSheet;return g.fonts=b(),g.alignments=c(),g.fills=d(),g.borders=e(),g.numberFormats=f(),g}function j(a){for(var b,c={},d=0,e=a.length;e>d;d++)b=a[d],c[n.indexToKey(b.r,b.c)]=b.text;return c}function k(a){for(var b,c,d,e,f=a.mergeCells,g={},h={},i=0,j=f.length;j>i;i++){b=f[i],e=n.indexToKey(b.start.r,b.start.c),c=b.start,d=b.end,h[e]={start:{row:c.r,col:c.c},end:{row:d.r,col:d.c}};for(var k=c.r,l=d.r;l>=k;k++)for(var m=c.c,o=d.c;o>=m;m++)g[[n.indexToKey(k,m)]]=e}return{cells:h,map:g}}function l(a){for(var b=[],c=a.styleSheet.cellXfs,d=0,e=c.length;e>d;d++){var f=c[d];b.push({fonts:f.font?+f.font:0,borders:f.border?+f.border:0,fills:f.fill?+f.fill:0,alignments:f.align?+f.align:0,numberFormats:f.numberFormat?r[f.numberFormat]:0,xf:f.xfId?+f.xfId:0,applyFont:0===f.applyFont?0:1,applyBorder:0===f.applyBorder?0:1,applyFill:0===f.applyFill?0:1,applyAlignment:0===f.applyAlignment?0:1,applyNumberFormat:0===f.applyNumberFormat?0:1})}return b}function m(a){for(var b=[],c=a.styleSheet.cellStyleXfs,d=0,e=c.length;e>d;d++){var f=c[d];b.push({fonts:f.font?+f.font:0,borders:f.border?+f.border:0,fills:f.fill?+f.fill:0,alignments:f.align?+f.align:0,numberFormats:f.numberFormat?r[f.numberFormat]:0,applyFont:f.applyFont?1:0,applyBorder:f.applyBorder?1:0,applyFill:f.applyFill?1:0,applyAlignment:f.applyAlignment?1:0,applyNumberFormat:0===f.applyNumberFormat?0:1})}return b}var n=b.r(150),o="none",p=16383,q={thin:"thin",dashed:"dashed",dotted:"dotted"},r={},s=b.r(182).styleGroup,t=b.r(149),u=b.r(116),v=b.r(144),w={};for(var x in u)u.hasOwnProperty(x)&&"_default"!==x&&(w[u[x]]=x);return{worksheets:a,sheet:c}}},b[147]={value:function(){return["top","right","bottom","left"]}},b[148]={value:function(){var a={active:0,sheetNames:["\u6d4b\u8bd5\u6587\u4ef61"],readonly:!1,sheets:[{total:{row:100,col:26},row:{},column:{},value:{},arrayRef:[],formulaRef:[],columnStyle:{},rowStyle:{},cellStyle:[],name:{},mergeMap:{},merge:{},cellType:{},comments:[],pane:{row:-1,col:-1},dimension:{row:-1,col:-1},contentDimensionRes:{row:-1,col:-1},styleDimensionRes:{row:-1,col:-1},contentDimension:{row:[],col:[]},styleDimension:{row:[],col:[]},allStyle:-1}]};return $.extend(a,b.r(182)),a}},b[149]={value:function(){var a=b.r(118);return{color:a,name:a,bold:!1,italic:!1,underline:!1,throughline:!1,size:a,fill:a,border:{top:a,left:a,right:a,bottom:a},wraptext:!1,horizontal:a,vertical:a,numberFormula:a}}},b[150]={value:function(){var a=b.r(178).MAX_COLUMN_COUNT;return{indexToKey:function(b,c){return b*a+ +c},indexToKeys:function(b,c){for(var d,e=b.row,f=b.col,g=c.row,h=c.col,i=[],j=e,k=g;k>=j;j++){d=j*a+ +f;for(var l=f,m=h;m>=l;l++,d++)i.push(d)}return i},keyToIndex:function(b){return{row:Math.floor(b/a),col:b%a}}}}},b[151]={value:function(){var a=(b.r(150),b.r(152));return{exchangeRow:function(b,c,d){a.exchangeRow(b,c,d)}}}},b[152]={value:function(){function a(a,b,e){for(var f,g,h=e.start.row,i=e.start.col,j=e.end.col;j>=i;i++){f=[],g=[];for(var k=0,l=b.length;l>k;k++)f.push(d.indexToKey(b[k],i)),g.push(d.indexToKey(h+k,i));c(a,f,g)}}function c(a,b,c){for(var d,e,f={},g=0,h=b.length;h>g;g++)d=b[g],e=c[g],d!==e&&(f[e]=a[e],e>d?a[e]=f[d]:(a[e]=a[d],a[d]=void 0))}var d=b.r(150);return{exchangeRow:a}}},b[153]={value:function(){return $.extend({bind:function(a){this.data=a},execCommand:function(){var a=[].slice.call(arguments);this.interpreter.exec(this.data,a)}},b.r(162))}},b[154]={value:function(){function a(){}return $.extend(a,$.extend({exec:function(a,b){"clearcontent"===a?this.kernelClearValue(b):this.kernelClearStyle(b)}},b.r(153))),a}},b[155]={value:function(){function a(){}return $.extend(a,$.extend({exec:function(a,b){return"export"===a?this.kernelExport(b):this.kernelExportExcel()}},b.r(153))),a}},b[156]={value:function(){function a(){}return $.extend(a,$.extend({exec:function(a,b,c,d,e){"paste"===a?this.paste(b,c,d):this.cut(b,c,d,e)},paste:function(a,b,c){this.batchWriteCell(a,c.row,c.col),b&&this.kernelBatchSetStyle(b,c.row,c.col)},cut:function(a,b,c,d){this.execCommand("clearcontent",[d]),this.execCommand("clearformat",[d]),this.paste(a,b,c)},batchWriteCell:function(a,b,c){for(var d,e=0,f=a.length;f>e;e++){d=a[e];for(var g=0,h=d.length;h>g;g++)this.execCommand("write",d[g],b+e,c+g)}}},b.r(153))),a}},b[157]={value:function(){function a(){}return $.extend(a,$.extend({exec:function(a,b,c){"resizerow"===a?this.kernelSetRowHeight(b,c):this.kernelSetColumnWidth(b,c)}},b.r(153))),a}},b[158]={value:function(){function a(){}return $.extend(a,$.extend({exec:function(a){this[a].apply(this,[].slice.call(arguments,1))},color:function(a,b,c){this.kernelSetStyle("color",a,b,c)},fontsize:function(a,b,c){this.kernelSetStyle("fontSize",a,b,c)},font:function(a,b,c){this.kernelSetStyle("fontFamily",a,b,c)},italic:function(a,b){"italic"===this.kernelGetStyle(a.row,a.col).fontStyle?this.kernelSetStyle("fontStyle",void 0,a,b):this.kernelSetStyle("fontStyle","italic",a,b)},bold:function(a,b){"bold"===this.kernelGetStyle(a.row,a.col).fontWeight?this.kernelSetStyle("fontWeight",void 0,a,b):this.kernelSetStyle("fontWeight","bold",a,b)},fill:function(a,b,c){this.kernelSetStyle("backgroundColor",a,b,c)},horizontal:function(a,b,c){this.kernelSetStyle("textAlign",a,b,c)},vertical:function(a,b,c){this.kernelSetStyle("verticalAlign",a,b,c)}},b.r(153))),a}},b[159]={value:function(){function a(){}return $.extend(a,$.extend({exec:function(a,b,c,d){this.kernelSetValue(b,c,d)}},b.r(153))),a}},b[160]={value:function(){function a(){}var c=b.r(161);return $.extend(a.prototype,{exec:function(a,b){var d=b[0],e=c[d];return e?(e.bind(a),e.interpreter=this,e.exec.apply(e,b)):void 0},createSheet:function(){return $.clone(b.r(148),!0)}}),a}},b[161]={value:function(){var a=b.r(158),c=b.r(157),d=b.r(154),e=b.r(159),f=b.r(155),g=b.r(156);return{write:e,clearcontent:d,clearformat:d,color:a,bold:a,font:a,fontsize:a,italic:a,vertical:a,horizontal:a,resizecol:c,resizerow:c,fill:a,"export":f,exportexcel:f,paste:g,cut:g}}},b[162]={value:function(){var a=b.r(148),c=b.r(150);return $.extend({kernelCreateWorkbook:function(){return $._clone(a)},kernelCreateSheet:function(){return $._clone(a.sheets[0])},kernelGetValue:function(a,b){return this.kernelGetActiveData().value[c.indexToKey(a,b)]},kernelGetRowHeight:function(a){return this.kernelGetActiveData().row[a]},kernelGetColumnWidth:function(a){return this.kernelGetActiveData().column[a]},kernelGetTotal:function(){return this.kernelGetActiveData().total},kernelGetTotalIndex:function(){var a=this.kernelGetActiveData().total;return{row:a.row-1,col:a.col-1}},kernelGetDefaultStyle:function(a){return $._clone(this.data.defaultStyle[a])},kernelGetCellType:function(a,b){return this.kernelGetActiveData().cellType[this.indexToKey(a,b)]},kernelClearValue:function(a){function b(a,b){var g,h=f.row*f.col,i=(b.row-a.row+1)*(b.col-a.col+1);if(h===i)return d.value={},!0;for(var j=a.row,k=b.row;k>=j;j++)for(var l=a.col,m=b.col;m>=l;l++)g=c.indexToKey(j,l),e[g]&&(e[g]=void 0);return!1}for(var d=this.kernelGetActiveData(),e=d.value,f=d.total,g=0,h=a.length;h>g&&!b(a[g].start,a[g].end);g++);},kernelSetValue:function(a,b,d){var e=this.kernelGetActiveData().value,f=c.indexToKey(b,d);a?e[f]=a:e[f]&&(e[f]=void 0)},kernelBatchSetValue:function(a,b,d){for(var e,f,g,h=this.kernelGetActiveData().value,i=0,j=a.length;j>i;i++){f=a[i];for(var k=0,l=f.length;l>k;k++)e=c.indexToKey(b+i,d+k),g=f[k]||void 0,h[e]=g}},kernelSetCellType:function(a,b,c){a?this.kernelGetActiveData().cellType[this.indexToKey(b,c)]=a:this.kernelClearCellType(b,c)},kernelClearCellType:function(a,b){this.kernelGetActiveData().cellType[this.indexToKey(a,b)]=void 0},kernelSetColumnWidth:function(a,b){var c=this.kernelGetActiveData();c.column[b]=void 0===a||null===a?void 0:a>=0?a:0},kernelSetRowHeight:function(a,b){var c=this.kernelGetActiveData();c.row[b]=void 0===a||null===a?void 0:a>=0?a:0},kernelExchangeRow:function(){},__kernelGetRangeType:function(a,b){var c=this.kernelGetTotalIndex(),d=0===a.row&&b.row>=c.row,e=0===a.col&&b.col>=c.col;return e&&d?"ALL":e?"ROW":d?"COLUMN":"RANGE"}},b.r(150),b.r(176),b.r(172),b.r(168),b.r(174),b.r(173),b.r(177),b.r(171),b.r(163),b.r(169),b.r(170),b.r(174),b.r(163),b.r(167),b.r(164),b.r(166),b.r(165))}},b[163]={value:function(){var a=b.r(175),c=b.r(118);return{kernelGetBorder:function(a,b){var c=this.kernelGetActiveData(),d=this.data,e=c.cellStyle,f=c.rowStyle,g=c.columnStyle,h=d.styleIndex,i=e[a][b];return void 0!==i&&1===h[i].applyBorder?h[i].borders:(i=f[a],void 0!==i&&1===h[i].applyBorder?h[i].borders:(i=g[b],void 0!==i&&1===h[i].applyBorder?h[i].borders:void 0))},kernelGetBorders:function(a,b){for(var c,d=a.row,e=a.col,f=b.row,g=b.col,h=[],i=d;f>=i;i++){c=[];for(var j=e;g>=j;j++)c.push(this.kernelGetBorder(i,j));h.push(c)}return h},kernelSetBorder:function(a,b,d){a||(a={top:c,left:c,right:c,bottom:c});var e=this.__kernelGetRangeType(b,d);switch(e){case"ALL":this.__kernelSetAllBorder(a);break;case"ROW":this.__kernelSetRowBorder(a,b.row,d.row);break;case"COLUMN":this.__kernelSetColumnBorder(a,b.col,d.col);break;case"RANGE":this.__kernelSetRangeBorder(a,b,d)}},__kernelGetBorderByIndex:function(a){return this.styleGroup.borders[a].border},__kernelSetAllBorder:function(a){var b=this.kernelGetTotalIndex();this.__kernelSetColumnBorder(a,0,b.col)},__kernelUnsetBorder:function(b,c){for(var d,e,f=this.kernelGetActiveData().cellStyle,g=b.row,h=b.col,i=c.row,j=c.col,k=g;i>=k;k++)for(var l=h;j>=l;l++)d=this.__getStyleIndex(k,l)||0,e=a.unsetStyleClassify(this.data,"borders",d),f[k][l]=e},__kernelSetRowBorder:function(b,d,e,f){for(var g,h=this.kernelGetActiveData().rowStyle,i=d;e>=i;i++)g=h[i]||0,h[i]=a.generateBorder(this.data,g,b);this.__patchRowCellBorder(b,d,e),this.__overlayColumnBorder(b,d,e),f!==!1&&(d-=1,d>=0&&this.__clearRowBorder({bottom:c},d),e+=1,this.__clearRowBorder({top:c},e))},__kernelSetColumnBorder:function(b,d,e,f){for(var g,h=this.kernelGetActiveData().columnStyle,i=d;e>=i;i++)g=h[i]||0,h[i]=a.generateBorder(this.data,g,b);this.__patchColumnCellBorder(b,d,e),this.__overlayRowBorder(b,d,e),f!==!1&&(d-=1,d>=0&&this.__clearColumnBorder({right:c},d),e+=1,this.__clearColumnBorder({left:c},e))},__kernelSetRangeBorder:function(b,d,e,f){for(var g,h=d.row,i=d.col,j=e.row,k=e.col,l=this.kernelGetActiveData().cellStyle,m=h;j>=m;m++)for(var n=i;k>=n;n++)g=this.__getStyleIndex(m,n)||0,l[m][n]=a.generateBorder(this.data,g,b);f!==!1&&(h>0&&this.__kernelSetRangeBorder({bottom:c},{row:h-1,col:i},{row:h-1,col:k},!1),this.__kernelSetRangeBorder({top:c},{row:j+1,col:i},{row:j+1,col:k},!1),i>0&&this.__kernelSetRangeBorder({right:c},{row:h,col:i-1},{row:j,col:i-1},!1),this.__kernelSetRangeBorder({left:c},{row:h,col:k+1},{row:j,col:k+1},!1))},__clearRowBorder:function(a,b){var c=this.kernelGetActiveData().rowStyle[b],d=this.data.styleIndex,e=d[c];e&&1===e.applyBorder?this.__kernelSetRowBorder(a,b,b,!1):(this.__patchRowCellBorder(a,b,b),this.__overlayColumnBorder(a,b,b))},__clearColumnBorder:function(a,b){var c=this.kernelGetActiveData().columnStyle[b],d=this.data.styleIndex,e=d[c];e&&1===e.applyBorder?this.__kernelSetColumnBorder(a,b,b,!1):(this.__patchColumnCellBorder(a,b,b),this.__overlayRowBorder(a,b,b))},__patchRowCellBorder:function(b,c,d){for(var e,f,g,h=this.kernelGetActiveData(),i=h.cellStyle,j=h.rowStyle,k=c;d>=k;k++){e=i[k];
for(var l=0,m=e.length;m>l;l++)f=e[l],void 0!==f&&(g=a.generateBorder(this.data,f,b),e[l]=j[k]===g?void 0:g)}},__patchColumnCellBorder:function(b,c,d){for(var e,f,g,h,i=this.kernelGetActiveData(),j=i.cellStyle,k=i.rowStyle,l=0,m=j.length;m>l;l++){e=j[l],g=0;for(var n=c;d>=n;n++,g++)f=e[n],f&&(h=a.generateBorder(this.data,f,b),e[n]=k[l]===h?void 0:h)}},__overlayColumnBorder:function(b,c,d){for(var e,f=this.kernelGetActiveData(),g=f.columnStyle,h=f.cellStyle,i=f.rowStyle,j=c;d>=j;j++)for(var k=0,l=g.length;l>k;k++)g[k]&&!h[j][k]&&(e=a.mergeBorder(this.data,g[k],i[j],b),h[j][k]=i[j]===e?void 0:e)},__overlayRowBorder:function(b,c,d){for(var e,f,g,h,i=this.kernelGetActiveData(),j=i.rowStyle,k=i.cellStyle,l=i.columnStyle,m=0,n=j.length;n>m;m++)if(e=j[m]){g=0;for(var o=c;d>=o;o++,g++)f=k[m][o],l[o]&&!f&&(h=a.mergeBorder(this.data,l[o],e,b),k[m][o]=e===h?void 0:h)}}}}},b[164]={value:function(){return{kernelGetComments:function(a,b){var c=this.kernelGetActiveData().comments[a];return c&&c[b]?c[b]:void 0},kernelSetComments:function(a,b,c){var d=this.kernelGetActiveData().comments;d[a]||(d[a]=[]),d[a][b]=c},kernelClearComments:function(a,b){var c=this.kernelGetActiveData().comments[a];c&&c[b]&&(c[b]=void 0)}}}},b[165]={value:function(){function a(a){var c=a.contentDimension,d=a.contentDimensionRes,e=a.styleDimensionRes;d.row=b(c.row),d.col=b(c.col),a.dimension={row:Math.max(d.row,e.row),col:Math.max(d.col,e.col)}}function b(a){for(var b=-1,c=a.length-1;c>=0;c++)if(void 0!==a[c])return a[c];return b}return{kernelClearContentDimension:function(b,c){for(var d,e,f,g=this.kernelGetActiveData(),h=g.value,i=g.contentDimension,j=i.row,k=i.col,l=b.row,m=c.row;m>=l;l++)if(d=j[l]){f=0,e=this.indexToKey(l,d);for(var n=d;n>=0;n--,e--)if(h[e]){f=n;break}j[l]=f}for(var l=b.col,o=c.col;o>=l;l++)if(d=k[l]){f=0;for(var n=d;n>=0;n--)if(e=this.indexToKey(n,l),h[e]){f=n;break}k[l]=f}a(g)},kernelAddContentDimension:function(a,b){for(var c=this.kernelGetActiveData(),d=c.contentDimension,e=c.contentDimensionRes,f=d.row,g=d.col,h=b.row,i=b.col,j=a.row,k=b.row;k>=j;j++)f[j]=f[j]?Math.max(f[j],i):i;for(var j=a.col,l=b.col;l>=j;j++)g[j]=g[j]?Math.max(g[j],h):h;e.row=Math.max(e.row,h),e.col=Math.max(e.col,i);var m=c.dimension;m.row=Math.max(m.row,e.row),m.col=Math.max(m.col,e.col)},kernelExpandCol:function(a){var b=this.kernelGetActiveData().total;b.col+=a}}}},b[166]={value:function(){return{kernelExpandRow:function(a){for(var b=this.kernelGetActiveData(),c=b.total,d=b.cellStyle,e=0,f=c.row;a>e;e++,f++)d[f]=[];c.row+=a},kernelExpandCol:function(a){var b=this.kernelGetActiveData().total;b.col+=a}}}},b[167]={value:function(){return{kernelGetArrayReference:function(a,b){var c=this.kernelGetActiveData(),d=c.formulaRef;if(!d[a]||void 0===d[a][b])return void 0;var e=d[a][b];return c.arrayRef[e]},kernelSetArrayReference:function(a,b){var c=this.kernelGetActiveData(),d=c.formulaRef,e=c.arrayRef,f=e.length;e.push({start:{row:a.row,col:a.col},end:{row:b.row,col:b.col}});for(var g=a.row,h=b.row;h>=g;g++)for(var i=a.col,j=b.col;j>=i;i++)d[g]||(d[g]=[]),d[g][i]=f},kernelClearArrayReference:function(a,b){var c=this.kernelGetActiveData(),d=c.formulaRef;if(d[a]&&void 0!==d[a][b]){for(var e=c.arrayRef,f=d[a][b],g=e[f],h=g.start,i=g.end,j=h.row,k=i.row;k>=j;j++)for(var l=h.col,m=i.col;m>=l;l++)d[j][l]=void 0;e[f]=void 0}}}}},b[168]={value:function(){function a(a){for(var b=[],c=0,d=a.length;d>c;c++)a[c]&&b.push(a[c]);return b}function c(a){for(var b,c,d={},e=0,f=a.length;f>e;e++){b=a[e];for(var g=0,h=b.length;h>g;g++)c=b[g],void 0!==c&&(d[k.indexToKey(e,g)]=c)}return d}function d(a){for(var b,c,d={},e=0,f=a.length;f>e;e++)if(b=a[e])for(var g=0,h=b.length;h>g;g++)c=b[g],void 0!==c&&(d[k.indexToKey(e,g)]=c);return d}function e(a){var b,c=[];for(var d in a)a.hasOwnProperty(d)&&(b=k.keyToIndex(d),c[b.row]||(c[b.row]=[]),c[b.row][b.col]=a[d]);return c}function f(a){for(var b,c=0,d=a.sheets.length;d>c;c++)b=a.sheets[c],b.cellStyle=g(b)}function g(a){for(var b,c=a.cellStyle,d=[],e=0,f=a.total.row;f>e;e++)d[e]=[];for(var g in c)c.hasOwnProperty(g)&&(b=k.keyToIndex(g),d[b.row][b.col]=c[g]);return d}function h(a){function b(a){for(var b,c,d=a.arrayRef,e=[],f=[],g=0,h=d.length;h>g;g++)if(b=d[g]){c=f.length,f.push(b);for(var i=b.start.row,j=b.end.row;j>=i;i++)for(var k=b.start.col,l=b.end.col;l>=k;k++)e[i]||(e[i]=[]),e[i][k]=c}a.formulaRef=e,a.arrayRef=f}for(var c=a.sheets,d=0,e=c.length;e>d;d++)b(c[d])}function i(a){for(var b=a.sheets,c=0,d=b.length;d>c;c++)b[c].comments=e(b[c].comments)}function j(a){var b={},c=a.defaultStyle,d=a.styleGroup;for(var e in d)d.hasOwnProperty(e)&&(b[e]=$._extend($._clone(c[e]),d[e][0]));return b}var k=b.r(150);return{kernelExportWorkbook:function(){for(var b,e=this.data,f={active:e.active,sheetNames:e.sheetNames,sheets:[],xfList:e.xfList,styleGroup:e.styleGroup,styleIndex:e.styleIndex},g=e.sheets,h=f.sheets,i=0,j=g.length;j>i;i++)b=g[i],h[i]={total:b.total,row:b.row,column:b.column,value:b.value,arrayRef:a(b.arrayRef),comments:d(b.comments),cellType:b.cellType,cellStyle:c(b.cellStyle),rowStyle:b.rowStyle,columnStyle:b.columnStyle,allStyle:b.allStyle,merge:b.merge,pane:b.pane,dimension:b.dimension};return JSON.stringify(f)},kernelImportWorkbook:function(a){a=$.extend(!0,this.kernelCreateWorkbook(),$._clone(a));var b,c=a.styleGroup,d=a.styleGroupMap;for(var e in c)b=c[e][0],d[e]={},d[e][JSON.stringify(b)]=0;return a.styleIndexMap[JSON.stringify(a.styleIndex[0])]=0,a.borderMap[JSON.stringify(a.styleGroup.borders[0].border)]=0,a.defaultStyle=j(a),h(a),f(a),i(a),a},kernelImportSheet:function(a){return a=$.extend(!0,this.kernelCreateSheet(),$._clone(a)),a.cellStyle=g(a),a}}}},b[169]={value:function(){function a(a){var b=a[0];if(void 0===b)return!0;for(var c=1,d=a.length;d>=c;c++)if(b!==a[c])return!0;return!1}var c=b.r(150),d="none";return{kernelSetMerge:function(a){var b,d=this.kernelGetActiveData(),e=d.mergeMap,f=a.start,g=a.end;if(f.row===g.row&&f.col===g.col)return!1;this.kernelUnmerge(a),b=c.indexToKey(f.row,f.col),d.merge[b]=$._clone(a);for(var h=f.row,i=g.row;i>=h;h++)for(var j=f.col,k=g.col;k>=j;j++)e[[c.indexToKey(h,j)]]=b;var l,m=this.__kernelGetMergeCellBorder(f,g);return null===m&&this.__kernelUnsetBorder(f,f),l=this.__getStyleIndex(f.row,f.col),this.__kernelSetStyleIndex(l,f,g),null!==m&&this.kernelSetBorder(m,f,g),!0},kernelSetHorizontalMerge:function(a){for(var b=a.start.row,c=a.start.col,d=a.end.row,e=a.end.col,f=b,g=d;g>=f;f++)this.kernelSetMerge({start:{row:f,col:c},end:{row:f,col:e}})},kernelSetVerticalMerge:function(a){for(var b=a.start.row,c=a.start.col,d=a.end.row,e=a.end.col,f=c,g=e;g>=f;f++)this.kernelSetMerge({start:{row:b,col:f},end:{row:d,col:f}})},kernelGetMergeCell:function(a,b){var d=this.kernelGetActiveData();if(void 0===a)return d.merge;var e=d.mergeMap[c.indexToKey(a,b)];return void 0===e?null:d.merge[e]},kernelIsMergeCell:function(a,b){return void 0!==this.kernelGetActiveData().mergeMap[c.indexToKey(a,b)]},kernelHasMergeCellInRange:function(a){for(var b=this.kernelGetActiveData().mergeMap,d=a.start,e=a.end,f=d.row,g=e.row;g>=f;f++)for(var h=d.col,i=e.col;i>=h;h++)if(b[c.indexToKey(f,h)])return!0;return!1},kernelGetMergeCellsInRange:function(a){for(var b,d=this.kernelGetActiveData(),e=d.merge,f={},g=[],h=a.start,i=a.end,j=h.row,k=i.row;k>=j;j++)for(var l=h.col,m=i.col;m>=l;l++)b=d.mergeMap[c.indexToKey(j,l)],void 0!==b&&(f[b]=!0);for(var n in f)f.hasOwnProperty(n)&&g.push(e[n]);return $._clone(g)},kernelIsSameMergeCell:function(a){var b,d,e=this.kernelGetActiveData(),f=e.mergeMap;if(d=f[c.indexToKey(a[0].row,a[0].col)],void 0===d)return!1;for(var g=1,h=a.length;h>g;g++)if(b=f[c.indexToKey(a[g].row,a[g].col)],b!==d)return!1;return!0},kernelUnmerge:function(a){for(var b,d,e=this.kernelGetActiveData(),f=e.mergeMap,g=a.start,h=a.end,i=g.row,j=h.row;j>=i;i++)for(var k=g.col,l=h.col;l>=k;k++)b=c.indexToKey(i,k),d=f[b],d&&this.__kernelUnmergeCell(d)},__kernelUnmergeCell:function(a){var b=this.kernelGetActiveData(),d=b.mergeMap,e=b.merge[a],f=e.start,g=e.end;b.merge[a]=void 0;for(var h=f.row,i=g.row;i>=h;h++)for(var j=f.col,k=g.col;k>=j;j++)d[c.indexToKey(h,j)]=void 0},__kernelGetMergeCellBorder:function(b,c){var e,f,g,h,i,j={},k=b.row,l=c.row,m=b.col,n=c.col;return e=this.kernelGetBorders({row:k,col:m},{row:k,col:n})[0],h=b.row===c.row?e:this.kernelGetBorders({row:l,col:m},{row:l,col:n})[0],f=this.kernelGetBorders({row:k,col:m},{row:l,col:m})[0],g=b.col===c.col?f:this.kernelGetBorders({row:k,col:n},{row:l,col:n})[0],i=a(e),j.top=i?d:this.__kernelGetBorderByIndex(e[0]).top,i=a(f),j.left=i?d:this.__kernelGetBorderByIndex(f[0]).left,i=a(g),j.right=i?d:this.__kernelGetBorderByIndex(g[0]).right,i=a(h),j.bottom=i?d:this.__kernelGetBorderByIndex(h[0]).bottom,j.top===d&&j.bottom===d&&j.left===d&&j.right===d?null:j}}}},b[170]={value:function(){var a=b.r(118);return{kernelGetNumberFormat:function(b,c){var d=this.kernelGetStyle("numberFormats",b,c);return d&&d.numberFormat!==a?d.numberFormat:void 0},kernelSetNumberFormat:function(a,b,c){this.kernelSetStyle("numberFormat",a,b,c)},kernelClearNumberFormat:function(b,c){this.kernelSetStyle("numberFormat",a,b,c)}}}},b[171]={value:function(){return{kernelSetPane:function(a,b){this.kernelGetActiveData().pane={row:a,col:b}},kernelGetPane:function(){return this.kernelGetActiveData().pane},kernelClearPane:function(){this.kernelGetActiveData().pane={row:-1,col:-1}}}}},b[172]={value:function(){return{kernelGetSheetName:function(){var a=this.data.active;return this.data.sheetNames[a]},kernelGetSheetNames:function(){return this.data.sheetNames},kernelGetSheetIndex:function(){return this.data.active},kernelSwitchSheet:function(a){this.data.active=parseInt(a,10)},kernelAddSheetName:function(a){var b=this.data.sheetNames.length;return a=a||"Sheet"+(b+1),this.data.sheetNames.push(a),b},kernelInertSheet:function(a,b){this.data.sheets[a]=b}}}},b[173]={value:function(){return{kernelClearStyle:function(a,b){var c=this.__kernelGetRangeType(a,b);switch(c){case"ALL":this.__kernelClearAllStyle();break;case"ROW":this.__kernelClearRowStyle(a.row,b.row);break;case"COLUMN":this.__kernelClearColumnStyle(a.col,b.col);break;case"RANGE":this.__kernelClearRangeStyle(a,b)}},__kernelClearAllStyle:function(){var a=this.kernelGetTotalIndex();this.__kernelClearColumnStyle(0,a.col)},__kernelClearRowStyle:function(a,b){for(var c=this.kernelGetActiveData(),d=c.rowStyle,e=a;b>=e;e++)void 0!==d[e]&&(d[e]=void 0);this.__clearRowCellStyle(a,b),this.__clearOverlayColumnStyle(a,b)},__kernelClearColumnStyle:function(a,b){for(var c=this.kernelGetActiveData(),d=c.columnStyle,e=a;b>=e;e++)void 0!==d[e]&&(d[e]=void 0);this.__clearColumnCellStyle(a,b),this.__clearOverlayRowStyle(a,b)},__kernelClearRangeStyle:function(a,b){for(var c,d=a.row,e=a.col,f=b.row,g=b.col,h=this.kernelGetActiveData(),i=h.cellStyle,j=d;f>=j;j++)for(var k=e;g>=k;k++)c=this.__getStyleIndex(j,k)||0,i[j][k]=0},__clearRowCellStyle:function(a,b){for(var c,d,e=this.kernelGetActiveData(),f=e.cellStyle,g=a;b>=g;g++){c=f[g];for(var h=0,i=c.length;i>h;h++)d=c[h],void 0!==d&&(c[h]=void 0)}},__clearColumnCellStyle:function(a,b){for(var c,d,e,f=this.kernelGetActiveData(),g=f.cellStyle,h=0,i=g.length;i>h;h++){c=g[h],e=0;for(var j=a;b>=j;j++,e++)d=c[j],void 0!==d&&(c[j]=void 0)}},__clearOverlayColumnStyle:function(a,b){for(var c=this.kernelGetActiveData(),d=c.columnStyle,e=c.cellStyle,f=a;b>=f;f++)for(var g=0,h=d.length;h>g;g++)void 0!==d[g]&&(e[f][g]=0)},__clearOverlayRowStyle:function(a,b){for(var c,d=this.kernelGetActiveData(),e=d.rowStyle,f=d.cellStyle,g=0,h=e.length;h>g;g++)if(c=e[g],void 0!==c)for(var i=a;b>=i;i++)f[g][i]=0}}}},b[174]={value:function(){var a=b.r(175),c=b.r(180).applyName;return{kernelGetStyle:function(a,b,c){var d=this.__kernelGetStyle(a,b,c);return void 0===d?void 0:this.data.styleGroup[a][d]},kernelGetStyleIds:function(a,b,c){for(var d,e,f,g=b.row,h=b.col,i=c.row,j=c.col,k=[],l=g;i>=l;l++){d=[],f=0;for(var m=h;j>=m;m++,f++)e=this.__kernelGetStyle(a,l,m),void 0!==e&&(d[f]=e);k.push(d)}return k},kernelGetStyleById:function(a,b){return this.data.styleGroup[a][b]},kernelSetStyle:function(a,b,c,d){if("border"===a)return this.kernelSetBorder(b,c,d);var e=this.__kernelGetRangeType(c,d);switch(e){case"ALL":this.__kernelSetAllStyle(a,b);break;case"ROW":this.__kernelSetRowStyle(a,b,c.row,d.row);break;case"COLUMN":this.__kernelSetColumnStyle(a,b,c.col,d.col);break;case"RANGE":this.__kernelSetRangeStyle(a,b,c,d)}},kernelBatchSetStyle:function(a,b,c){var d=this.data.styleGroup;a.border&&delete a.border;for(var e in a)a.hasOwnProperty(e)&&(a[e]=$.extend($._clone(d[e][0]),a[e]));this.kernelSetStyle(a,null,b,c)},__kernelSetAllStyle:function(a,b){var c=this.kernelGetTotalIndex();this.__kernelSetColumnStyle(a,b,0,c.col)},__kernelSetRowStyle:function(b,c,d,e){for(var f,g=this.kernelGetActiveData(),h=g.rowStyle,i=d;e>=i;i++)f=h[i]||0,h[i]=a.generateStyle(this.data,f,b,c);this.__patchRowCellStyle(b,c,d,e),this.__overlayColumnStyle(b,c,d,e)},__kernelSetColumnStyle:function(b,c,d,e){for(var f,g=this.kernelGetActiveData(),h=g.columnStyle,i=d;e>=i;i++)f=h[i]||0,h[i]=a.generateStyle(this.data,f,b,c);this.__patchColumnCellStyle(b,c,d,e),this.__overlayRowStyle(b,c,d,e)},__kernelSetRangeStyle:function(b,c,d,e){for(var f,g=d.row,h=d.col,i=e.row,j=e.col,k=this.kernelGetActiveData(),l=k.cellStyle,m=g;i>=m;m++)for(var n=h;j>=n;n++)f=this.__getStyleIndex(m,n)||0,l[m][n]=a.generateStyle(this.data,f,b,c)},__patchRowCellStyle:function(b,c,d,e){for(var f,g,h,i=this.kernelGetActiveData(),j=i.cellStyle,k=i.rowStyle,l=d;e>=l;l++){f=j[l];for(var m=0,n=f.length;n>m;m++)g=f[m],void 0!==g&&(h=a.generateStyle(this.data,g,b,c),f[m]=k[l]===h?void 0:h)}},__patchColumnCellStyle:function(b,c,d,e){for(var f,g,h,i,j=this.kernelGetActiveData(),k=j.cellStyle,l=j.rowStyle,m=0,n=k.length;n>m;m++){f=k[m],h=0;for(var o=d;e>=o;o++,h++)g=f[o],g&&(i=a.generateStyle(this.data,g,b,c),f[o]=l[m]===i?void 0:i)}},__overlayColumnStyle:function(b,c,d,e){for(var f,g=this.kernelGetActiveData(),h=g.columnStyle,i=g.cellStyle,j=g.rowStyle,k=d;e>=k;k++)for(var l=0,m=h.length;m>l;l++)h[l]&&!i[k][l]&&(f=a.mergeStyle(this.data,h[l],j[k],b,c),i[k][l]=j[k]===f?void 0:f)},__overlayRowStyle:function(b,c,d,e){for(var f,g,h,i,j=this.kernelGetActiveData(),k=j.rowStyle,l=j.cellStyle,m=j.columnStyle,n=0,o=k.length;o>n;n++)if(f=k[n]){h=0;for(var p=d;e>=p;p++,h++)g=l[n][p],m[p]&&!g&&(i=a.mergeStyle(this.data,m[p],f,b,c),l[n][p]=f===i?void 0:i)}},__kernelGetStyle:function(a,b,c){var d=this.kernelGetActiveData(),e=this.data,f=d.cellStyle,g=d.rowStyle,h=d.columnStyle,i=e.styleIndex,j=f[b][c],k=this.__kernelGetClassifyInStyle(a,i[j]);return void 0!==k?k:(j=g[b],k=this.__kernelGetClassifyInStyle(a,i[j]),void 0!==k?k:(j=h[c],k=this.__kernelGetClassifyInStyle(a,i[j]),void 0!==k?k:-1!==d.allStyle?this.__kernelGetClassifyInStyle(a,i[d.allStyle]):void 0))},__kernelSetStyleIndex:function(a,b,c){for(var d=this.kernelGetActiveData().cellStyle,e=b.row,f=c.row;f>=e;e++)for(var g=b.col,h=c.col;h>=g;g++)d[e][g]=a},__getStyleIndex:function(a,b){var c=this.kernelGetActiveData(),d=c.cellStyle,e=c.rowStyle,f=c.columnStyle,g=d[a][b];return void 0!==g?g:(g=e[a],void 0!==g?g:-1!==c.allStyle?c.allStyle:f[b])},__kernelGetClassifyInStyle:function(a,b){var d,e=c[a];return b?b[e]?b[a]:(d=this.data.xfList[b.xf],d[e]?d[a]:void 0):void 0}}}},b[175]={value:function(){function a(a,b,c){function f(c,e,f){var g=j[c],i=h[c],k=f[c],l=$._clone(i[k]);l=$.extend(l,e),b=d(a,c,l),f[c]=b,f[g]=1}var g=a.styleIndex,h=a.styleGroup,i=$._clone(g[b]);for(var k in c)c.hasOwnProperty(k)&&f(k,c[k],i);return e(a,i)}function c(a,b,c){var d=a.styleIndex,e=$._clone(d[b]);if(!c)return e;if(b===c)return e;var f=d[c];return f.applyBorder&&(e.applyBorder=1,e.borders=f.borders),f.applyFill&&(e.applyFill=1,e.fills=f.fills),f.applyFont&&(e.applyFont=1,e.fonts=f.fonts),f.applyAlignment&&(e.applyAlignment=1,e.alignments=f.alignments),e}function d(a,b,c){var d=a.styleGroupMap[b],e=JSON.stringify(c),f=d[e];if(void 0!==f)return f;var g=a.styleGroup[b];return f=g.length,d[e]=f,g.push(c),f}function e(a,b){var c=a.styleIndexMap,d=JSON.stringify(b),e=c[d];if(void 0!==e)return e;var f=a.styleIndex;return c[d]=f.length,f.push(b),c[d]}function f(a,b,c){var d,e=a.styleIndex,f=a.styleGroup.borders,h=e[b];return d=0===h.applyBorder?{top:l,left:l,right:l,bottom:l}:$._clone(f[h.borders].border),g(a,d,c)}function g(a,b,c){var d=a.styleGroup.borders;for(var e in c)c.hasOwnProperty(e)&&(b[e]=c[e]);var f=JSON.stringify(b);return void 0!==a.borderMap[f]?a.borderMap[f]:(a.borderMap[f]=d.length,d.push({border:b}),a.borderMap[f])}var h=b.r(180),i=h.classify,j=h.applyName,k=h.applyClassifyMap,l=b.r(118),m=b.r(149);return{generateStyle:function(b,c,f,g){if("string"!=typeof f)return a(b,c,f);g||(g=m[f]);var h=i[f],k=j[f],l=b.styleIndex,n=b.styleGroup[h],o=l[c],p=o[h],q=n[p];return q[f]===g&&1===o[k]?c:(q=$._clone(q),q[f]=g,c=d(b,h,q),o=$._clone(o),o[h]=c,o[k]=1,e(b,o))},generateStyleByXfId:function(a,b,c){var d,f=$._clone(a.styleIndex[b]),g=a.xfList[c],h=a.xfList[f.xf];f.xf=c;for(var i in k)k.hasOwnProperty(i)&&(d=k[i],g[i]?(f[i]=0,f[d]=g[d]):h[i]&&(f[i]=1,f[d]=h[d]));return e(a,f)},generateBorder:function(a,b,c){c||(c=m.border);var d=f(a,b,c),g=a.styleIndex,h=g[b];return 1===h.applyBorder&&h.borders===d?b:(h=$._clone(h),h.borders=d,h.applyBorder=1,e(a,h))},unsetStyleClassify:function(a,b,c){var d=a.styleIndex,f=a.xfList,g=j[b],h=$._clone(d[c]);return h[g]?h[b]=0:f[h.xf][g]&&0!==f[h.xf][b]&&(h[g]=1,h[b]=0),e(a,h)},generateGroupIndex:function(a,b,c){return d(a,b,c)},mergeStyle:function(a,b,f,g,h){var k,l=c(a,b,f),m=a.styleGroup,n=i[g],o=j[g];return k=$._clone(1===l[o]?m[n][l[n]]:$._clone(m[n][0])),k[g]=h,l[o]=1,l[n]=d(a,n,k),e(a,l)},mergeBorder:function(a,b,d,f){var h,i=c(a,b,d),j=a.styleGroup;return h=$._clone(1===i.applyBorder?j.borders[i.borders].border:j.borders[0].border),i.applyBorder=1,i.borders=g(a,h,f),e(a,i)}}}},b[176]={value:function(){b.r(175),b.r(118);return{kernelGetActiveData:function(){return this.data.sheets[this.data.active]}}}},b[177]={value:function(){var a=b.r(175),c=b.r(180),d=c.classify,e=c.applyName,f=b.r(179).xfStyle;return{kernelSetXfStyle:function(a,b,c){var d=this.__kernelGetXfId(a),e=this.__kernelGetRangeType(b,c);switch(e){case"ALL":this.__kernelSetAllXfStyle(d);break;case"ROW":this.__kernelSetRowXfStyle(d,b.row,c.row);break;case"COLUMN":this.__kernelSetColumnXfStyle(d,b.col,c.col);break;case"RANGE":this.__kernelSetRangeXfStyle(d,b,c)}},__kernelSetAllXfStyle:function(a){var b=this.kernelGetTotalIndex();this.__kernelSetColumnStyle(a,0,b.col)},__kernelSetRowXfStyle:function(b,c,d){for(var e,f=this.kernelGetActiveData(),g=f.rowStyle,h=c;d>=h;h++)e=g[h]||0,g[h]=a.generateStyleByXfId(this.data,e,b);this.__patchRowCellXfStyle(b,c,d),this.__overlayColumnXfStyle(b,c,d)},__kernelSetColumnXfStyle:function(b,c,d){for(var e,f=this.kernelGetActiveData(),g=f.columnStyle,h=c;d>=h;h++)e=g[h]||0,g[h]=a.generateStyleByXfId(this.data,e,b);this.__patchColumnCellXfStyle(b,c,d),this.__overlayRowXfStyle(b,c,d)},__kernelSetRangeXfStyle:function(b,c,d){for(var e,f=c.row,g=c.col,h=d.row,i=d.col,j=this.kernelGetActiveData(),k=j.cellStyle,l=f;h>=l;l++)for(var m=g;i>=m;m++)e=this.__getStyleIndex(l,m)||0,k[l][m]=a.generateStyleByXfId(this.data,e,b)},__patchRowCellXfStyle:function(b,c,d){for(var e,f,g,h=this.kernelGetActiveData(),i=h.cellStyle,j=h.rowStyle,k=c;d>=k;k++){e=i[k];for(var l=0,m=e.length;m>l;l++)f=e[l],void 0!==f&&(g=a.generateStyleByXfId(this.data,f,b),e[l]=j[k]===g?void 0:g)}},__patchColumnCellXfStyle:function(b,c,d){for(var e,f,g,h,i=this.kernelGetActiveData(),j=i.cellStyle,k=i.rowStyle,l=0,m=j.length;m>l;l++){e=j[l],g=0;for(var n=c;d>=n;n++,g++)f=e[n],f&&(h=a.generateStyleByXfId(this.data,f,b),e[n]=k[l]===h?void 0:h)}},__overlayColumnXfStyle:function(b,c,d){for(var e,f=this.kernelGetActiveData(),g=f.columnStyle,h=f.cellStyle,i=f.rowStyle,j=c;d>=j;j++)for(var k=0,l=g.length;l>k;k++)g[k]&&!h[j][k]&&(e=a.generateStyleByXfId(this.data,g[k],b),h[j][k]=i[j]===e?void 0:e)},__overlayRowXfStyle:function(b,c,d){for(var e,f,g,h,i=this.kernelGetActiveData(),j=i.rowStyle,k=i.cellStyle,l=i.columnStyle,m=0,n=j.length;n>m;m++)if(e=j[m]){g=0;for(var o=c;d>=o;o++,g++)f=k[m][o],l[o]&&!f&&(h=a.generateStyleByXfId(this.data,l[o],b),k[m][o]=e===h?void 0:h)}},__kernelGetXfId:function(b){var c,f,g=this.data,h={},i=[],j={},k=JSON.stringify(b),l=g.xfValueRecord[k];if(void 0!==l)return l;for(var m in b)b.hasOwnProperty(m)&&(c=d[m],i.push(c),h[c]||(h[c]={}),h[c][m]=b[m]);for(var n=0,o=i.length;o>n;n++)c=i[n],f=this.__kernelGroupStyleNormalized(c,h[c]),j[e[c]]=1,j[c]=a.generateGroupIndex(g,c,f);return j=this.__kernelXfStyleNormalized(j),l=g.xfList.length,g.xfList.push(j),g.xfValueRecord[k]=l,l},__kernelGroupStyleNormalized:function(a,b){var c=$._clone(this.kernelGetDefaultStyle(a));return $.extend(c,b)},__kernelXfStyleNormalized:function(a){var b=$._clone(f);return $.extend(b,a)}}}},b[178]={value:{MAX_COLUMN_COUNT:Math.pow(26,3)-1,MAX_ROW_COUNT:Math.pow(2,16)-1}},b[179]={value:{style:{fonts:0,borders:0,fills:0,alignments:0,numberFormats:0,xf:0,applyFont:0,applyBorder:0,applyFill:0,applyAlignment:0},xfStyle:{fonts:0,borders:0,fills:0,alignments:0,numberFormats:0,applyFont:0,applyBorder:0,applyFill:0,applyAlignment:0,applyNumberFormat:0}}},b[180]={value:function(){return{classify:{color:"fonts",name:"fonts",bold:"fonts",italic:"fonts",underline:"fonts",throughline:"fonts",size:"fonts",fill:"fills",border:"borders",wraptext:"alignments",horizontal:"alignments",vertical:"alignments",numberFormat:"numberFormats"},applyName:{color:"applyFont",name:"applyFont",bold:"applyFont",italic:"applyFont",underline:"applyFont",throughline:"applyFont",size:"applyFont",font:"applyFont",border:"applyBorder",fill:"applyFill",numberFormat:"applyNumberFormat",wraptext:"applyAlignment",horizontal:"applyAlignment",vertical:"applyAlignment",alignments:"applyAlignment",fonts:"applyFont",fills:"applyFill",borders:"applyBorder",numberFormats:"applyNumberFormat"},applyClassifyMap:{applyFont:"fonts",applyBorder:"borders",applyFill:"fills",applyAlignment:"alignments",applyNumberFormat:"numberFormats"}}}},b[181]={value:function(){return["color","backgroundColor","textAlign","verticalAlign","underline","throughline","fontStyle","fontWeight","fontSize","fontFamily","wraptext"]}},b[182]={value:function(){var a=b.r(118),c={defaultStyle:$._clone(b.r(13)),styleGroup:{numberFormats:[{numberFormat:a}],fonts:[{color:"#000000",name:"\u5b8b\u4f53",bold:!1,italic:!1,underline:!1,throughline:!1,size:13}],fills:[{fill:a}],borders:[{border:{top:a,left:a,right:a,bottom:a}}],alignments:[{wraptext:!1,horizontal:a,vertical:a}]},xfList:[{fonts:0,borders:0,fills:0,alignments:0,numberFormats:0,applyFont:1,applyBorder:1,applyFill:1,applyAlignment:0,applyNumberFormat:0}],styleIndex:[{fonts:0,borders:0,fills:0,alignments:0,numberFormats:0,xf:0,applyFont:0,applyBorder:0,applyFill:0,applyAlignment:0,applyNumberFormat:0}],styleGroupMap:{},styleIndexMap:{},xfListMap:{},xfValueRecord:{},borderMap:{}};return c}},b[183]={value:function(){return{common:{cell:b.r(6),title:b.r(11),content:b.r(9),color:b.r(7),style:b.r(10)},core:{struct:b.r(83),dataAccess:b.r(39),sheet:b.r(81),actuary:b.r(15),range:b.r(80),value:b.r(110),datetime:b.r(44),cell:b.r(18),view:b.r(111),style:b.r(84),border:b.r(17),hidden:b.r(76),visible:b.r(112),device:b.r(48),exportManager:b.r(49),wraptext:b.r(113),autosize:b.r(16),formula:b.r(52),valueSecurity:b.r(86),mode:b.r(77),comments:b.r(36),paster:b.r(78)},system:{screen:b.r(226),scrollbar:b.r(230),cover:b.r(195),position:b.r(209),input:b.r(202),selection:b.r(234),resize:b.r(210),rowcolumn:b.r(211),sort:b.r(235),viewport:b.r(236),clipboard:b.r(184),selectall:b.r(231),commentsTip:b.r(188),converter:b.r(189)}}}},b[184]={value:function(){var a=b.r(2),c=(b.r(198),b.r(0).create("Clipboard",{base:b.r(138),converterModule:null,inputModule:null,tipNode:null,$tipNode:null,state:!1,cutState:!1,start:null,end:null,inputActive:!1,init:function(b,c){this.inputModule=b,this.converterModule=c,this.tipNode=this.createElement("div","btb-copy-tip"),this.$tipNode=a(this.tipNode),this.initEvent(),this.initMessageHook(),this.initService()},run:function(){this.getContentContainer().appendChild(this.tipNode)},initEvent:function(){var b=this;a(this.getMainContainer()).on("paste",function(a){a.preventDefault(),a.stopPropagation(),b.inputActive?b.pasteActiveCell(a.originalEvent.clipboardData):b.pasteInactiveCell(a.originalEvent.clipboardData)}).on("copy",function(a){b.inputActive||(a.preventDefault(),a.stopPropagation(),b.oncopy(a.originalEvent.clipboardData))}).on("cut",function(a){b.inputActive||(a.preventDefault(),a.stopPropagation(),b.oncut(a.originalEvent.clipboardData))}).on("keydown",function(){})},initMessageHook:function(){this.onMessage({"c.refresh":this.refresh,"s.input.active":this.active,"s.input.inactive":this.inactive})},active:function(){this.inputActive=!0},inactive:function(){this.inputActive=!1},initService:function(){this.registerService({"s.paste":this.paste,"s.cut":this.cut})},paste:function(a,b,c){var d=c.row,e=c.col;this.corePrepareRefresh(),this.rs("c.batch.write",a,c.row,c.col),b&&this.rs("c.batch.setstyle",b,c.row,c.col);for(var f=[],g=0,h=a.length;h>g;g++)f.push(a[g].length);var i=Math.max.apply(null,f);this.__changeSelection({row:d,col:e},{row:d+a.length-1,col:e+i-1}),this.coreRefresh()},pasteInactiveCell:function(a){if(-1!==a.types.indexOf("text/html"))this.writeHTML(a.getData("text/html"));else{if(-1===a.types.indexOf("text/plain"))return;this.writeText(a.getData("text/plain"))}this.cutState&&(this.cutState=!1,this.execCommand("clearall",this.start,this.end)),this.hide()},writeText:function(a){var b=this.rs("c.range");if(b.isValid()){var c=b.getFocus(),d=this.converterModule.stringToCells(a);this.__writeData(d,c.row,c.col)}},writeHTML:function(a){var b=this.rs("c.range");if(b.isValid()){var c=b.getFocus(),d=this.converterModule.htmlToCells(a);this.__writeData(d,c.row,c.col)}},__writeData:function(a,b,c){for(var d=a.length,e=0,f=0,g=a.length;g>f;f++)e=Math.max(e,a[f].length);d>0&&(d-=1),e>0&&(e-=1),this.rs("c.paste",a,b,c),this.rs("c.range.set",{row:b,col:c},{row:b,col:c},{row:b+d,col:c+e})},pasteActiveCell:function(a){var b=a.types;if(-1!==b.indexOf("text/plain")){var c=a.getData("text/plain");this.rs("s.input.inserttext",c)}},show:function(a,b){this.state=!0,this.start={row:a.row,col:a.col},this.end={row:b.row,col:b.col},this.refresh()},hide:function(){this.state=!1,this.start=null,this.end=null,this.cutState=!1,this.$tipNode.css("display","none")},refresh:function(){if(this.state){var a=this.rs("c.struct"),b=this.cs("c.cell.viewrect",a,this.start,this.end);if(!b)return void this.$tipNode.css("display","none");var c=b.overflow;this.$tipNode.css({top:b.y,left:b.x,width:b.width,height:b.height,borderLeftColor:c.left?"transparent":"",borderRightColor:c.right?"transparent":"",borderTopColor:c.top?"transparent":"",borderBottomColor:c.bottom?"transparent":"",display:"block"})}},oncopy:function(a){var b=this.rs("c.range"),c=b.getStart(),d=b.getEnd();this.show(c,d),a.clearData();var e=this.converterModule["export"](c,d);e&&(a.setData("text/html",e.html),a.setData("text/plain",e.string))},oncut:function(a){this.cutState=!0,this.oncopy(a)},__changeSelection:function(a,b){this.rs("c.range.set",{row:a.row,col:a.col},{row:a.row,col:a.col},{row:b.row,col:b.col})}}));return c.deps=["input","converter"],c}},b[185]={value:function(){return b.r(0).create("_PasteCommand",{base:b.r(134),name:"paste cut",execute:function(a,b,c,d,e){"paste"===a?this.rs("s.paste",b,c,d):this.rs("s.cut",b,c,d,e)}})}},b[186]={value:function(){return b.r(0).create("InputLockCommand",{base:b.r(134),name:"lockinput unlockinput inputfocus",execute:function(a){switch(a){case"lockinput":this.rs("s.input.lock");break;case"unlockinput":this.rs("s.input.unlock");break;case"inputfocus":this.rs("s.input.focus")}}})}},b[187]={value:function(){return b.r(0).create("SortCommand",{base:b.r(134),name:"sortcolumnbyasc sortcolumnbydesc sortrowbyasc sortrowbydesc",execBefore:function(a){if(3===arguments.length)return[].slice.call(arguments,1);var b,c=this.rs("c.range"),d=c.getFocus();switch(a){case"sortcolumnbyasc":case"sortcolumnbydesc":b=d.col;break;case"sortrowbyasc":case"sortrowbydesc":b=d.row}var e=this.rs("c.struct"),f=e.getEffectiveIndex(),g=c.getEnd();return[b,{start:c.getStart(),end:{row:Math.min(g.row,f.row),col:Math.min(g.col,f.col)}}]},execute:function(a,b,c){this[a](b,c)},sortcolumnbyasc:function(a,b){return this.rs("c.sort.column.asc",a,b)},sortcolumnbydesc:function(a,b){return this.rs("c.sort.column.desc",a,b)},sortrowbyasc:function(a,b){return this.rs("c.sort.row.asc",a,b)},sortrowbydesc:function(a,b){return this.rs("c.sort.row.desc",a,b)}})}},b[188]={value:function(){var a=b.r(14).border.offset,c=b.r(0).create("CommentsTip",{panel:null,cover:null,timer:null,base:b.r(138),init:function(a){this.panel=this.createElement("div","btb-comments-tip"),this.cover=a,this.initEvent(),this.initMessageHook()},run:function(){this.getContentContainer().appendChild(this.panel)},initEvent:function(){this.cover.oncellenter(this,this.cellenter),this.cover.oncellleave(this,this.cellleave)},initMessageHook:function(){this.onMessage({"s.input.active":this.hide})},cellenter:function(a,b){var c=this;this.timer=setTimeout(function(){c.show(a,b)},500)},cellleave:function(){this.hide(),this.timer&&(clearTimeout(this.timer),this.timer=null)},show:function(a,b){var c=this.rs("c.struct"),d=c.getGrid(),e=d.rowMap[a],f=d.colMap[b],g=c.getMergeCell(e,f),h=c.getCommentsInView();g&&(e=g.start.row,f=g.start.col),h=h[e+","+f],h&&(g?this.__showMergeCellComments(g.end.row,g.end.col,h):this.__showNormalCellComments(a,b,h))},__showNormalCellComments:function(a,b,c){var d=this.rs("c.struct"),e=d.getGrid(),f=e.viewColPoints,g=e.viewRowPoints;this.__showTips(f[b+1],g[a],c.content)},__showMergeCellComments:function(a,b,c){var d=this.rs("c.struct"),e=d.getGrid(),f=e.rMap[a],g=e.cMap[b];void 0!==f&&void 0!==g&&this.__showTips(e.viewColPoints[g+1],e.viewRowPoints[f],c.content)},__showTips:function(b,c,d){$(this.panel).html(d.replace(/\n/g,"<br>")).css({top:c-a,left:b+a+2,display:"block"})},hide:function(){this.panel.style.display="none"}});return c.deps=["cover"],c}},b[189]={value:function(){var a=b.r(190),c=b.r(193),d=b.r(192);return b.r(0).create("Converter",{htmlConverter:null,plaintextConverter:null,outConverter:null,base:b.r(138),init:function(b,e){this.valueModule=b,this.styleModule=e,this.htmlConverter=this.createComponent(a),this.plaintextConverter=this.createComponent(c),this.outConverter=this.createComponent(d)},htmlToCells:function(a){return this.htmlConverter.fromHTML(a)},stringToCells:function(a){return this.plaintextConverter.fromPlaintext(a)},"export":function(a,b){return this.outConverter.parse(a,b)},selectRow:function(a){var b=this.position.toIndex(0,a),c=this.rs("c.struct"),d=c.getGrid();this.execCommand("selectrow",d.rowMap[b.row])}})}},b[190]={value:function(){function a(b,d){for(var f,g,h,m,n,o=b.childNodes,p=[],q={},r=0,s=o.length;s>r;r++)f=o[r],g=f.nodeType,h=f.nodeName.toLowerCase(),"br"!==h?l[h]||("table"!==h?k[h]?(p.length>0&&(d.push(p),p=[]),a(f,d)):(g===i?(m=f.innerText,q=$.extend(!0,q,e(f))):g===j&&(m=f.data),m&&(p.length||p.push({content:""}),n=p[p.length-1],n.content+=m)):c(f,d)):(d.push(p),p=[]);p.length>0&&(p[0].style=$.extend(!0,e(b),q),d.push(p))}function c(a,b){var c,f,g,h=a.caption,i=a.rows;h&&b.push(h.innerText);for(var j=0,k=i.length;k>j;j++){g=e(i[j]),c=i[j].cells,f=[],b.push(f);for(var l=0,m=c.length;m>l;l++)f.push({style:$.extend(!0,$._clone(g),e(c[l]),d(c[l])),content:c[l].innerText.replace(/\n/g,"")})}}function d(a){for(var b=a.children,c=e(a),f=0,g=b.length;g>f;f++)$.extend(!0,c,d(b[f]));return c}function e(a){var b=a.style,c=a.ownerDocument.defaultView.getComputedStyle(a,null),d=f(b,c),e=g(b,c),i=h(b,c);return{fonts:d,fills:e,alignments:i}}function f(a,b){var c="normal"!==b.getPropertyValue("font-weight"),d="normal"!==b.getPropertyValue("font-style"),e="underline"===b.getPropertyValue("text-decoration"),f="line-through"===b.getPropertyValue("text-decoration"),g={};
return a.fontFamily&&(g.name=b.getPropertyValue("font-family").split(",")[0]),a.color&&(g.color=b.getPropertyValue("color")),a.fontSize&&(g.size=parseInt(b.getPropertyValue("font-size"),10)),c&&(g.bold=!0),d&&(g.italic=!0),e&&(g.underline=!0),f&&(g.throughline=!0),g}function g(a,b){var c={},d=b.getPropertyValue("background-color");return a.backgroundColor?0===d.indexOf("rgba")?c:(d=d.replace(/\s+/g,""),"white"===d||"#fff"===d||"#ffffff"===d||"rgb(255,255,255)"===d?c:(c.fill=d,c)):c}function h(a,b){var c={},d=b.getPropertyValue("text-align"),e=b.getPropertyValue("vertical-align");return("left"===d||"right"===d||"center"===d)&&(c.horizontal=d),("top"===e||"bottom"===e||"middle"===e)&&(c.vertical=e),c}var i=1,j=3,k=b.r(194),l=b.r(191);return b.r(0).create("Converter",{shadowNode:null,base:b.r(135),init:function(){var a=this.createElement("iframe");a.style.display="none",this.getDocument().body.appendChild(a);var b=this.rs("c.struct"),c=b.getDefaultStyle("fonts");this.shadowNode=a.contentDocument.documentElement,this.shadowNode.style.cssText=["color:"+c.color,"font-family:"+c.name,"font-size:"+c.size+"px"].join("; ")},fromHTML:function(b){var c=[];return this.shadowNode.innerHTML=b,a(this.shadowNode.getElementsByTagName("body")[0],c),c}})}},b[191]={value:{applet:1,area:1,audio:1,base:1,basefont:1,bdi:1,bdo:1,bgsound:1,body:1,button:1,canvas:1,caption:1,center:1,col:1,colgroup:1,command:1,content:1,data:1,datalist:1,dialog:1,element:1,embed:1,footer:1,form:1,frame:1,frameset:1,head:1,header:1,hr:1,html:1,iframe:1,image:1,img:1,input:1,isindex:1,keygen:1,link:1,listing:1,map:1,menu:1,menuitem:1,meta:1,meter:1,multicol:1,noembed:1,noframes:1,noscript:1,object:1,optgroup:1,option:1,param:1,picture:1,progress:1,rtc:1,samp:1,script:1,select:1,shadow:1,source:1,spacer:1,strike:1,style:1,summary:1,template:1,textarea:1,time:1,track:1,video:1,wbr:1,xmp:1}},b[192]={value:function(){function a(a){for(var b=[],c=0,e=a.length;e>c;c++)b.push(d(a[c]));return"<table><tbody>"+b.join("")+"</tbody></table>"}function c(a){for(var b,c,d=[],e=0,f=a.length;f>e;e++){c=[],b=a[e];for(var g=0,h=b.length;h>g;g++)c.push(b[g]);d.push(c.join("	"))}return d.join("\n")}function d(a){for(var b=[],c=0,d=a.length;d>c;c++)b.push(e(a[c]));return"<tr>"+b.join("")+"</tr>"}function e(a){if(!a)return"<td></td>";var b=a.style,c=a.content||"";return'<td style="'+f(b)+'">'+c+"</td>"}function f(a){if(!a)return"";var b=[],c=a.fonts,d=a.fills,e=a.alignments;return c&&b.push(g(c)),d&&b.push(h(d)),e&&b.push(i(e)),b.join(";")}function g(a){var b=[];return a.color!==k&&b.push("color: "+a.color),a.name!==k&&b.push("font-family: "+a.name),a.bold===!0&&b.push("font-weight: bold"),a.italic===!0&&b.push("font-style: italic"),a.underline===!0&&b.push("text-decoration: underline"),a.throughline===!0&&b.push("text-decoration: line-through"),a.size!==k&&b.push("font-size: "+a.size+"px"),b.join(";")}function h(a){return"background-color:"+a.fill}function i(a){var b=[];return a.horizontal!==k&&b.push("text-align: "+a.horizontal),a.vertical!==k&&b.push("vertical-align: "+a.vertical),b.join(";")}function j(a,b,c){var d,e={},f=!1,g=!1,h=!1;return d=a.getUserStyle("fonts",b,c),d&&(f=!0,e.fonts=d),d=a.getUserStyle("alignments",b,c),d&&(g=!0,e.alignments=d),d=a.getUserStyle("fills",b,c),d&&(h=!0,e.fills=d),f||g||h?e:null}var k="none";return b.r(0).create("Converter",{shadowNode:null,base:b.r(135),parse:function(b,d){for(var e,f,g,h,i,k=[],l=[],m=this.getModule("value"),n=this.getModule("style"),o=b.row,p=d.row;p>=o;o++){e=[],f=[],k.push(e),l.push(f);for(var q=b.col,r=0,s=d.col;s>=q;q++,r++)i=m.getFormattedValue(o,q),i&&(g=i),f.push(i||""),i=j(n,o,q),i&&(h=i),e[r]={style:h,content:g}}return{html:a(k),string:c(l)}}})}},b[193]={value:function(){return b.r(0).create("Converter",{base:b.r(135),fromPlaintext:function(a){for(var b,c,d=[],e=a.split("\n"),f=0,g=e.length;g>f;f++){c=e[f].split("	"),b=[],d.push(b);for(var h=0,i=c.length;i>h;h++)b.push({content:c[f]})}return d}})}},b[194]={value:{address:1,article:1,aside:1,audio:1,blockquote:1,canvas:1,dd:1,div:1,dl:1,fieldset:1,figcaption:1,figure:1,figcaption:1,footer:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,header:1,hgroup:1,hr:1,main:1,nav:1,noscript:1,ol:1,output:1,p:1,pre:1,section:1,table:1,tfoot:1,ul:1,video:1,li:1}},b[195]={value:function(){var a=b.r(2),c=b.r(0).create("Cover",{position:null,panel:null,doc:null,timer:null,celleventTimer:null,leavePoint:null,lastIndex:null,lastPoint:null,state:!1,queue:{mousedown:[],mousemove:[],mouseup:[],dblclick:[],mouseleave:[],cellenter:[],cellleave:[]},base:b.r(138),init:function(a){this.position=a,this.doc=this.getDocument(),this.panel=this.createPanel(),this.initEvent(),this.initMessageHook()},initMessageHook:function(){this.onMessage({"c.refresh":this.refresh})},refresh:function(){var a=this;this.celleventTimer&&clearTimeout(this.celleventTimer),this.lastIndex&&(this.emit("cellleave",this.lastIndex.row,this.lastIndex.col),this.lastIndex=null),this.celleventTimer=setTimeout(function(){a.update(),this.celleventTimer=null},500)},update:function(){if(this.lastPoint){var a=this.position.toIndex(this.lastPoint.x,this.lastPoint.y);this.emit("cellenter",a.row,a.col),this.lastIndex=a}},initEvent:function(){var b,c=this.position,d=this,e=-1;a(this.panel).on("mousedown dblclick",function(a){if(a.stopPropagation(),a.preventDefault(),d.lastPoint={x:a.clientX,y:a.clientY},b=Date.now(),"dblclick"!==a.type){if(300>b-e)return;d.state=!0}e=b;var f=c.toIndex(a.clientX,a.clientY);d.emit(a.type,f.row,f.col)}).on("mouseup",function(a){if(d.lastPoint={x:a.clientX,y:a.clientY},d.state){d.state=!1,a.stopPropagation(),a.preventDefault();var b=c.toIndex(a.clientX,a.clientY);d.emit(a.type,b.row,b.col)}}).on("mousemove",function(a){a.stopPropagation(),a.preventDefault();var b=c.toIndex(a.clientX,a.clientY);d.lastPoint={x:a.clientX,y:a.clientY},d.lastIndex?(d.lastIndex.row!==b.row||d.lastIndex.col!==b.col)&&(d.emit("cellleave",d.lastIndex.row,d.lastIndex.col),d.emit("cellenter",b.row,b.col),d.lastIndex=b):(d.lastIndex=b,d.emit("cellenter",b.row,b.col)),d.state&&d.emit(a.type,b.row,b.col)}).on("mouseleave",function(a){var b=c.toIndex(a.clientX,a.clientY);if(d.lastPoint=null,d.lastIndex&&(d.emit("cellleave",d.lastIndex.row,d.lastIndex.col),d.lastIndex=null),d.state){a.stopPropagation(),a.preventDefault();var e=c.getDirection(a.clientX,a.clientY);e&&(d.startLeave(),d.leavePoint={x:a.clientX,y:a.clientY},d.emit(a.type,e,b.row,b.col))}}).on("mouseenter",function(a){d.lastPoint={x:a.clientX,y:a.clientY},d.endLeave()})},startLeave:function(){var b=this,c=this.position;a(this.doc).on("mousemove.btableleave",function(a){return 0===a.which?(b.endLeave(),void b.stop()):void(b.leavePoint={x:a.clientX,y:a.clientY})}).on("mouseup.btableleave",function(){b.endLeave(),b.stop()}),this.timer=setInterval(function(){var a=b.leavePoint.x,d=b.leavePoint.y,e=c.getDirection(a,d),f=c.toIndex(a,d);b.emit("mouseleave",e,f.row,f.col)},50)},endLeave:function(){this.leavePoint=null,a(this.doc).off("mousemove.btableleave mouseup.btableleave"),null!==this.timer&&(clearInterval(this.timer),this.timer=null)},getLeaveIndex:function(){return this.position.toIndex(this.leavePoint.x,this.leavePoint.y)},stop:function(){this.state=!1,this.emit("mouseup")},emit:function(a){for(var b=this.queue[a],c=[].slice.call(arguments,1),d=0,e=b.length;e>d;d++)b[d].handler.apply(b[d].provider,c)},onmousedown:function(a,b){this.queue.mousedown.push({provider:a,handler:b})},onmouseup:function(a,b){this.queue.mouseup.push({provider:a,handler:b})},onmousemove:function(a,b){this.queue.mousemove.push({provider:a,handler:b})},onmouseleave:function(a,b){this.queue.mouseleave.push({provider:a,handler:b})},oncellenter:function(a,b){this.queue.cellenter.push({provider:a,handler:b})},oncellleave:function(a,b){this.queue.cellleave.push({provider:a,handler:b})},ondblclick:function(a,b){this.queue.dblclick.push({provider:a,handler:b})},run:function(){this.getContentContainer().appendChild(this.panel)},createPanel:function(){return this.createElement("div",{attr:{"class":"btb-cover"}})}});return c.deps=["position"],c}},b[196]={value:[{color:"rgba(247, 152, 29, 0.1)",border:"#D78E30"},{color:"rgba(60, 160, 232, 0.1)",border:"#3B8ECA"},{color:"rgba(180, 77, 192, 0.1)",border:"rgb(180, 77, 192)"},{color:"rgba(58, 189, 37, 0.1)",border:"#3ABD25"},{color:"rgba(115, 213, 202, 0.1)",border:"rgb(115, 213, 202)"}]},b[197]={value:{OPERAND:"operand",OPERATOR:"operator",REFERENCE:"reference",CONSTANT:"constant"}},b[198]={value:{ENTER:13,LEFT:37,UP:38,RIGHT:39,DOWN:40,TAB:9,ESC:27,BACKSPACE:8,DELETE:46}},b[199]={value:function(){var a=b.r(2),c=b.r(200),d=2,e=b.r(201),f=b.r(0).create("FormulaContent",{cover:null,wrapper:null,container:null,editor:null,analyzer:null,controlState:!1,base:b.r(138),init:function(a){this.position=a,this.wrapper=this.createWrapper(),this.container=this.createEditorContainer(),this.cover=this.createFormulaCover(),this.editor=this.createComponent(c),this.analyzer=this.createComponent(e),this.editor.setAnalyzer(this.analyzer),this.initMessageHook(),this.initEvent()},run:function(){this.editor.appendTo(this.container),this.editor.appendToCover(this.cover),this.wrapper.appendChild(this.container),this.getContentContainer().appendChild(this.wrapper),this.getContentContainer().appendChild(this.cover)},initMessageHook:function(){this.onMessage({"s.formula.model.open":this.start,"s.formula.controlstatechange":this.changeControlState,"s.formula.exit":this.exit})},initEvent:function(){var b,c,d=this;a(this.cover).on("mousedown",function(a){a.preventDefault(),a.stopPropagation(),c=d.rs("c.struct").getViewStart(),b=d.position.toIndex(a.clientX,a.clientY),d.controlState||d.exit(),d.execCommand("focus",c.row+b.row,c.col+b.col)})},start:function(){this.showCover(),this.resize(),this.showInput(),this.editor.reset()},exit:function(){this.hideCover(),this.hideInput(),this.editor.exit(),this.postMessage("s.formula.model.close")},changeControlState:function(a){this.controlState=a},showCover:function(){this.cover.style.display="block"},hideCover:function(){this.cover.style.display="none"},showInput:function(){this.wrapper.style.display="block"},hideInput:function(){this.wrapper.style.display="none"},resize:function(){var b=this.rs("c.struct"),c=b.getGrid(),e=b.getBorderWidth(),f=this.rs("c.range"),g=f.getFocus(),h=this.cs("c.cell.coordinate",b,g.row,g.col);a(this.container).css({minWidth:c.width[g.col]-2*e-2*d,minHeight:c.height[g.row]-2*e-2*d}),a(this.wrapper).css({top:h.y-e,left:h.x-e})},createFormulaCover:function(){return this.createElement("div","btb-formula-cover")},createWrapper:function(){return this.createElement("div","btb-formula-wrapper")},createEditorContainer:function(){return this.createElement("div","btb-editor-container")}});return f.deps=["position"],f}},b[200]={value:function(){var a=b.r(2),c=b.r(198),d=b.r(196),e=b.r(197);return b.r(0).create("Editor",{input:null,$input:null,tooltip:null,$tooltip:null,templateSelection:null,templatePart:null,placeholder:null,analyzer:null,total:null,doc:null,parts:[],blocks:[],selections:[],snapshot:null,focusIndex:0,originalCell:null,controlState:!0,imeState:!1,workState:!1,tipState:!1,index:0,base:b.r(135),init:function(){this.input=this.createInput(),this.$input=a(this.input),this.doc=this.getDocument(),this.tooltip=this.createTooltip(),this.$tooltip=a(this.tooltip),this.container=this.createContainer(),this.placeholder=this.doc.createTextNode(""),this.templatePart=this.createTemplatePart(),this.templateSelection=this.createTemplateSelection(),this.initEvent(),this.initMessageHook()},setAnalyzer:function(a){this.analyzer=a},reset:function(){this.total=this.rs("c.struct").getTotal(),this.originalCell=this.rs("c.range").getFocus(),this.workState=!0,this.tipState=!0,this.index=0,this.input.innerHTML="<span>=</span>",this.placeholder.textContent="",this.changeControlState(!0),this.input.appendChild(this.placeholder),this.input.appendChild(this.tooltip),this.toNodeInnerEnd(this.placeholder)},exit:function(){this.workState=!1,this.blocks=[],this.selections=[],this.parts=[],this.input.blur(),this.container.innerHTML=""},flush:function(a){var b=this.input.innerText.replace("","");this.transferControl(),this.execCommand("write",b,this.originalCell.row,this.originalCell.col),a?this.execCommand("moveup",1):this.execCommand("movedown",1)},transferControl:function(){this.postMessage("s.formula.exit"),this.execCommand("focus",this.originalCell.row,this.originalCell.col)},initEvent:function(){var a=this;this.$input.on("keydown",function(b){switch(b.keyCode){case c.ENTER:return b.preventDefault(),void a.flush(b.shiftKey);case c.ESC:return b.preventDefault(),void a.transferControl()}if(a.controlState&&!a.imeState)switch(b.keyCode){case c.LEFT:a.leftMove(b);break;case c.RIGHT:a.rightMove(b);break;case c.UP:a.upMove(b);break;case c.DOWN:a.downMove(b);break;case c.DELETE:case c.BACKSPACE:a.keyDelete()}}).on("compositionstart",function(){a.imeState=!0}).on("compositionend",function(){a.imeState=!1}).on("input",function(){a.imeState||a.restruct()}).on("blur",function(){a.workState&&(a.flush(),a.postMessage("s.formula.blur"))})},initMessageHook:function(){this.onMessage({"c.refresh":this.update,"c.range.change":this.update})},update:function(){if(this.workState){var a=(this.rs("c.struct"),this.rs("c.range")),b=this.selections;b[this.index]={start:a.getStart(),end:a.getEnd()},this.focusIndex=this.index,this.refreshSelection(),this.updatePart(a),this.hintSelection()}},refreshSelection:function(){for(var a,b,c=this.rs("c.struct"),d=c.getBorderWidth(),e=this.selections,f=this.blocks,g=0,h=e.length;h>g;g++)b=e[g],a=this.cs("c.cell.viewrect",c,b.start,b.end),f[g]||(f[g]=this.getNewSelection(g)),a?f[g].css({width:a.width-2*d,height:a.height-2*d,top:a.y-d,left:a.x-d,background:"none",display:"block"}):f[g].css("display","none")},hintSelection:function(){var a=this.blocks;-1!==this.focusIndex&&a[this.focusIndex].css("backgroundColor",this.getColor(this.focusIndex).color)},updatePart:function(a){if(!a.isMultiple()){var b,c=this.selections[this.index],d=this.cs("c.title.index2char",c.start.col),e=this.parts[this.index];e||(b=this.getColor(),this.parts[this.index]=this.templatePart.cloneNode(!0),e=this.parts[this.index],e.style.color=b.border,this.insertNodeBeforeStart(e)),e.innerHTML=d+(c.start.row+1)}},keyDelete:function(){this.toNodeBefore(this.placeholder)},hideTooltip:function(){this.$tooltip.remove(),this.tipState=!1},restruct:function(){var a=this.input.innerText.replace(/\uFEFF/g,"");this.saveRangeSnapshot();var b=this.analyzer.analyze(this.total,a);return b?(this.reload(b),this.refreshSelection(),void this.hintSelection()):(this.transferControl(),void this.postMessage("s.toinput",a))},saveRangeSnapshot:function(){var a=this.doc.getSelection().getRangeAt(0);this.snapshot={container:a.startContainer,offset:a.startOffset,commonAncestorContainer:a.commonAncestorContainer}},reload:function(b){var c;this.index=0;var d=[];this.free(),this.parts=[],this.selections=[],this.blocks=[];for(var f=0,g=b.length;g>f;f++)switch(c=b[f],c.type){case e.REFERENCE:d[f]=this.createReferencePart(c.content),this.parts[this.index]=d[f],this.selections[this.index]=c.value,this.index++;break;case e.CONSTANT:d[f]=this.createConstantPart(c.content);break;case e.OPERATOR:d[f]=this.createOperatorPart(c.content)}d.unshift(this.createElement("span",{inner:"="}));var h=this.getReplaceRange(d);this.focusIndex=h.focus>0&&b[h.focus-1].type===e.REFERENCE?b[h.focus-1].index:-1,this.input.innerHTML="";for(var f=0,g=d.length;g>f;f++)this.input.appendChild(d[f]);0===b.length||b[b.length-1].type===e.OPERATOR?(a(this.placeholder).remove(),a(this.tooltip).remove(),this.placeholder.textContent="",a(this.placeholder).insertAfter(h.container.parentNode!==this.input?h.container.parentNode:h.container),a(this.tooltip).insertAfter(this.placeholder),this.tipState=!0,this.changeControlState(!0),this.toNodeInnerEnd(this.placeholder)):(this.tipState=!1,this.changeControlState(!1),this.replaceRange(h))},changeControlState:function(a){this.controlState=a,this.postMessage("s.formula.controlstatechange",a)},getReplaceRange:function(a){for(var b,c,d,e=this.getFocusBeforeCount(),f=0,g=0,h=a.length;h>g;g++){b=a[g].textContent.length;{if(!(e>b)){c=a[g].firstChild||a[g],d=e;break}f++,e-=b}}return{container:c,offset:d,focus:f}},getFocusBeforeCount:function(){var a=this.snapshot,b=a.container,c=a.offset,d=[].slice;b.parentNode!==this.input&&(b=b.parentNode);for(var e,f=this.input.cloneNode(!0),g=f.childNodes,h=d.call(this.input.childNodes).indexOf(b),i=g[h],j=g.length-1;j>=h;j--)f.removeChild(g[j]);e=f.innerText.replace("").length;for(var k=i.textContent.split(""),j=0,l=c;l>j;j++)""!==k[j]&&e++;return e},replaceRange:function(a){var b=this.doc.getSelection(),c=b.getRangeAt(0);c=c.cloneRange(),c.setEnd(a.container,a.offset),c.collapse(!1),b.removeAllRanges(),b.addRange(c)},free:function(){this.container.innerHTML=""},createReferencePart:function(a){var b=this.getColor(),c=this.templatePart.cloneNode(!0);return c.style.color=b.border,c.style.textDecoration="none",c.innerHTML=a,c},createConstantPart:function(a){return this.createElement("span",{inner:a})},createOperatorPart:function(a){return this.doc.createTextNode(a)},leftMove:function(a){a.preventDefault(),a.stopPropagation(),this.resetCellRange(),this.hideTooltip(),this.execCommand("moveleft",1)},rightMove:function(a){a.preventDefault(),a.stopPropagation(),this.resetCellRange(),this.hideTooltip(),this.execCommand("moveright",1)},upMove:function(a){a.preventDefault(),a.stopPropagation(),this.resetCellRange(),this.hideTooltip(),this.execCommand("moveup",1)},downMove:function(a){a.preventDefault(),a.stopPropagation(),this.resetCellRange(),this.hideTooltip(),this.execCommand("movedown",1)},resetCellRange:function(){this.selections[this.index]||this.rs("c.range.focus",this.originalCell.row,this.originalCell.col)},getColor:function(a){return a=void 0===a?this.index:a,d[a%d.length]},getNewSelection:function(a){var b=this.createSelection(a);return b.appendTo(this.container),b},createSelection:function(b){var c=this.getColor(b),d=this.templateSelection.cloneNode(!1);return a(d).css({borderColor:c.border})},insertNodeBeforeStart:function(a){var b=this.doc.getSelection().getRangeAt(0),c=b.startContainer;1===c.nodeType?c.insertBefore(a,c.childNodes[b.startOffset]):c.parentNode.insertBefore(a,c)},toNodeBefore:function(a){var b=this.doc.createRange(),c=this.doc.getSelection(),d=a.parentNode;b.setEnd(d,[].slice.call(d.childNodes,0).indexOf(a)),b.collapse(!1),c.removeAllRanges(),c.addRange(b)},toNodeAfter:function(a){var b=this.doc.createRange(),c=this.doc.getSelection();b.setEndAfter(a),b.collapse(!1),c.removeAllRanges(),c.addRange(b)},toNodeInnerEnd:function(a){var b=this.doc.createRange(),c=this.doc.getSelection();if(1===a.nodeType){var d=a.childNodes;b.setEndAfter(d[d.length-1])}else b.setEnd(a,a.textContent.length);b.collapse(!1),c.removeAllRanges(),c.addRange(b)},toNodeInnerStart:function(a){var b=this.doc.createRange(),c=this.doc.getSelection();b.setStart(a,0),b.setEnd(a,0),b.collapse(!1),c.removeAllRanges(),c.addRange(b)},appendToCover:function(a){a.appendChild(this.container)},appendTo:function(a){a.appendChild(this.input)},createInput:function(){return this.createElement("div",{attr:{"class":"btb-formula-editor",contenteditable:!0,spellcheck:!1}})},createContainer:function(){return this.createElement("div","btb-formula-selection")},createTooltip:function(){return this.createElement("span","btb-formula-tooltip")},createTemplatePart:function(){return this.createElement("span","btb-formula-part")},createTemplateSelection:function(){return this.createElement("div","btb-formula-part-block")}})}},b[201]={value:function(){var a=b.r(2),c=b.r(197),d=/[\sA-Z]+/i;return b.r(0).create("FormulaAnalyzer",{base:b.r(135),analyze:function(a,b){if("="!==b.charAt(0))return null;if("="===b)return[];for(var d,e=b.substring(1),f=/([^+*\/^-]+)|([+*\/^-])/g,g=[];d=f.exec(e);)g.push(void 0!==d[1]?{type:c.OPERAND,content:d[1]}:{type:c.OPERATOR,content:d[2]});return this.analyzePart(a,g)},analyzePart:function(a,b){for(var d,e=[],f=0,g=0,h=b.length;h>g;g++)d=b[g],d.type===c.OPERATOR?e[g]=d:(d=d.content,e[g]=-1!==d.indexOf(":")?this.parseMultiPart(a,d):this.parseSinglePart(a,d),e[g].type===c.REFERENCE&&(e[g].index=f,f++));return e},parseSinglePart:function(b,e){var f,g=d.exec(e);if(!g)return{type:c.CONSTANT,content:e};if(g=g[0],f=e.substring(g.length),g+f!==e)return{type:c.CONSTANT,content:e};if(g=g.trim(),f=f.trim(),0===g.length||0===f.length)return{type:c.CONSTANT,content:e};var h=this.cs("c.title.char2index",g.trim());if(!a.isNumeric(f))return{type:c.CONSTANT,content:e};var i=parseInt(f,10)-1;return h>=b.col||i>=b.row?{type:c.CONSTANT,content:e}:{type:c.REFERENCE,content:e,value:{start:{row:i,col:h},end:{row:i,col:h}}}},parseMultiPart:function(a,b){var d=b.split(":",2),e=this.parseSinglePart(a,d[0]),f=this.parseSinglePart(a,d[1]);return e.type!==c.REFERENCE||f.type!==c.REFERENCE?{type:c.CONSTANT,content:b}:{type:c.REFERENCE,content:b,value:{start:e.value.start,end:f.value.start}}}})}},b[202]={value:function(){var a=b.r(208),c=b.r(0).create("Input",{coverModule:null,eventManager:null,inputWorker:null,base:b.r(138),init:function(b,c){this.coverModule=b,this.inputWorker=this.createComponent(a,c),this.initEvent()},initEvent:function(){this.coverModule.onmousedown(this,this.onmousedown),this.coverModule.ondblclick(this,this.ondblclick)},onmousedown:function(a,b){var c=this.rs("c.struct"),d=c.getGrid();this.rs("c.range.focus",d.rowMap[a],d.colMap[b])},ondblclick:function(){this.inputWorker.toActive()}});return c.deps=["cover","selection"],c}},b[203]={value:function(){var a=30,c=8,d=b.r(14).border.width;return{resize:function(){if(this.resizable){this.sizePanel.style.width="",this.sizePanel.innerHTML=this.inputNode.innerHTML;var b=this.rect,d=this.sizePanel.getBoundingClientRect(),e=b.width,f=b.height;d.width+c+a>=b.width&&(e=this.calculateNewWidth(b,d),this.sizePanel.style.width=e-c+"px",d=this.sizePanel.getBoundingClientRect()),d.height+c>=b.height&&(f=this.calculateNewHeight(b,d),f=f.height),(f!==b.height||e!==b.width)&&(this.rect.width=e,this.rect.height=f,this.$wrapNode.css({width:e,height:f}))}},calculateNewWidth:function(a,b){var e=this.rs("c.struct"),f=e.getGrid(),g=e.getBoundary(),h=f.cMap[this.activeCell.col],i=f.viewWidth,j=b.width+c;if(j+a.x>=g.width)return g.width-a.x;for(var k=h,l=i[h]+2*d;;){if(k++,void 0===f.colMap[k])return g.width-a.x;if(l+=i[k]+d,l>j)break}return l+c+a.x>=g.width?g.width-a.x:l},calculateNewHeight:function(a,b){var e=this.rs("c.struct"),f=e.getGrid(),g=e.getBoundary(),h=f.rMap[this.activeCell.row],i=f.viewHeight,j=b.height+c;if(j+a.y>=g.height)return{overflow:!0,height:g.height-a.y};for(var k=h,l=i[h]+2*d;;){if(k++,void 0===f.rowMap[k])return{overflow:!0,height:g.height-a.y};if(l+=i[k]+d,l>j)break}return l+c+a.y>=g.height?{overflow:!0,height:g.height-a.y}:{overflow:!1,height:l}}}}},b[204]={value:{newline:function(){var a=this.selectionObj,b=this.placeholderNode.cloneNode(!1),c=a.getRangeAt(0);c=c.cloneRange(),c.deleteContents(),c.insertNode(b),c.insertNode(this.createElement("br")),c.selectNode(b),c.collapse(!0),a.removeAllRanges(),a.addRange(c),this.inputNode.scrollTop=1e8},focusToEnd:function(){var a=this.selectionObj,b=a.getRangeAt(0);b=b.cloneRange(),b.selectNodeContents(this.inputNode),b.collapse(!1),a.removeAllRanges(),a.addRange(b),this.inputNode.scrollTop=1e8},getContent:function(){return this.inputNode.innerText.replace(/\uFEFF/g,"")},__insertText:function(a){var b=this.selectionObj,c=b.getRangeAt(0),d=this.doc.createTextNode(a);c=c.cloneRange(),c.deleteContents(),c.insertNode(d),c.collapse(!1),b.removeAllRanges(),b.addRange(c),this.inputNode.scrollTop=1e8}}},b[205]={value:function(){function a(a,b,c){var d=b.row,e=b.col,h=c.row,i=c.col,j=a.getGrid(),k=j.viewHeight,l=j.viewWidth,m=j.viewColPoints,n=j.viewRowPoints,o=j.rMap,p=j.cMap,q=j.rowMap,r=j.colMap,s={borderTopStyle:"solid",borderLeftStyle:"solid",borderRightStyle:"solid",borderBottomStyle:"solid",x:0,y:0,top:0,left:0,width:0,height:0},t=q[0],u=r[0],v=q[q.length-1],w=r[r.length-1];if(d>v)return null;if(t>h)return null;if(e>w)return null;if(u>i)return null;for(var x,y,z=-1,A=-1,B=!1,C=!1,D=d;h>=D;D++)x=o[D],void 0!==x&&(C||(C=!0,s.y=n[x]-g),A+=k[x]+f);if(-1===A)return null;for(var D=e;i>=D;D++)y=p[D],void 0!==y&&(B||(B=!0,s.x=m[y]-g),z+=l[y]+f);return-1===z?null:(s.top=s.y,s.left=s.x,s.width=z+2*f,s.height=A+2*f,(t>d||d>v)&&(s.borderTopStyle="none"),(t>h||h>v)&&(s.borderBottomStyle="none"),(u>e||e>w)&&(s.borderLeftStyle="none"),(u>i||i>w)&&(s.borderRightStyle="none"),s)}function c(a,b,c){var d=a.getGrid(),e=d.cMap,h=d.viewColPoints;return b=e[b],c=e[c],{x:h[b]-g,width:h[c+1]-h[b]+f}}function d(a,b,c){var d=a.getGrid(),e=d.rMap,h=d.viewRowPoints;return b=e[b],c=e[c],{y:h[b]-g,height:h[c+1]-h[b]+f}}var e=b.r(14),f=e.border.width,g=e.border.offset,h={getMergeCellVisibleRect:function(b,c){return a(b,c.start,c.end)},getSelectionRect:function(b,c,d){for(var e,f=Math.min(c.row,d.row),g=Math.min(c.col,d.col),i=Math.max(c.row,d.row),j=Math.max(c.col,d.col),k=g;j>=k;k++)if(e=b.getMergeCell(f,k),e&&!(e.start.row>=f))return h.getSelectionRect(b,{row:e.start.row,col:g},{row:i,col:j});for(var k=g;j>=k;k++)if(e=b.getMergeCell(i,k),e&&!(e.end.row<=i))return h.getSelectionRect(b,{row:f,col:g},{row:e.end.row,col:j});for(var k=f;i>=k;k++)if(e=b.getMergeCell(k,g),e&&!(e.start.col>=g))return h.getSelectionRect(b,{row:f,col:e.start.col},{row:i,col:j});for(var k=f;i>=k;k++)if(e=b.getMergeCell(k,j),e&&!(e.end.col<=j))return h.getSelectionRect(b,{row:f,col:g},{row:i,col:e.end.col});var l=b.getPane();return-1!==l.row||-1!==l.col?a(b,{row:f,col:g},{row:i,col:j}):this.getRect(b,{row:f,col:g},{row:i,col:j})},getRect:function(a,b,e){var f=b.row,g=b.col,h=e.row,i=e.col,j=a.getViewStart(),k=a.getViewEnd(),l=j.row,m=j.col,n=k.row,o=k.col;if(f>n||l>h)return null;if(g>o||m>i)return null;var p={borderTopStyle:"solid",borderLeftStyle:"solid",borderRightStyle:"solid",borderBottomStyle:"solid",x:0,y:0,top:0,left:0,width:0,height:0};f>=l?l=f:p.borderTopStyle="none",n>=h?n=h:p.borderBottomStyle="none",g>=m?m=g:p.borderLeftStyle="none",o>=i?o=i:p.borderRightStyle="none";var q=c(a,m,o),r=d(a,l,n);return p.x=q.x,p.left=q.x,p.width=q.width,p.y=r.y,p.top=r.y,p.height=r.height,p}};return h}},b[206]={value:{checkView:function(){var a,b,c=this.rs("c.struct"),d=c.getGrid(),e=d.rowMap,f=d.colMap,g=this.activeCell,h=g.row,i=g.col,j=c.getMergeCell(h,i),k=c.getSpace(),l={};j?(h=j.start.row,i=j.start.col,h<e[0]?l.rowTo=h:h>=e[e.length-1]?(b=this.cs("c.rows.height",c,j.start.row,j.end.row),b>k.height?l.rowTo=j.start.row:l.rowToEnd=j.end.row):l.row=0,i<f[0]?l.columnTo=i:i>=f[f.length-1]?(a=this.cs("c.columns.width",c,j.start.col,j.end.col),a>k.width?l.columnTo=j.start.col:l.columnToEnd=j.end.col):l.column=0):(h<e[0]?l.rowTo=h:h>=e[e.length-1]?l.rowToEnd=h:l.row=0,i<f[0]?l.columnTo=i:i>=f[f.length-1]?l.columnToEnd=i:l.column=0),this.execCommand("updateview",l);var m=this.rs("c.range"),n=m.getFocus();this.resetInput(n.row,n.col,!0)}}},b[207]={value:{keyEnter:function(a){if(a.preventDefault(),!this.rs("c.is.readonly")){if((a.metaKey||a.altKey)&&this.writeModel)return this.newline(),void this.resize();if(!this.writeModel)return this.shortcutWriteModel=!1,void this.__toActive();this.write(),this.toInactive()}a.shiftKey?this.execCommand("moveup",1):this.execCommand("movedown",1)},keyLeft:function(a){(!this.writeModel||this.shortcutWriteModel)&&(a.preventDefault(),a.shiftKey?this.execCommand("expandleft",1):this.execCommand("moveleft",1))},keyRight:function(a){(!this.writeModel||this.shortcutWriteModel)&&(a.preventDefault(),a.shiftKey?this.execCommand("expandright",1):this.execCommand("moveright",1))},keyUp:function(a){(!this.writeModel||this.shortcutWriteModel)&&(a.preventDefault(),a.shiftKey?this.execCommand("expandup",1):this.execCommand("moveup",1))},keyDown:function(a){(!this.writeModel||this.shortcutWriteModel)&&(a.preventDefault(),a.shiftKey?this.execCommand("expanddown",1):this.execCommand("movedown",1))},keyTab:function(a){a.preventDefault(),a.shiftKey?this.execCommand("moveleft",1):this.execCommand("moveright",1)},keyEsc:function(a){a.preventDefault(),this.writeModel&&this.toInactive()},keyDelete:function(a){this.writeModel||(a.preventDefault(),this.execCommand("clearcontent"))}}},b[208]={value:function(){var a=b.r(2),c=b.r(14),d=c.border.offset,e=c.border.width,f=b.r(198),g=c.CANDIDATE_FONT,h=b.r(205);return b.r(0).create("InputWorker",a.extend({inputNode:null,$inputNode:null,wrapNode:null,$wrapNode:null,sizePanel:null,$sizePanel:null,inputBox:null,labelNode:null,$labelNode:null,selectionObj:null,doc:null,placeholderNode:null,timer:null,selectionModule:null,writeModel:!1,shortcutWriteModel:!0,contentchanged:!1,resizable:!0,failedState:!1,labelVisible:!1,rect:null,activeCell:null,base:b.r(135),init:function(b){this.doc=this.getDocument(),this.selectionModule=b,this.placeholderNode=this.doc.createTextNode(""),this.selectionObj=this.doc.defaultView.getSelection(),this.wrapNode=this.__createWrapNode(),this.$wrapNode=a(this.wrapNode),this.inputBox=this.__createInputBox(),this.labelNode=this.__createLabelNode(),this.$labelNode=a(this.labelNode),this.inputNode=this.__createInput(),this.$inputNode=a(this.inputNode),this.sizePanel=this.__createSizepanel(),this.$sizePanel=a(this.sizePanel),this.wrapNode.appendChild(this.labelNode),this.wrapNode.appendChild(this.inputBox),this.inputBox.appendChild(this.inputNode),this.getContentContainer().appendChild(this.wrapNode),this.getContentContainer().appendChild(this.sizePanel),this.initEvent(),this.initService(),this.initMessageHook(),this.clearInput()},initMessageHook:function(){this.onMessage({"c.range.change":this.rangeChange,"c.refresh":this.change,"c.view.change":this.viewChange})},initService:function(){this.registerService({"s.input.inserttext":this.insertText})},initEvent:function(){var b=this;this.$inputNode.on("blur",function(){b.write(),b.toInactive(),b.toDisableWriteModel()}).on("input",function(){b.selectionModule.stop(),b.contentchanged=!0,b.writeModel||b.__toActive(!1),b.resize()}).on("keydown",function(a){if(!b.writeModel&&(a.ctrlKey||a.metaKey)&&65===a.keyCode)return a.preventDefault(),a.stopPropagation(),void b.execCommand("selectall");switch(a.stopPropagation(),a.keyCode){case f.ENTER:b.keyEnter(a);break;case f.LEFT:b.keyLeft(a);break;case f.RIGHT:b.keyRight(a);break;case f.UP:b.keyUp(a);break;case f.DOWN:b.keyDown(a);break;case f.TAB:b.keyTab(a);break;case f.ESC:b.keyEsc(a);break;case f.DELETE:case f.BACKSPACE:b.keyDelete(a)}}).on("mousedown contextmenu mousewheel DOMMouseScroll",function(a){a.stopPropagation()}),this.$wrapNode.on("mousedown",function(a){a.stopPropagation(),a.preventDefault()}),a(this.getMainContainer()).on("contextmenu",function(a){a.preventDefault(),a.stopPropagation()})},rangeChange:function(){this.write(),this.toInactive(),this.change()},change:function(){var a=this.rs("c.range");if(!a.isValid())return void this.disable();a.isWritable()||this.addFailedState(),this.focus();var b=a.getFocus();this.resetInput(b.row,b.col)},toActive:function(){this.rs("c.is.readonly")||(this.shortcutWriteModel=!1,this.__toActive())},insertText:function(a){this.writeModel&&(this.__insertText(a),this.resize())},__toActive:function(a){if(!this.writeModel){var b=this.rs("c.range"),c=b.getFocus();this.writeModel=!0,this.activeCell={row:c.row,col:c.col},this.$wrapNode.addClass("btb-input-active"),this.updateStyle(),a!==!1&&this.resetContent(),this.postMessage("s.input.active"),this.checkView(),this.resize()}},toInactive:function(){if(this.removeFailedState(),this.writeModel){this.activeCell=null,this.writeModel=!1,this.shortcutWriteModel=!0,this.$wrapNode.removeClass("btb-input-active"),this.clearInput(),this.contentchanged=!1,this.resetLabel(),this.postMessage("s.input.inactive");var a=this.rs("c.range");if(!a.isValid())return void this.hide();var b=a.getFocus();this.resetInput(b.row,b.col)}},toDisableWriteModel:function(){this.rs("c.range.disable")
},addFailedState:function(){this.failedState||(this.failedState=!0,this.$wrapNode.addClass("btb-input-failed"),this.selectionModule.addFailedState())},removeFailedState:function(){this.failedState&&(this.failedState=!1,this.$wrapNode.removeClass("btb-input-failed"),this.selectionModule.removeFailedState())},write:function(){if(!this.contentchanged)return!1;this.contentchanged=!1;var a=this.getContent();this.execCommand("write",a,this.activeCell.row,this.activeCell.col)},updateStyle:function(){var a=this.rs("c.struct"),b=this.activeCell,c=a.getRawStyle("fonts",b.row,b.col),d=a.getRawStyle("fills",b.row,b.col),e=a.getRawStyle("alignments",b.row,b.col),f={fontFamily:c.name+","+g,fontSize:c.size+"px",color:c.color,fontStyle:c.italic?"italic":"normal",fontWeight:c.bold?"bold":"normal",background:d.fill,textAlign:e.horizontal};this.$inputNode.css(f),this.$sizePanel.css(f)},resetContent:function(){var a=this.rs("c.struct"),b=this.activeCell,c=a.getStandardValue(b.row,b.col);c&&(this.inputNode.innerHTML=c,this.resize(),this.focusToEnd())},viewChange:function(){if(this.writeModel&&!this.labelVisible){var a=this.rs("c.range"),b=a.getFocus();this.labelVisible=!0,this.labelNode.innerHTML=this.cs("c.title.index2char",b.col)+(b.row+1),this.$labelNode.show()}},resetLabel:function(){this.labelVisible&&(this.labelVisible=!1,this.$labelNode.hide())},clearInput:function(){this.$inputNode.html("&#xFEFF;")},enable:function(){this.show()},disable:function(){null!==this.timer&&(clearTimeout(this.timer),this.timer=null),this.hide(),this.inputNode.blur()},show:function(){this.$wrapNode.css("display","")},hide:function(){this.writeModel||this.$wrapNode.css({top:-1e4,left:-1e4})},focus:function(){var a=this,b=this.inputNode,c=this.timer;null!==c&&clearTimeout(c),this.timer=setTimeout(function(){b.focus(),a.timer=null},50)},resetInput:function(a,b,c){if(!this.writeModel||c){var d,e,f=this.rs("c.struct"),g=f.getMergeCell(a,b),h=f.getGrid();g?(this.resizable=!1,this.__resetMergeCellInput(g)):(d=h.rMap[a],e=h.cMap[b],void 0===d||void 0===e?this.hide():(this.resizable=!0,this.__resetNormalInput(d,e)))}},__resetMergeCellInput:function(a){var b=this.rs("c.struct"),c=h.getMergeCellVisibleRect(b,a);return c?(this.$wrapNode.css(c),void(this.rect=c)):void this.hide()},__resetNormalInput:function(a,b){var c=this.rs("c.struct"),f=c.getGrid(),g=f.viewColPoints[b]-d,h=f.viewRowPoints[a]-d,i=f.viewWidth[b]+2*e,j=f.viewHeight[a]+2*e;this.wrapNode.style.cssText="",this.$wrapNode.css({top:h,left:g,width:i,height:j}),this.rect={x:g,y:h,width:i,height:j}},__createInput:function(){return this.createElement("div",{attr:{"class":"btb-s-input",contenteditable:!0,spellcheck:!1}})},__createWrapNode:function(){return this.createElement("div","btb-s-input-wrap")},__createInputBox:function(){return this.createElement("div","btb-s-input-box")},__createLabelNode:function(){return this.createElement("div","btb-s-input-label")},__createSizepanel:function(){return this.createElement("div","btb-s-input-size-panel")}},b.r(207),b.r(203),b.r(204),b.r(206)))}},b[209]={value:function(){return b.r(0).create("Position",{reference:null,base:b.r(138),init:function(){this.reference=this.getContentContainer()},toIndex:function(a,b){var c=this.getLocation(),d=this.rs("c.struct"),e=d.getGrid(),f=d.getVisibleCount(),g=e.viewColPoints,h=e.viewRowPoints,i={row:-1,col:-1},j=!1;a-=c.left,b-=c.top;for(var k=1,l=h.length;l>=k;k++)if(b<h[k]){i.row=k-1,j=!0;break}j||(i.row=f.row-1),j=!1;for(var k=1,l=g.length;l>=k;k++)if(a<g[k]){i.col=k-1,j=!0;break}return j||(i.col=f.col-1),i},getDirection:function(a,b){var c=this.getLocation(),d=!1,e=!1,f=!1,g=!1;return c.right<=a&&(d=!0),c.bottom<=b&&(g=!0),c.top>=b&&(f=!0),c.left>=a&&(e=!0),d&&g?"right-bottom":d&&f?"right-top":e&&f?"left-top":e&&g?"left-bottom":d?"right":g?"bottom":e?"left":f?"top":void 0},getLocation:function(){return this.reference.getBoundingClientRect()}})}},b[210]={value:function(){var a=b.r(2),c=5;return b.r(0).create("Resize",{base:b.r(138),wrapper:null,templateColumnNode:null,templateRowNode:null,colBtns:[],rowBtns:[],rowState:!1,columnState:!1,init:function(){this.wrapper=this.createElement("div","btb-resize-wrap"),this.initTemplateNode(),this.initEvent(),this.initMessageHook()},run:function(){this.getMainContainer().appendChild(this.wrapper)},initTemplateNode:function(){var a=this.getConfig("head"),b=this.rs("c.struct").getBorderWidth();this.templateColumnNode=this.createElement("div",{attr:{"class":"btb-resize-btn btb-resize-column-btn"},style:{height:a.height+b},inner:'<div class="btb-resize-line btb-resize-column-line"></div>'}),this.templateRowNode=this.createElement("div",{attr:{"class":"btb-resize-btn btb-resize-row-btn"},style:{width:a.width+b},inner:'<div class="btb-resize-line btb-resize-row-line"></div>'})},initMessageHook:function(){this.onMessage({"c.refresh":this.cleanState})},initEvent:function(){var b=this;a(this.wrapper).delegate(".btb-resize-column-btn","mousedown",function(a){a.preventDefault(),a.stopPropagation(),b.startResizeColumn(this,a.clientX,a.clientY)}).delegate(".btb-resize-row-btn","mousedown",function(a){a.preventDefault(),a.stopPropagation(),b.startResizeRow(this,a.clientX,a.clientY)}),a(this.getTopContainer()).on("mouseenter",function(){b.updateColResizeBtn()}),a(this.getLeftContainer()).on("mouseenter",function(){b.updateRowResizeBtn()})},cleanState:function(){this.columnState=!1,this.rowState=!1},startResizeColumn:function(b,d){var e,f,g=this,h=a(b),i=this.rs("c.struct"),j=i.getGrid(),k=j.col,l=i.getOffset(),m=i.getBorderWidth(),n=+b.getAttribute("data-index"),o=i.getSpace().width-c-m,p=k[0]+l-3,q=this.getConfig("head").width,r=j.colMap,s=k[n+1]-l-2,t=!1;h.addClass("btb-resizing"),a(this.getDocument()).on("mousemove.resize",function(a){var b=a.clientX-d;t=!0,f=s+b,f=Math.min(f,o),f=Math.max(f,p),h.css("left",q+f)}).one("mouseup.resize",function(){h.removeClass("btb-resizing"),a(this).off("mousemove.resize"),t&&(e=f-(k[n]-l-2),0>e&&(e=0),g.execCommand("resizecol",e,r[n]))})},startResizeRow:function(b,d,e){var f,g,h=this,i=a(b),j=this.rs("c.struct"),k=j.getGrid(),l=k.viewRowPoints,m=j.getOffset(),n=j.getBorderWidth(),o=+b.getAttribute("data-index"),p=j.getSpace().height-c-n,q=l[o]+m-3,r=this.getConfig("head").height,s=k.rowMap,t=l[o+1]-m-2,u=!1;i.addClass("btb-resizing"),a(this.getDocument()).on("mousemove.resize",function(a){var b=a.clientY-e;u=!0,f=t+b,f=Math.min(f,p),f=Math.max(f,q),i.css("top",r+f)}).one("mouseup.resize",function(){i.removeClass("btb-resizing"),a(this).off("mousemove.resize"),u&&(g=f-(l[o]-m-2),0>g&&(g=0),h.execCommand("resizerow",g,s[o]))})},updateColResizeBtn:function(){if(!this.columnState){this.columnState=!0;for(var a=this.getConfig("head"),b=this.rs("c.struct"),c=b.getGrid(),d=b.getVisibleCount(),e=b.getOffset(),f=c.viewColPoints,g=this.getColBtns(d.col),h=0,i=d.col;i>h;h++)g[h].style.left=a.width+f[h+1]-2-e+"px"}},getColBtns:function(a){var b,c=this.colBtns,d=this.wrapper;if(c.length<a)for(var e=0,f=a-c.length;f>e;e++)b=this.templateColumnNode.cloneNode(!0),c.push(b),d.appendChild(b),b.setAttribute("data-index",c.length-1);else for(var e=a,f=c.length;f>e;e++)c[e].style.display="none";return c},updateRowResizeBtn:function(){if(!this.rowState){this.rowState=!0;for(var a=this.getConfig("head"),b=this.rs("c.struct"),c=b.getGrid(),d=b.getVisibleCount(),e=b.getOffset(),f=c.viewRowPoints,g=this.getRowBtns(d.row),h=1,i=d.row;i>h;h++)g[h-1].style.top=a.height+f[h]-2-e+"px"}},getRowBtns:function(a){var b,c=this.rowBtns,d=this.wrapper;if(c.length<a)for(var e=0,f=a-c.length;f>e;e++)b=this.templateRowNode.cloneNode(!0),c.push(b),d.appendChild(b),b.setAttribute("data-index",c.length-1);else for(var e=a,f=c.length;f>e;e++)c[e].style.display="none";return c}})}},b[211]={value:function(){var a=b.r(2),c=b.r(0).create("RowColumnSelector",{position:null,base:b.r(138),init:function(b){this.position=b;var c=this;a(this.getTopContainer()).on("click",function(a){c.selectColumn(a.clientX)}),a(this.getLeftContainer()).on("click",function(a){c.selectRow(a.clientY)})},selectColumn:function(a){var b=this.position.toIndex(a,0),c=this.rs("c.struct"),d=c.getGrid();this.execCommand("selectcolumn",d.colMap[b.col])},selectRow:function(a){var b=this.position.toIndex(0,a),c=this.rs("c.struct"),d=c.getGrid();this.execCommand("selectrow",d.rowMap[b.row])}});return c.deps=["position"],c}},b[212]={value:function(){var a=b.r(224),c=b.r(218);return b.r(0).create("BodyScreen",{panel:null,width:0,height:0,canvas:null,visiableCanvas:null,base:b.r(135),init:function(){this.panel=this.createElement("div","btb-body-screen"),this.canvas=new a(this.getDocument(),this.width,this.height),this.visiableCanvas=new a(this.getDocument(),this.width,this.height),this.contentCanvas=new a(this.getDocument(),this.width,this.height)},appendTo:function(a){a.appendChild(this.panel)},resize:function(a,b){this.width=a,this.height=b,this.canvas.resize(a,b,this.getConfig("ZOOM")),this.visiableCanvas.resize(a,b,this.getConfig("ZOOM")),this.contentCanvas.resize(a,b,this.getConfig("ZOOM"))},clear:function(){this.canvas.clear(),this.visiableCanvas.clear(),this.contentCanvas.clear()},render:function(){var a=this.rs("c.struct");c.draw(this.canvas,this.contentCanvas,a),this.__toggle()},__toggle:function(){this.visiableCanvas.remove(),this.canvas.appendTo(this.panel);var a=this.visiableCanvas;this.visiableCanvas=this.canvas,this.canvas=a}})}},b[213]={value:function(){function a(a){for(var b,c,d=a.getViewStart(),e=a.getViewEnd(),f={},g=[],h=[],i=d.row,j=e.row;j>=i;i++){h=[],g.push(h);for(var k=d.col,l=e.col;l>=k;k++)if(b=a.getMergeCell(i,k)){if(c=b.start.row+","+b.start.col,f[c]){h.push({type:"cellunit"});continue}f[c]=!0,h.push({type:"mergecell",row:i,col:k,mergeCell:b,userStyle:a.getUserStyle(b.start.row,b.start.col)})}else h.push({type:"cell",row:i,col:k,userStyle:a.getUserStyle(i,k)})}return g}function b(a,b){for(var c,d,e,f=[],g=0,h=b.length;h>g;g++){c=b[g],e=[],f.push(e);for(var i=0,j=c.length;j>i;i++)d=c[i],"cellunit"!==d.type&&(e[i]=d.userStyle.wraptext?"mergecell"===d.type?a.getDisplayWrapText(d.mergeCell.start.row,d.mergeCell.start.col):a.getDisplayWrapText(d.row,d.col):"mergecell"===d.type?a.getDisplayValue(d.mergeCell.start.row,d.mergeCell.start.col,!1):a.getDisplayValue(d.row,d.col,!1))}return f}function c(a,b,c){for(var d,e,f,g,h,i,j,k,l=[],m=0,n=b.length;n>m;m++){d=b[m],e=c[m],g=0,i=[],l[m]=i,j=null;for(var o=0,p=d.length;p>o;o++){if(f=d[o],h=e[o],"cell"===f.type)h?(j&&"cell"===j.type&&(j.right=g),k=a.getComputedStyle(f.row,f.col),j={type:"cell",wraptext:!!k.wraptext,left:g,row:f.row,col:f.col,content:h,style:k},g=0,i.push(j)):g++;else{if(j&&"cell"===j.type&&(j.right=g,j=null),g=0,"cellunit"===f.type)continue;i.push({type:"mergecell",row:f.row,col:f.col,mergeCell:f.mergeCell,content:h,style:a.getComputedStyle(f.mergeCell.start.row,f.mergeCell.start.col)})}j&&"cell"===j.type&&(j.right=g)}}return l}return{generate:function(d){var e=a(d),f=b(d,e);return{layout:c(d,e,f),cells:e}}}}},b[214]={value:function(){function a(a,b,d,e){for(var f,g,h,i=b.getGrid(),j=i.rowMap,k=i.colMap,l=[],m=d.startRow,n=d.endRow;n>=m;m++)if(g=j[m],void 0!==g)for(var o=d.startCol,p=d.endCol;p>=o;o++)h=k[o],void 0!==h&&(f=b.getBorder(g,h),f&&l.push({r:m,c:o,row:g,col:h,border:f}));c(a,b,l,e)}function c(a,b,c,f){for(var g,h,i=0,j=c.length;j>i;i++)g=c[i],h=b.getMergeCell(g.row,g.col),h?e(a,b,g,h):d(a,b,g.border,g.r,g.c,f)}function d(a,b,c,d,e,h){var i,j,k=b.getStyleById("borders",c).border,l=b.getGrid(),m=l.viewWidth[e]+n,p=l.viewHeight[d]+n;k.top!==o&&(i=l.viewColPoints[e],j=l.viewRowPoints[d],f(a,k.top,i,j,m)),k.right===o||h[d+","+(e+1)]||(i=l.viewColPoints[e+1],j=l.viewRowPoints[d],g(a,k.right,i,j,p)),k.left===o||h[d+","+e]||(i=l.viewColPoints[e],j=l.viewRowPoints[d],g(a,k.left,i,j,p)),k.bottom!==o&&(i=l.viewColPoints[e],j=l.viewRowPoints[d+1],f(a,k.bottom,i,j,m))}function e(a,b,c,d){var e,h,i=c.r,j=c.c,k=c.row,l=c.col,m=b.getStyleById("borders",c.border).border,p=b.getGrid(),q=p.viewWidth[j]+n,r=p.viewHeight[i]+n,s=d.start.row,t=d.start.col,u=d.end.row,v=d.end.col;k===s&&m.top!==o&&(e=p.viewColPoints[j],h=p.viewRowPoints[i],f(a,m.top,e,h,q)),l===v&&m.right!==o&&(e=p.viewColPoints[j+1],h=p.viewRowPoints[i],g(a,m.right,e,h,r)),l===t&&m.left!==o&&(e=p.viewColPoints[j],h=p.viewRowPoints[i],g(a,m.left,e,h,r)),k===u&&m.bottom!==o&&(e=p.viewColPoints[j],h=p.viewRowPoints[i+1],f(a,m.bottom,e,h,q))}function f(a,b,c,d,e){function f(){a.strokeStyle(b.color),a.beginPath(),a.moveTo(c,d),a.lineTo(c+e,d),a.stroke()}function g(){var f=0;for(a.strokeStyle(k),a.beginPath(),a.moveTo(c,d),a.lineTo(c+e,d),a.stroke(),a.strokeStyle(b.color),a.beginPath();;){if(f>=e)break;a.moveTo(f+c,d),f+=h[0],a.lineTo(Math.min(f,e)+c,d),f+=h[1]}a.stroke()}c-=l;var h=i[b.style];0===h?f():g()}function g(a,b,c,d,e){function f(){a.strokeStyle(b.color),a.beginPath(),a.moveTo(c,d),a.lineTo(c,d+e),a.stroke()}function g(){var f=0;for(a.strokeStyle(k),a.beginPath(),a.moveTo(c,d),a.lineTo(c,d+e),a.stroke(),a.strokeStyle(b.color),a.beginPath();;){if(f>=e)break;a.moveTo(c,d+f),f+=h[0],a.lineTo(c,d+Math.min(f,e)),f+=h[1]}a.stroke()}d-=l;var h=i[b.style];0===h?f():g()}var h=b.r(14),i={thin:0,dashed:[5,3],dotted:[1,1]},j=b.r(14),k=h.canvas.background,l=j.border.offset,m=j.border.width,n=2*m,o=b.r(118);return{draw:function(b,c,d,e){var f;if(1===d.length)return void a(b,c,d[0],e[0]);for(var g=0,h=d.length;h>g;g++)f=d[g],b.save(),b.beginPath(),b.rect(f.x,f.y,f.width,f.height),b.clip(),a(b,c,f,e[g]),b.restore()}}}},b[215]={value:function(){var a=b.r(14).border;return{draw:function(b,c){var d=a.offset,e=c.getBoundary(),f=c.getSpace();b.save(),b.strokeStyle(a.color),b.lineWidth(a.width),b.beginPath(),b.moveTo(d,0),b.lineTo(d,e.height),b.moveTo(0,d),b.lineTo(e.width,d),b.moveTo(0,f.height-d),b.lineTo(f.width,f.height-d),b.moveTo(f.width-d,0),b.lineTo(f.width-d,f.height),b.stroke(),b.restore()}}}},b[216]={value:function(){var a=b.r(14),c=a.canvas.background;return{draw:function(b,d){b.save(),b.globalCompositeOperation("destination-over");var e=d.getGrid(),f=e.viewColPoints,g=e.viewRowPoints,h=d.getBoundary();b.lineWidth(1),b.strokeStyle(a.border.color),b.beginPath();for(var i=0,j=f.length;j>i;i++)b.moveTo(f[i],0),b.lineTo(f[i],h.height);for(var i=0,j=g.length;j>i;i++)b.moveTo(0,g[i]),b.lineTo(h.width,g[i]);b.stroke(),b.fillStyle(c),b.fillRect(0,0,h.width,h.height),b.restore()}}}},b[217]={value:function(){var a=b.r(14),c=a.border.offset;return{draw:function(b,d){var e=d.getPane();if(-1!==e.rowIndex||-1!==e.colIndex){var f,g,h=d.getGrid(),i=d.getBoundary(),j=h.spaceOffset;b.save(),b.beginPath(),b.strokeStyle(a.PANE_LINE_COLOR),-1!==e.row&&(g=j.row+c,b.moveTo(0,g),b.lineTo(i.width,g)),-1!==e.col&&(f=j.col+c,b.moveTo(f,0),b.lineTo(f,i.height)),b.stroke(),b.restore()}}}}},b[218]={value:function(){var a=b.r(221),c=b.r(222),d=b.r(223),e=b.r(219),f=b.r(220),g=b.r(216),h=b.r(214),i=b.r(215),j=b.r(217);return{draw:function(b,k,l){var m=c.draw(k,l),n=m.regions,o=m.layout,p=m.overflow;f.draw(k,b,l),a.draw(b,o),e.draw(b,l,n),h.draw(b,l,n,p),g.draw(b,l),d.draw(b,l,n),b.drawImage(k.getImage(),0,0,b.width,b.height),i.draw(b,l),j.draw(b,l)}}}},b[219]={value:function(){function a(a,b,e){for(var f,g=d(b,e),h=0,i=g.length;i>h;h++){f=g[h];for(var j=0,k=f.length;k>j;j++)c(a,b,f[j])}}function c(a,b,c){var d=b.getStyleById("fills",c.fillId).fill;d!==i&&(a.fillStyle(d),a.fillRect(c.x,c.y,c.w,c.h))}function d(a,b){for(var c,d,e,i,j,k=a.getGrid(),l=k.viewRowPoints,m=k.viewColPoints,n=k.viewWidth,o=k.viewHeight,p=[],q=0,r=a.getStyleIds("fills",{row:k.rowMap[b.startRow],col:k.colMap[b.startCol]},{row:k.rowMap[b.endRow],col:k.colMap[b.endCol]}),s=b.startRow,t=b.endRow;t>=s;s++,q++){c=[],d=-1,j=0;for(var u=b.startCol,v=b.endCol;v>=u;u++,j++)e=r[q][j],e?(d===e?(i=c[c.length-1],i.w+=n[u]+g):c.push({x:m[u]-f,y:l[s]-f,w:n[u]+h,h:o[s]+h,fillId:e}),d=e):d=-1;p.push(c)}return p}var e=b.r(14),f=e.border.offset,g=e.border.width,h=2*g,i=(e.border.width,b.r(228),b.r(118));return{draw:function(b,c,d){var e;if(1===d.length)return void a(b,c,d[0]);for(var f=0,g=d.length;g>f;f++)e=d[f],b.save(),b.beginPath(),b.rect(e.x,e.y,e.width,e.height),b.clip(),a(b,c,e),b.restore()}}}},b[220]={value:function(){function a(a){return a.save(),a.beginPath(),a.moveTo(0,0),a.lineTo(e,0),a.lineTo(e,e),a.closePath(),a.fillStyle(c.COMMENTS_ICON_COLOR),a.fill(),a.restore(),a.getImageData(0,0,e,e)}var c=b.r(14),d=c.border.offset,e=7;return{draw:function(b,c,f){var g,h,i,j,k,l,m,n=f.getCommentsInView(),o=f.getGrid(),p=o.viewRowPoints,q=o.viewColPoints,r=o.rMap,s=o.cMap;for(var t in n)n.hasOwnProperty(t)&&(h=n[t],j=h.row,k=h.col,i=f.getMergeCell(j,k),i&&(j=i.end.row,k=i.end.col),l=r[j],m=s[k],void 0!==l&&void 0!==m&&(g||(g=a(c)),b.putImageData(g,q[m+1]-d-e,p[l]+d)));c.clear()}}}},b[221]={value:function(){function a(a,b){var c,d,g,h,i,j;for(var k in b){c=b[k];for(var l=0,m=c.length;m>l;l++)d=c[l],g=d.regionX-e,h=d.regionY-e,i=d.regionWidth+f,j=d.regionHeight+f,a.fillRect(g,h,i,j)}}var c=b.r(14),d=c.canvas.background,e=c.CONTENT_PADDING,f=2*e;return{draw:function(b,c){b.fillStyle(d);for(var e=0,f=c.length;f>e;e++)a(b,c[e])}}}},b[222]={value:function(){function a(a){var b=a.getPane(),e=a.getViewStart(),h=e.row,i=e.col,j=a.getVisibleCount();return-1===b.row&&-1===b.col?c(a,j):-1!==b.row&&-1===b.col?f(a,b,j):-1===b.row&&-1!==b.col?g(a,b,j):0===i?f(a,b,j):0===h?g(a,b,j):d(a,b,j)}function c(a,b){var c=a.getBoundary(),d=0,e=0,f=b.row-1,g=b.col-1,h={regions:[],layout:[]};return h.layout.push(o(a,{r:d,c:e},{r:f,c:g})),h.regions.push({startRow:d,startCol:e,endRow:f,endCol:g,x:0,y:0,width:c.width,height:c.height}),h}function d(a,b,c){var d=[],e=[],f=[];f.push(h(a,b)),f.push(i(a,b,c)),f.push(j(a,b,c)),f.push(k(a,b,c));for(var g=0,l=f.length;l>g;g++)d.push(f[g].region),e.push(f[g].layout);return{regions:d,layout:e}}function e(a,b,c){var d,e,f,g=p(a,b,c),h=g.layout;for(var i in h)if(h.hasOwnProperty(i)){d=h[i],f=d[0].font,a.fillStyle(f.color),a.strokeStyle(f.color),a.setFontStyle(f);for(var j=0,k=d.length;k>j;j++)e=d[j],a.save(),a.beginPath(),a.rect(e.regionX,e.regionY,e.regionWidth,e.regionHeight),a.clip(),l(a,e),a.restore()}return g}function f(a,b,c){var d=a.getGrid(),e=d.spaceOffset,f=a.getBoundary(),g=0,h=0,i=b.row,j=c.col-1,k={regions:[],layout:[]};return k.layout.push(o(a,{r:g,c:h},{r:i,c:j})),k.regions.push({startRow:g,startCol:h,endRow:i,endCol:j,x:0,y:0,width:f.width,height:e.row}),g=b.row+1,h=0,i=c.row-1,j=c.col-1,k.layout.push(o(a,{r:g,c:h},{r:i,c:j})),k.regions.push({startRow:g,startCol:h,endRow:i,endCol:j,x:0,y:e.row,width:f.width,height:f.height-e.row}),k}function g(a,b,c){var d=a.getGrid(),e=d.spaceOffset,f=a.getBoundary(),g={regions:[],layout:[]},h=0,i=0,j=c.row-1,k=b.col;return g.layout.push(o(a,{r:h,c:i},{r:j,c:k})),g.regions.push({startRow:h,startCol:i,endRow:j,endCol:k,x:0,y:0,width:e.col,height:f.height}),h=0,i=b.col+1,j=c.row-1,k=c.col-1,g.layout.push(o(a,{r:h,c:i},{r:j,c:k})),g.regions.push({startRow:h,startCol:i,endRow:j,endCol:k,x:e.col,y:0,width:f.width-e.col,height:f.height}),g}function h(a,b){var c=a.getGrid(),d=c.spaceOffset,e=0,f=0,g=b.row,h=b.col,i=o(a,{r:e,c:f},{r:g,c:h});return{layout:i,region:{startRow:e,startCol:f,endRow:g,endCol:h,x:0,y:0,width:d.col,height:d.row}}}function i(a,b,c){var d,e=a.getGrid(),f=a.getBoundary(),g=e.spaceOffset,h=0,i=b.col+1,j=b.row,k=c.col-1;return d=o(a,{r:h,c:i},{r:j,c:k}),{layout:d,region:{startRow:h,startCol:i,endRow:j,endCol:k,x:g.col,y:0,width:f.width-g.col,height:g.row}}}function j(a,b,c){var d,e=a.getGrid(),f=a.getBoundary(),g=e.spaceOffset,h=b.row+1,i=0,j=c.row-1,k=b.col;return d=o(a,{r:h,c:i},{r:j,c:k}),{layout:d,region:{startRow:h,startCol:i,endRow:j,endCol:k,x:0,y:g.row,width:g.col,height:f.height-g.row}}}function k(a,b,c){var d,e=a.getGrid(),f=a.getBoundary(),g=e.spaceOffset,h=b.row+1,i=b.col+1,j=c.row-1,k=c.col-1;return d=o(a,{r:h,c:i},{r:j,c:k}),{layout:d,region:{startRow:h,startCol:i,endRow:j,endCol:k,x:g.col,y:g.row,width:f.width-g.col,height:f.height-g.row}}}function l(a,b){var c=b.content.split("\n"),d=b.font,e=d.size,f=C,g=Math.floor(f*e);a.textBaseline("bottom"),a.textAlign(b.alignment.horizontal);var h,i=g*c.length,j=n(b.alignment.vertical,b.regionHeight,i),k=d.underline,l=d.throughline;j+=b.regionY;for(var o=0,p=c.length;p>o;o++)j+=g,a.fillText(c[o],b.textX,j),(k||l)&&(h=Math.ceil(a.measureText(c[o]).width),d.underline&&m(a,h,b.textX,j,b.alignment.horizontal,0),l&&m(a,h,b.textX,j,b.alignment.horizontal,-g/2))}function m(a,b,c,d,e,f){switch(c=Math.floor(c),d=Math.floor(d+f)-y,a.beginPath(),e){case"left":a.moveTo(c,d),a.lineTo(c+b,d);break;case"right":a.moveTo(c,d),a.lineTo(c-b,d);break;case"center":b=Math.ceil(b/2),a.moveTo(c-b,d),a.lineTo(c+b,d)}a.stroke()}function n(a,b,c){switch(a){case"top":return 0;case"middle":return(b-c)/2;case"bottom":return b-c}}function o(a,b,c){for(var d,e,f,g,h,i,j,k,l=[],m={},n=a.getGrid(),o=b.r,p=c.r;p>=o;o++){d=[],j=n.rowMap[o];for(var q=b.c,r=c.c;r>=q;q++){if(k=n.colMap[q],f=a.getMergeCell(j,k)){if(h=f.start.row,i=f.start.col,g=h+","+i,m[g])continue;m[g]=!0}else h=j,i=k;e=a.getDisplayValue(h,i),e&&(d[q]={content:e,font:a.getComputedStyle("fonts",h,i),alignment:a.getComputedStyle("alignments",h,i),mergeInfo:f,row:o,col:q})}l.push(d)}return l}function p(a,b,c){for(var d,e,f,g,h={},i={},j=0,k=c.length;k>j;j++){d=c[j],f=[];for(var l=0,m=d.length;m>l;l++)e=d[l],e&&(g=JSON.stringify(e.font),h[g]?h[g].push(e):h[g]=[e])}for(var n in h)h.hasOwnProperty(n)&&q(a,h[n]);return r(b,c,i),{layout:h,overflow:i}}function q(a,b){var c,d,e=b[0].font;a.setFontStyle(e);for(var f=0,g=b.length;g>f;f++){d=[],c=b[f].content.split("\n");for(var h=0,i=c.length;i>h;h++)d[h]=a.measureText(c[h]).width;b[f].contentWidth=Math.max.apply(null,d)}}function r(a,b,c){for(var d,e,f=0,g=b.length;g>f;f++){d=b[f];for(var h=0,i=d.length;i>h;h++)e=d[h],e&&(e.mergeInfo?t(a,e):s(a,d,f,h,c))}return b}function s(a,b,c,d,e){var f=b[d];switch(f.alignment.horizontal){case"left":u(a,b,c,d,e);break;case"right":w(a,b,c,d,e);break;case"center":v(a,b,c,d,e)}}function t(a,b){var c=D.getMergeCellRect(a,b.row,b.col,b.mergeInfo);switch(b.regionX=c.x+A,b.regionY=c.y+A,b.regionWidth=c.width-B,b.regionHeight=c.height-B,b.alignment.horizontal){case"left":b.textX=b.regionX;break;case"right":b.textX=b.regionX+b.regionWidth;break;case"center":b.textX=b.regionX+b.regionWidth/2}}function u(a,b,c,d,e){for(var f=a.getGrid(),g=f.viewWidth,h=f.viewColPoints,i=b[d],j=g[d],k=i.contentWidth+B,l=d+1,m=g.length;m>l&&!b[l]&&!(j>=k);l++)e[c+","+l]=!0,j+=g[l]+z;i.textX=h[d]+y+A,i.regionX=h[d]+y+A,i.regionY=f.viewRowPoints[i.row]+y+A,i.regionWidth=j-B,i.regionHeight=f.viewHeight[i.row]-B}function v(a,b,c,d,e){var f=a.getGrid(),g=f.viewWidth,h=f.viewColPoints,i=b[d],j=g[d],k=(j+i.contentWidth)/2+A;i.regionWidth=0;for(var l=d+1,m=h.length;m>l&&!b[l]&&!(j>=k);l++)e[c+","+l]=!0,j+=g[l]+z;i.regionWidth+=j,j=g[d];for(var n=0,l=d-1;l>=0&&!b[l]&&!(j>=k);l--)e[c+","+(l+1)]=!0,n++,j+=g[l]+z;i.textX=h[d]+y+g[d]/2,i.regionWidth+=j-g[d]-B,i.regionHeight=f.viewHeight[i.row]-B,i.regionX=h[d-n]+y+A,i.regionY=f.viewRowPoints[i.row]+y+A}function w(a,b,c,d,e){for(var f=a.getGrid(),g=f.viewWidth,h=f.viewColPoints,i=b[d],j=g[d],k=i.contentWidth+B,l=0,m=d-1;m>=0&&!b[m]&&!(j>=k);m--)e[c+","+(m+1)]=!0,l++,j+=g[m]+z;i.textX=h[d+1]-y-A,i.regionWidth=j-B,i.regionHeight=f.viewHeight[i.row]-B,i.regionX=h[d-l]+y+A,i.regionY=f.viewRowPoints[i.row]+y+A}var x=b.r(14),y=x.border.offset,z=x.border.width,A=x.CONTENT_PADDING,B=2*A,C=x.LINE_HEIGHT,D=b.r(228);return{draw:function(b,c){var d,f,g=a(c),h=g.regions,i=g.layout,j=[];if(g.overflow=j,1===h.length)return f=e(b,c,i[0]),g.layout[0]=f.layout,g.overflow[0]=f.overflow,g;for(var k=0,l=h.length;l>k;k++)d=h[k],b.save(),b.beginPath(),b.rect(d.x,d.y,d.width,d.height),b.clip(),f=e(b,c,i[k]),g.layout[k]=f.layout,g.overflow[k]=f.overflow,b.restore();return g}}}},b[223]={value:function(){function a(a,b,d){for(var e,f=c(b,d),g=0,h=f.length;h>g;g++)e=f[g],a.fillStyle(e.fillColor),a.fillRect(e.x,e.y,e.width,e.height)}function c(a,b){for(var c,d,h,i,j,k,l,m,n,o,p=a.getGrid(),q=[],r={},s=b.startRow,t=b.endRow;t>=s;s++){c=0,n=p.rowMap[s];for(var u=b.startCol,v=b.endCol;v>=u;u++)o=p.colMap[u],d=a.getMergeCell(n,o),d&&(j=d.start,k=d.end,h=j.row+","+j.col,r[h]||(r[h]=!0,m=g.getMergeCellRect(a,s,u,d),i=a.getComputedStyle("fills",j.row,j.col),l=i&&i.fill!==f?i.fill:e,m.fillColor=l,q.push(m)))}return q}var d=b.r(14),e=d.canvas.background,f=b.r(118),g=b.r(228);return{draw:function(b,c,d){var e;if(1===d.length)return void a(b,c,d[0]);for(var f=0,g=d.length;g>f;f++)e=d[f],b.save(),b.beginPath(),b.rect(e.x,e.y,e.width,e.height),b.clip(),a(b,c,e),b.restore()}}}},b[224]={value:function(){var a=b.r(14).CANDIDATE_FONT;return b.r(0).create("Canvas",{width:0,height:0,node:null,context:null,zoom:1,constructor:function(a,b,c){this.node=a.createElement("canvas"),this.context=this.node.getContext("2d"),this.resize(b,c),this.clear()},getNode:function(){return this.node},appendTo:function(a){a.appendChild(this.node)},remove:function(){var a=this.node.parentNode;a&&this.node.parentNode.removeChild(this.node)},resize:function(a,b,c){this.width=a,this.height=b,void 0==c?c=this.zoom:this.zoom=c,this.node.width=Math.ceil(a*c),this.node.height=Math.ceil(b*c),this.node.style.width=a+"px",this.node.style.height=b+"px",this.context.scale(c,c)},clear:function(){this.resize(this.width,this.height)},clearRect:function(a,b,c,d){this.context.clearRect(a,b,c,d)},font:function(a){return this.__set("font",a)},setFontStyle:function(b){this.context.font=[b.italic?"italic":"normal",b.bold?"bold":"normal",b.size+"px",b.name+","+a].join(" ")},setLineDash:function(a){this.context.setLineDash(a)},textAlign:function(a){return this.__set("textAlign",a)},textBaseline:function(a){return this.__set("textBaseline",a)},fillStyle:function(a){return this.__set("fillStyle",a)},strokeStyle:function(a){return this.__set("strokeStyle",a)},lineWidth:function(a){return this.__set("lineWidth",a)},createImageData:function(a,b){return this.context.createImageData(a,b)},putImageData:function(a,b,c){this.context.putImageData(a,b,c)},getImageData:function(a,b,c,d){return this.context.getImageData(a,b,c,d)},dumpImageData:function(){return this.context.getImageData(0,0,this.width,this.height)},drawImage:function(){return this.context.drawImage.apply(this.context,arguments)},globalCompositeOperation:function(a){this.context.globalCompositeOperation=a},translate:function(a,b){this.context.translate(a,b)},getImage:function(){return this.node},fillRect:function(a,b,c,d){return a=a||0,b=b||0,c=c||this.width,d=d||this.height,this.context.fillRect(a,b,c,d),this},strokeRect:function(a,b,c,d){return a=a||0,b=b||0,c=c||this.width,d=d||this.height,this.context.strokeRect(a,b,c,d),this},rect:function(a,b,c,d){return this.context.rect(a,b,c,d),this},clip:function(){return this.context.clip(),this},beginPath:function(){return this.context.beginPath(),this},closePath:function(){return this.context.closePath(),this},moveTo:function(a,b){return this.context.moveTo(a,b),this},lineTo:function(a,b){return this.context.lineTo(a,b),this},stroke:function(){return this.context.stroke(),this},fill:function(){return this.context.fill(),this},save:function(){return this.context.save(),this},restore:function(){return this.context.restore(),this},fillText:function(a,b,c,d){return void 0===d?this.context.fillText(a,b,c):this.context.fillText(a,b,c,d),this},strokeText:function(){return this.context.strokeText(),this},measureText:function(a){return this.context.measureText(a)},__set:function(a,b){return void 0===b?this.context[a]:(this.context[a]=b,this)}})}},b[225]={value:function(){var a=b.r(224),c=b.r(228),d=b.r(14).PANE_LINE_COLOR;return b.r(0).create("LeftScreen",{width:0,height:0,canvas:null,base:b.r(135),init:function(){this.canvas=new a(this.getDocument(),this.width,this.height),this.onMessage({"c.range.change":this.rerender,"c.refresh":this.rerender,"c.range.disabled":this.rerender}),this.registerService({"s.left.selection.patch":this.drawSelectionPatch})},appendTo:function(a){a.appendChild(this.canvas.getNode())},resize:function(a,b){this.width=a,this.height=b,this.canvas.resize(a,b,this.getConfig("ZOOM")),this.canvas.font(this.getConfig("head").font)},rerender:function(){this.clear(),this.render()},clear:function(){this.canvas.clear()},render:function(){this.drawStableSelection(),this.drawGrid(),this.drawPaneLine()},drawSelectionPatch:function(a,b){this.clear(),this.drawSelection(a,b),this.drawGrid(),this.drawPaneLine()},drawPaneLine:function(){var a=this.rs("c.struct"),b=a.getPane();if(-1!==b.row){var c=this.canvas,e=a.getGrid(),f=this.getConfig("head"),g=e.viewRowPoints[b.row+1];c.strokeStyle(d),c.beginPath(),c.moveTo(0,g),c.lineTo(f.width,g),c.stroke()}},drawStableSelection:function(){var a=this.rs("c.range");if(a.isValid()){var b=a.getAllSelection()[0];this.drawSelection(b.start,b.end)}},drawSelection:function(a,b){var d=this.rs("c.struct"),e=this.getConfig("head"),f=this.canvas,g=c.getRegionHeight(d,a.row,b.row);f.fillStyle(e.focusColor),f.fillRect(0,g.y,e.width,g.height)},drawGrid:function(){var a=this.rs("c.struct"),b=a.getGrid(),c=a.getVisibleCount(),d=this.getConfig(),e=a.getOffset(),f=this.canvas,g=this.width,h=this.height,i=a.getBorderWidth(),j=null,k=d.head.width,l=b.rowMap,m=b.viewRowPoints,n=b.viewHeight;f.strokeStyle(d.border.color),f.lineWidth(i),f.textAlign("center"),f.textBaseline("middle"),f.fillStyle(d.head.color),f.beginPath(),f.strokeRect(-i,b.viewColPoints[0],g+3*i,h-i);for(var o=0,p=c.row;p>o;o++)j=m[o+1],f.moveTo(0,j),f.lineTo(g,j),f.fillText(l[o]+1,k/2,j-e-n[o]/2+1);f.closePath(),f.stroke()}})}},b[226]={value:function(){var a=b.r(212),c=b.r(227),d=b.r(225);return b.r(0).create("Screen",{bodyScreen:null,gridScreen:null,panel:null,base:b.r(138),init:function(){this.bodyScreen=this.createComponent(a),this.topScreen=this.createComponent(c),this.leftScreen=this.createComponent(d),this.resize(),this.onMessage("c.refresh",this.render),this.onMessage("c.container.resize",this.resize)},run:function(){this.bodyScreen.appendTo(this.getContentContainer()),this.topScreen.appendTo(this.getTopContainer()),this.leftScreen.appendTo(this.getLeftContainer())},render:function(){this.bodyScreen.clear(),this.bodyScreen.render(),this.topScreen.clear(),this.topScreen.render(),this.leftScreen.clear(),this.leftScreen.render()},resize:function(){this.__resize(this.getContentSize(),this.getTopSize(),this.getLeftSize())},__resize:function(a,b,c){this.bodyScreen.resize(a.width,a.height),this.topScreen.resize(b.width,b.height),this.leftScreen.resize(c.width,c.height)}})}},b[227]={value:function(){var a=b.r(224),c=b.r(228),d=b.r(14).PANE_LINE_COLOR;return b.r(0).create("TopScreen",{width:0,height:0,canvas:null,base:b.r(135),init:function(){this.canvas=new a(this.getDocument(),this.width,this.height),this.onMessage({"c.range.change":this.rerender,"c.refresh":this.rerender,"c.range.disabled":this.rerender}),this.registerService({"s.top.selection.patch":this.drawSelectionPatch})},appendTo:function(a){a.appendChild(this.canvas.getNode())},resize:function(a,b){this.width=a,this.height=b,this.canvas.resize(a,b,this.getConfig("ZOOM")),this.canvas.font(this.getConfig("head").font)},rerender:function(){this.clear(),this.render()},clear:function(){this.canvas.clear()},render:function(){this.drawStableSelection(),this.drawGrid(),this.drawPaneLine()},drawSelectionPatch:function(a,b){this.clear(),this.drawSelection(a,b),this.drawGrid(),this.drawPaneLine()},drawStableSelection:function(){var a=this.rs("c.range");if(a.isValid()){var b=a.getAllSelection()[0];this.drawSelection(b.start,b.end)}},drawPaneLine:function(){var a=this.rs("c.struct"),b=a.getPane();if(-1!==b.col){var c=this.canvas,e=a.getGrid(),f=this.getConfig("head"),g=e.viewColPoints[b.col+1];c.strokeStyle(d),c.beginPath(),c.moveTo(g,0),c.lineTo(g,f.height),c.stroke()}},drawSelection:function(a,b){var d=this.rs("c.struct"),e=this.getConfig("head"),f=this.canvas,g=c.getRegionWidth(d,a.col,b.col);f.fillStyle(e.focusColor),f.fillRect(g.x,0,g.width,e.height)},drawGrid:function(){var a=this.rs("c.struct"),b=a.getGrid(),c=a.getVisibleCount(),d=a.getOffset(),e=this.getConfig(),f=this.canvas,g=this.width,h=this.height,i=a.getBorderWidth(),j=null,k=e.head.height,l=b.colMap,m=b.viewColPoints,n=b.viewWidth;
f.strokeStyle(e.border.color),f.lineWidth(i),f.textAlign("center"),f.textBaseline("middle"),f.fillStyle(e.head.color),f.beginPath(),f.strokeRect(b.viewColPoints[0],-i,g-i,h+3*i);for(var o=0,p=c.col;p>o;o++)j=m[o+1],f.moveTo(j,0),f.lineTo(j,h),f.fillText(this.cs("c.title.index2char",l[o]),j-d-n[o]/2,k/2);f.closePath(),f.stroke()}})}},b[228]={value:function(){function a(a,b,c){for(var d,f=-1,g=[],h=b;c>=h;h++)d=a.getColumnWidth(h),g.push(d),0!==d&&(f+=d+e);return 0>f&&(f=0),{width:f,widthList:g}}function c(a,b,c){for(var d,f=-1,g=[],h=b;c>=h;h++)d=a.getRowHeight(h),g.push(d),0!==d&&(f+=d+e);return 0>f&&(f=0),{height:f,heightList:g}}var d=b.r(14),e=d.border.width,f=d.border.offset;return{getMergeCellRect:function(b,d,g,h){for(var i=b.getGrid(),j=i.rowMap[d],k=i.colMap[g],l=h.start.row,m=h.start.col,n=h.end.row,o=h.end.col,p=i.viewColPoints[g],q=i.viewRowPoints[d],r=a(b,m,o),s=c(b,l,n),t=r.widthList,u=s.heightList,v=0,w=l;j>w;w++,v++)0!==u[v]&&(q-=u[v]+e);v=0;for(var w=m;k>w;w++,v++)0!==t[v]&&(p-=t[v]+e);return{x:p+f,y:q+f,width:r.width,height:s.height}},getRegionHeight:function(a,b,c){for(var d,g=a.getGrid(),h=g.rMap,i=g.viewHeight,j=g.viewRowPoints,k=-1,l=-1,m=Math.min(b,c),n=Math.max(b,c),o=m;n>=o;o++)d=h[o],void 0!==d&&(-1===l&&(l=j[d]+f),k+=i[d]+e);return{y:l,height:k}},getRegionWidth:function(a,b,c){for(var d,g=a.getGrid(),h=g.cMap,i=g.viewWidth,j=g.viewColPoints,k=-1,l=-1,m=Math.min(b,c),n=Math.max(b,c),o=m;n>=o;o++)d=h[o],void 0!==d&&(-1===l&&(l=j[d]+f),k+=i[d]+e);return{x:l,width:k}}}}},b[229]={value:function(){var a=b.r(2);return b.r(0).create("ScrollEventManager",{base:b.r(135),x:0,y:0,lastTimeStamp:0,init:function(){this.initEvent()},initEvent:function(){var b=this;a(this.getMainContainer()).on("mousewheel DOMMouseScroll",function(a){b.update(a)})},update:function(a){a.preventDefault();var b=a.originalEvent;if(this.x=b.deltaX,this.y=b.deltaY,!(b.timeStamp-this.lastTimeStamp<20)){var c=this.y>=0?1:-1,d=this.x>=0?1:-1;this.rs("c.row.scroll",c*Math.ceil(Math.abs(this.y)/10)),this.rs("c.col.scroll",d*Math.ceil(Math.abs(this.x)/10)),this.x=0,this.y=0,this.lastTimeStamp=b.timeStamp}}})}},b[230]={value:function(){var a=b.r(2),c=50,d=b.r(229);return b.r(0).create("Scrollbar",{hSlider:null,vSlider:null,hSlidway:null,vSlidway:null,endIndex:null,hWayLength:0,vWayLength:0,hUnitLength:0,vUnitLength:0,hBarSize:0,vBarSize:0,hOffset:0,hold:!1,vOffset:0,base:b.r(138),init:function(){var a=this.getScrollSize();this.hWayLength=a.h.width-2,this.vWayLength=a.v.height-2,this.createHorizontalBar(a.h),this.createVerticalBar(a.v),this.getConfig("enableScroll")&&this.createComponent(d),this.initMessageHook()},run:function(){var a=this.getScrollContainer();a.h.appendChild(this.hSlidway),a.v.appendChild(this.vSlidway),this.initEvent()},initMessageHook:function(){this.onMessage({"c.refresh":this.update})},update:function(){this.isLock()||this.refresh()},refresh:function(){var a=this.rs("c.struct"),b=a.getTotal(),d=a.getVisibleCount(),e=a.getViewStart();this.endIndex=b,this.vBarSize=Math.max(Math.floor(this.vWayLength*(d.row-1)/b.row),c),this.hBarSize=Math.max(Math.floor(this.hWayLength*(d.col-1)/b.col),c),this.hSlider.style.width=this.hBarSize+"px",this.vSlider.style.height=this.vBarSize+"px",this.hUnitLength=(this.hWayLength-this.hBarSize)/(b.col-d.col),this.vUnitLength=(this.vWayLength-this.vBarSize)/(b.row-d.row),this.hOffset=Math.floor(e.col*this.hUnitLength),this.vOffset=Math.floor(e.row*this.vUnitLength),this.hSlider.style.left=this.hOffset+"px",this.vSlider.style.top=this.vOffset+"px"},initEvent:function(){var b=this;a(this.hSlider).on("mousedown",function(a){a.stopPropagation(),a.preventDefault(),b.lock(),b.hMoveStart(a)}),a(this.vSlider).on("mousedown",function(a){a.stopPropagation(),a.preventDefault(),b.lock(),b.vMoveStart(a)})},hMoveStart:function(b){var c=b.clientX,d=0,e=this,f=e.hWayLength-this.hBarSize,g=a(this.hSlidway);g.addClass("btb-active"),a(this.getDocument()).on("mousemove.scroll",function(a){a.stopPropagation(),a.preventDefault(),d=a.clientX-c+e.hOffset,d>f?d=f:0>d&&(d=0),e.hSlider.style.left=d+"px";var b=0;b=0===d?0:d===f?e.endIndex.col:Math.floor(d/e.hUnitLength),e.rs("c.col.scrollto",b)}).one("mouseup",function(b){b.stopPropagation(),b.preventDefault(),g.removeClass("btb-active"),a(this).off("mousemove.scroll"),e.hOffset=d,e.unlock()})},lock:function(){this.hold=!0},unlock:function(){this.hold=!1},isLock:function(){return this.hold},vMoveStart:function(b){var c=b.clientY,d=0,e=this,f=e.vWayLength-this.vBarSize,g=a(this.vSlidway);g.addClass("btb-active"),a(this.getDocument()).on("mousemove.scroll",function(a){a.stopPropagation(),a.preventDefault(),d=a.clientY-c+e.vOffset,d>f?d=f:0>d&&(d=0),e.vSlider.style.top=d+"px";var b=0;b=0===d?0:d===f?e.endIndex.row:Math.floor(d/e.vUnitLength),e.rs("c.row.scrollto",b)}).one("mouseup",function(b){b.stopPropagation(),b.preventDefault(),g.removeClass("btb-active"),a(this).off("mousemove.scroll"),e.vOffset=d,e.unlock()})},createHorizontalBar:function(a){var b=a.width,d=a.height;this.hSlidway=this.createElement("div",{attr:{"class":"btb-slidway"},style:{width:b-2,height:d-2,top:1,left:1}}),this.hSlider=this.createElement("div",{attr:{"class":"btb-slider"},style:{width:c,height:"100%",left:this.hOffset}}),this.hSlidway.appendChild(this.hSlider)},createVerticalBar:function(a){var b=a.width,d=a.height;this.vSlidway=this.createElement("div",{attr:{"class":"btb-slidway"},style:{width:b-2,height:d-2,top:1,left:1}}),this.vSlider=this.createElement("div",{attr:{"class":"btb-slider"},style:{width:"100%",height:c,top:this.vOffset}}),this.vSlidway.appendChild(this.vSlider)}})}},b[231]={value:function(){return b.r(0).create("Position",{panel:null,base:b.r(138),init:function(){this.panel=this.createElement("div","btb-selectall-panel"),this.panel.appendChild(this.createElement("div","btb-selectall-btn"));var a=this.getTopSize(),b=this.getLeftSize();this.panel.style.cssText="width: "+b.width+"px; height: "+a.height+"px;",this.initEvent()},initEvent:function(){var a=this;$(this.panel).on("mousedown",function(b){b.preventDefault(),a.execCommand("focus",0,0),a.execCommand("selectall")})},run:function(){this.getMainContainer().appendChild(this.panel)}})}},b[232]={value:function(){var a=(b.r(2),b.r(205));return b.r(0).create("NormalWorker",{selection:null,coverModule:null,selectionNode:null,$selectionNode:null,visiableState:!1,activeCell:null,moveCell:null,started:!1,banState:!1,fixedToActive:!1,ignorePaneCol:!1,base:b.r(135),init:function(a,b){this.selection=a,this.coverModule=b,this.initEvent()},run:function(){this.getContentContainer().appendChild(this.selectionNode)},initEvent:function(){this.coverModule.onmousedown(this,this.onmousedown),this.coverModule.onmousemove(this,this.onmousemove),this.coverModule.onmouseup(this,this.onmouseup),this.coverModule.onmouseleave(this,this.onmouseleave)},onmousedown:function(a,b){var c=this.rs("c.struct"),d=c.getPane();if(-1===d.row&&-1===d.col){this.started=!0;var e=c.getGrid();this.selection.hide(),this.activeCell={row:e.rowMap[a],col:e.colMap[b]}}},onmousemove:function(b,c){if(this.started){this.banState=!0,this.selection.unstable();var d=this.activeCell,e=this.rs("c.struct"),f=e.getGrid(),g=f.rowMap[b],h=f.colMap[c];if(this.moveCell={row:g,col:h},g===d.row&&h===d.col)return void this.selection.hide();var i=a.getSelectionRect(e,d,this.moveCell);this.selection.resize(i),this.rs("s.left.selection.patch",d,this.moveCell),this.rs("s.top.selection.patch",d,this.moveCell)}},onmouseup:function(){this.started&&this.stop()},onmouseleave:function(b,c,d){if(this.started){var e,f,g=this.rs("c.struct");switch(b){case"right":this.execCommand("scrollcolumn",1),f=g.getViewEnd(),this.moveCell={row:g.getGrid().rowMap[c],col:f.col};break;case"bottom":this.execCommand("scrollrow",1),f=g.getViewEnd(),this.moveCell={row:f.row,col:g.getGrid().colMap[d]};break;case"top":this.execCommand("scrollrow",-1),e=g.getViewStart(),this.moveCell={row:e.row,col:g.getGrid().colMap[d]};break;case"left":this.execCommand("scrollcolumn",-1),e=g.getViewStart(),this.moveCell={row:g.getGrid().rowMap[c],col:e.col};break;case"right-bottom":this.execCommand("scroll",1,1),f=g.getViewEnd(),this.moveCell={row:f.row,col:f.col};break;case"right-top":this.execCommand("scroll",-1,1),e=g.getViewStart(),f=g.getViewEnd(),this.moveCell={row:e.row,col:f.col};break;case"left-bottom":this.execCommand("scroll",1,-1),e=g.getViewStart(),f=g.getViewEnd(),this.moveCell={row:f.row,col:e.col};break;case"left-top":this.execCommand("scroll",-1,-1),e=g.getViewStart(),this.moveCell={row:e.row,col:e.col}}var h=a.getSelectionRect(g,this.activeCell,this.moveCell);this.selection.resize(h),this.rs("s.left.selection.patch",this.activeCell,this.moveCell),this.rs("s.top.selection.patch",this.activeCell,this.moveCell)}},stop:function(){if(this.started&&null!==this.moveCell){this.banState=!1,this.started=!1;var a=this.activeCell,b=(this.rs("c.struct"),this.moveCell.row),c=this.moveCell.col;if(this.moveCell=null,b===a.row&&c===a.col)return void this.selection.hide();var d=this.cs("c.cell.compare",a,{row:b,col:c});this.rs("c.range.selection",d.min,d.max)}}})}},b[233]={value:function(){var a=(b.r(2),b.r(205));return b.r(0).create("NormalWorker",{selection:null,coverModule:null,selectionNode:null,$selectionNode:null,visiableState:!1,activeCell:null,moveCell:null,started:!1,rowFixedToActive:!1,colFixedToActive:!1,timer:null,base:b.r(135),init:function(a,b){this.selection=a,this.coverModule=b,this.initEvent()},run:function(){this.getContentContainer().appendChild(this.selectionNode)},initEvent:function(){this.coverModule.onmousedown(this,this.onmousedown),this.coverModule.onmousemove(this,this.onmousemove),this.coverModule.onmouseup(this,this.onmouseup),this.coverModule.onmouseleave(this,this.onmouseleave)},onmousedown:function(a,b){var c=this.rs("c.struct"),d=c.getPane();if(-1!==d.row||-1!==d.col){this.started=!0;var e=c.getGrid();this.selection.hide(),this.activeCell={row:e.rowMap[a],col:e.colMap[b]}}},onmousemove:function(b,c){if(this.started){this.selection.unstable();var d=this.activeCell,e=this.rs("c.struct"),f=e.getGrid(),g=e.getViewStart(),h=e.getPane(),i=f.rowMap[b],j=f.colMap[c],k=!1,l=!1,m=!1,n=!1;if(-1!==h.row&&(d.row<=h.row?i>h.row?this.rowFixedToActive||(this.rowFixedToActive=!0,k=!0):this.rowFixedToActive&&(0!==g.row?m=!0:this.rowFixedToActive=!1):i<=h.row&&(0!==g.row?m=!0:this.rowFixedToActive=!1)),-1!==h.col&&(d.col<=h.col?j>h.col?this.colFixedToActive||(this.colFixedToActive=!0,l=!0):this.colFixedToActive&&(0!==g.col?n=!0:this.colFixedToActive=!1):j<=h.col&&(0!==g.col?n=!0:this.colFixedToActive=!1)),k&&l)return void this.execCommand("scrollto",0,0);if(k)return void this.execCommand("scrollrowto",0);if(l)return void this.execCommand("scrollcolumnto",0);if(m||n)return void this.startRollback(m,n,i,j);if(this.stopRollback(),this.moveCell={row:i,col:j},this.rs("s.left.selection.patch",d,this.moveCell),this.rs("s.top.selection.patch",d,this.moveCell),i===d.row&&j===d.col)return void this.selection.hide();var o=a.getSelectionRect(e,d,this.moveCell);this.selection.resize(o)}},onmouseup:function(){this.started&&this.stop()},onmouseleave:function(a,b,c){this.started&&(this.stopRollback(),this.__leaveProcess(a,b,c))},__leaveProcess:function(b,c,d){this.selection.unstable();var e=this.rs("c.struct"),f=e.getViewStart(),g=f.row,h=f.col,i=e.getPane(),j=this.activeCell,k=e.getVisibleCount(),l=0===c,m=c===k.row-1,n=0===d,o=d===k.col-1,p=0,q=0,r=!1,s=!1;l&&g>0?p=-1:m?(this.rowFixedToActive=!0,p=1):j.row<=i.row&&c>i.row&&g>0&&!this.rowFixedToActive?(this.rowFixedToActive=!0,r=!0):j.row>i.row&&c<i.row&&g>0?p=-1:j.row<=i.row&&c<=i.row&&g>0&&this.rowFixedToActive&&(p=-1),n&&h>0?q=-1:o?(this.colFixedToActive=!0,q=1):j.col<=i.col&&d>i.col&&h>0&&!this.colFixedToActive?(this.colFixedToActive=!0,s=!0):j.col>i.col&&d<i.col&&g>0?q=-1:j.col<=i.col&&d<=i.col&&h>0&&this.colFixedToActive&&(q=-1),r&&s?this.execCommand("scrollto",0,0):r?this.execCommand("scrollrowto",0):s&&this.execCommand("scrollcolumnto",0),p&&q?this.execCommand("scroll",p,q):p?this.execCommand("scrollrow",p):q&&this.execCommand("scrollcolumn",q);var t,u,v=e.getGrid();f=e.getViewStart();var w=this.coverModule.getLeaveIndex();if(t=m?v.rowMap[w.row]:j.row<=i.row&&c>i.row?v.rowMap[w.row]:j.row>i.row&&c<i.row?0===f.row?v.rowMap[w.row]:v.rowMap[i.row+1]:j.row<=i.row&&c<=i.row&&f.row>0&&this.rowFixedToActive?v.rowMap[i.row+1]:v.rowMap[w.row],u=o?v.colMap[w.col]:j.col<=i.col&&d>i.col?v.colMap[w.col]:j.col>i.col&&d<i.col?0===f.col?v.colMap[w.col]:v.colMap[i.col+1]:j.col<=i.col&&d<=i.col&&f.col>0&&this.colFixedToActive?v.colMap[i.col+1]:v.colMap[w.col],t===j.row&&u===j.col)return void this.selection.hide();this.moveCell={row:t,col:u},this.rs("s.left.selection.patch",j,this.moveCell),this.rs("s.top.selection.patch",j,this.moveCell);var x=a.getSelectionRect(e,j,this.moveCell);this.selection.resize(x)},startRollback:function(a,b,c,d){var e=this;this.stopRollback(),this.__rollback(a,b,c,d),this.timer=setInterval(function(){e.__rollback(a,b,c,d)},50)},__rollback:function(b,c,d,e){var f=this.activeCell;b&&c?this.execCommand("scroll",-1,-1):b?this.execCommand("scrollrow",-1):c&&this.execCommand("scrollcolumn",-1);var g=this.rs("c.struct"),h=g.getGrid(),i=g.getPane(),j=g.getViewStart();if(b&&c){if(0===j.row&&0===j.col){this.stopRollback(),this.moveCell={row:d,col:e},this.rs("s.left.selection.patch",f,this.moveCell),this.rs("s.top.selection.patch",f,this.moveCell);var k=a.getSelectionRect(g,f,this.moveCell);return void this.selection.resize(k)}}else if(b){if(0===j.row){this.stopRollback(),this.moveCell={row:d,col:e},this.rs("s.left.selection.patch",f,this.moveCell),this.rs("s.top.selection.patch",f,this.moveCell);var k=a.getSelectionRect(g,f,this.moveCell);return void this.selection.resize(k)}}else if(c&&0===j.col){this.stopRollback(),this.moveCell={row:d,col:e},this.rs("s.left.selection.patch",f,this.moveCell),this.rs("s.top.selection.patch",f,this.moveCell);var k=a.getSelectionRect(g,f,this.moveCell);return void this.selection.resize(k)}if(b&&0!==j.row&&(d=h.rowMap[i.row+1]),c&&0!==j.col&&(e=h.colMap[i.col+1]),d===f.row&&e===f.col)return void this.selection.hide();this.moveCell={row:d,col:e},this.rs("s.left.selection.patch",f,this.moveCell),this.rs("s.top.selection.patch",f,this.moveCell);var k=a.getSelectionRect(g,f,this.moveCell);this.selection.resize(k)},stopRollback:function(){null!==this.timer&&(clearInterval(this.timer),this.timer=null)},stop:function(){if(this.started&&null!==this.moveCell){this.started=!1;var a=this.activeCell,b=(this.rs("c.struct"),this.moveCell.row),c=this.moveCell.col;if(this.moveCell=null,this.rowFixedToActive=!1,this.colFixedToActive=!1,this.stopRollback(),b===a.row&&c===a.col)return void this.selection.hide();var d=this.cs("c.cell.compare",a,{row:b,col:c});this.rs("c.range.selection",d.min,d.max)}}})}},b[234]={value:function(){var a=b.r(2),c=b.r(205),d=b.r(232),e=b.r(233),f=b.r(0).create("Selection",{selectionNode:null,$selectionNode:null,visiableState:!1,base:b.r(138),init:function(b){this.selectionNode=this.createSelection(),this.$selectionNode=a(this.selectionNode),this.normalWorker=this.createComponent(d,this,b),this.paneWorker=this.createComponent(e,this,b),this.initMessageHook()},run:function(){this.getContentContainer().appendChild(this.selectionNode)},initMessageHook:function(){this.onMessage({"c.refresh":this.update,"c.range.change":this.rangeChange})},rangeChange:function(){this.$selectionNode.removeClass("btb-s-selection-unstable"),this.update()},update:function(){var a=this.rs("c.range");if(!a.isValid()||!a.isMultiple())return void this.hide();var b=this.rs("c.struct"),d=c.getSelectionRect(b,a.getStart(),a.getEnd());this.resize(d)},show:function(){this.visiableState||(this.visiableState=!0,this.$selectionNode.show())},hide:function(){this.visiableState&&(this.visiableState=!1,this.$selectionNode.hide())},addFailedState:function(){this.$selectionNode.addClass("btb-selection-failed")},removeFailedState:function(){this.$selectionNode.removeClass("btb-selection-failed")},unstable:function(){this.$selectionNode.addClass("btb-s-selection-unstable")},stop:function(){this.normalWorker.stop(),this.paneWorker.stop()},resize:function(a){return a?(this.show(),void this.$selectionNode.css(a)):void this.hide()},createSelection:function(){return this.createElement("div","btb-s-selection")}});return f.deps=["cover"],f}},b[235]={value:function(){var a=(b.r(2),b.r(114)),c=b.r(117);return b.r(0).create("Cell",{base:b.r(138),init:function(){this.initService()},initService:function(){this.registerService({"c.sort.column.asc":this.sortColumnByAsc,"c.sort.column.desc":this.sortColumnByDesc,"c.sort.row.asc":this.sortRowAsc,"c.sort.row.desc":this.sortRowDesc})},sortColumnByAsc:function(a,b){var c=this.__getSortColumnIndex(a,b);this.rs("c.exchange.row",c,b),this.coreRefresh(!0)},sortColumnByDesc:function(a,b){var c=this.__getSortColumnIndex(a,b);c=c.reverse(),this.rs("c.exchange.row",c,b),this.coreRefresh(!0)},sortRowAsc:function(a,b){var c=this.__getSortRowIndex(a,b);this.rs("c.exchange.column",c,b),this.coreRefresh(!0)},sortRowDesc:function(a,b){var c=this.__getSortRowIndex(a,b);c=c.reverse(),this.rs("c.exchange.column",c,b),this.coreRefresh(!0)},__getSortColumnIndex:function(b,d){var e,f,g,h=d.start,i=d.end,j=this.rs("c.struct"),k=[],l=[],m=[],n=[],o={},p={},q={},r={};if(!(b<h.col||b>i.col)){for(var s=h.row,t=i.row;t>=s;s++)if(e=j.getComputedValueInfo(s,b),f=e.type,g=e.value,f!==a.UNDEFINED)if(f===a.TEXT)g=g.toLowerCase(),l.push(g),p[g]||(p[g]=[]),p[g].push(s);else if(f===a.ERROR)m.push(g),q[g]||(q[g]=[]),q[g].push(s);else if(f===a.BOOLEAN)g=g===c.TRUE?1:0,r[g]||(r[g]=[]),n.push(g),r[g].push(s);else{switch(f){case a.NUMERIC:g=+g;break;case a.DATE:case a.TIME:g=+j.getRawValue(s,b)}k.push(g),o[g]||(o[g]=[]),o[g].push(s)}var u=[],v={};k.sort(function(a,b){return a-b});for(var s=0,w=k.length;w>s;s++)if(g=k[s],!v[g]){v[g]=!0,g=o[g];for(var x=0,y=g.length;y>x;x++)u.push(g[x])}l.sort(),v={};for(var s=0,w=l.length;w>s;s++)if(g=l[s],!v[g]){v[g]=!0,g=p[g];for(var x=0,y=g.length;y>x;x++)u.push(g[x])}n.sort(),v={};for(var s=0,w=n.length;w>s;s++)if(g=n[s],!v[g]){v[g]=!0,g=r[g];for(var x=0,y=g.length;y>x;x++)u.push(g[x])}m.sort(),v={};for(var s=0,w=m.length;w>s;s++)if(g=m[s],!v[g]){v[g]=!0,g=q[g];for(var x=0,y=g.length;y>x;x++)u.push(g[x])}return u}},__getSortRowIndex:function(b,d){var e,f,g=d.start,h=d.end,i=this.rs("c.struct"),j=[],k=[],l=[],m=[],n=[],o={},p={},q={},r={};if(!(b<g.col||b>h.col)){for(var s=g.row,t=h.row;t>=s;s++)if(e=i.getComputedCell(s,b),e.type!==a.UNDEFINED)if(j[s]=i.getRawValue(s,b),e.type===a.TEXT)f=e.value,l.push(f),p[f]||(p[f]=[]),p[f].push(s);else if(e.type===a.ERROR)f=e.value,m.push(f),q[f]||(q[f]=[]),q[f].push(s);else if(e.type===a.BOOLEAN)f=e.value===c.TRUE?1:0,r[f]||(r[f]=[]),n.push(f),r[f].push(s);else{switch(e.type){case a.NUMERIC:f=+e.value;break;case a.DATE:case a.TIME:f=+j[s]}k.push(f),o[f]||(o[f]=[]),o[f].push(s)}var u=[],v={};k.sort(function(a,b){return a-b});for(var s=0,w=k.length;w>s;s++)if(f=k[s],!v[f]){v[f]=!0,f=o[f];for(var x=0,y=f.length;y>x;x++)u.push(f[x])}l.sort(),v={};for(var s=0,w=l.length;w>s;s++)if(f=l[s],!v[f]){v[f]=!0,f=p[f];for(var x=0,y=f.length;y>x;x++)u.push(f[x])}n.sort(),v={};for(var s=0,w=n.length;w>s;s++)if(f=n[s],!v[f]){v[f]=!0,f=r[f];for(var x=0,y=f.length;y>x;x++)u.push(f[x])}m.sort(),v={};for(var s=0,w=m.length;w>s;s++)if(f=m[s],!v[f]){v[f]=!0,f=q[f];for(var x=0,y=f.length;y>x;x++)u.push(f[x])}return u}}})}},b[236]={value:function(){var a=b.r(2);return b.r(0).create("Viewport",{base:b.r(138),init:function(){this.initEvent()},initEvent:function(){var b=this;a(this.getDocument().defaultView).on("resize",function(){b.updateViewport()})},updateViewport:function(){this.rs("c.zoom.refresh"),this.rs("c.update.viewport")}})}},b[237]={value:function(){var a=b.r(4);a.command(b.r(5)),a.module(b.r(183)),a.mapEvent(b.r(133)),a.Interpreter=b.r(160),a.ExcelAdapter=b.r(142),window.BTable=a}};var c={"kf.start":237};!function(){try{a("kf.start")}catch(b){}}(this)}();