/*!
 * ====================================================
 * BTable Number Format - v1.0.0 - 2015-05-19
 * https://github.com/kitygraph/formula
 * GitHub: https://github.com/kitygraph/formula.git 
 * Copyright (c) 2015 Baidu Kity Group; Licensed MIT
 * ====================================================
 */
!function(){function a(a){b.r([c[a]])}var b={r:function(a){if(b[a].inited)return b[a].value;if("function"!=typeof b[a].value)return b[a].inited=!0,b[a].value;var c={exports:{}},d=b[a].value(null,c.exports,c);if(b[a].inited=!0,b[a].value=d,void 0!==d)return d;for(var e in c.exports)if(c.exports.hasOwnProperty(e))return b[a].inited=!0,b[a].value=c.exports,c.exports}};b[0]={value:function(a){var c=b.r(18),d=b.r(7),e=b.r(1),f=b.r(4),g=b.r(8),h=b.r(6);return{analyze:function(a,b){var i=a.trim(),j=d.analyze(i);return j?j:(j=e.analyze(i))?j:(j=f.analyze(i))?j:(j=h.analyze(i))?j:(j=g.analyze(i),j?j:{type:c.TEXT,value:a})}}}},b[1]={value:function(a){var c=b.r(9),d=b.r(18),e=b.r(14);return{analyze:function(a){var b=a.match(/^[^0-9\.]/);if(!b)return null;if(b=b[0],!e[b])return null;var f=a.substring(b.length);return c.isNumber(f)?{type:d.CURRENCY,symbol:b,value:parseFloat(f)+""}:null}}}},b[2]={value:function(){function a(a,b,c){if(2===b)if(a%400===0||a%4===0&&a%100!==0);else if(c>28)return!1;return!0}var b=[31,29,31,30,31,30,31,31,30,31,30,31];return{checkDate:function(c){function d(){var a=g.length;switch(a){case 1:g="200"+g,j=+g;break;case 2:g=50>j?"20"+g:"19"+g,j=+g;break;case 4:break;default:return!1}return 1900>j||j>9999?!1:!0}function e(){return h.length>2?!1:k>12||0===k?!1:!0}function f(){return i.length>2?!1:l>b[k]||0===l?!1:!0}var g=c.year,h=c.month,i=c.day,j=+g,k=+h,l=+i;return d()&&e()&&f()&&a(j,k,l)?{type:"date",year:j,month:k,day:l}:null},checkTime:function(a){var b=a.hour,c=a.minute,d=a.second,e=+b,f=+c,g=+d;return b.length>2||e>23?null:c.length>2||c>59?null:d.length>2||g>59?null:{type:"time",hour:e,minute:f,second:g}}}}},b[3]={value:function(a){var c=b.r(15),d=b.r(16),e={analyze:function(a,b){for(var f,g=b.join(""),h=0,i=c.length;i>h;h++)if(f=c[h],-1!==f.indexOf(g))return b[0]===f.charAt(0)?e.analyzeDate(a,!0):e.analyzeDate(a,!1);for(var h=0,i=d.length;i>h;h++)if(f=d[h],-1!==f.indexOf(g))return b[0]===f.charAt(0)?e.analyzeTime(a,!0):e.analyzeTime(a,!1);return null},analyzeDate:function(a,b){var c=new Date;return b?{type:"date",year:a[0],month:a[1],day:a[2]||"1"}:{type:"date",year:c.getFullYear()+"",month:a[0],day:a[1]}},analyzeTime:function(a,b){var c=new Date;return b?{type:"time",hour:a[0],minute:a[1],second:a[2]||"0"}:{type:"time",hour:c.getHours()+"",minute:a[0],second:a[1]}}};return e}},b[4]={value:function(a){function c(a){var b=null;return h.test(a)?b=j.analyze([RegExp.$1,RegExp.$3,RegExp.$4],RegExp.$2):i.test(a)&&(b=k.analyze([RegExp.$1,RegExp.$3,RegExp.$5],[RegExp.$2,RegExp.$4,RegExp.$6])),b?(b="date"===b.type?l.checkDate(b):l.checkTime(b),b?"date"===b.type?{type:g.DATE,value:m.dateToNumber(b.year,b.month,b.day)}:{type:g.TIME,value:m.timeToNumber(b.hour,b.minute,b.second)}:null):null}function d(a,b){var c=e(a),d=f(b);return null===c||0===d?null:{type:g.DATETIME,value:c+d}}function e(a){var b;if(h.test(a))b=j.analyze([RegExp.$1,RegExp.$3,RegExp.$4],RegExp.$2);else{if(!i.test(a))return null;b=k.analyze([RegExp.$1,RegExp.$3,RegExp.$5],[RegExp.$2,RegExp.$4,RegExp.$6])}return b&&"date"===b.type?(b=l.checkDate(b),b?m.dateToNumber(b.year,b.month,b.day):null):null}function f(a){var b;if(h.test(a))b=j.analyze([RegExp.$1,RegExp.$3,RegExp.$4],RegExp.$2);else{if(!i.test(a))return null;b=k.analyze([RegExp.$1,RegExp.$3,RegExp.$5],[RegExp.$2,RegExp.$4,RegExp.$6])}return b&&"time"===b.type?(b=l.checkTime(b),b?m.timeToNumber(b.hour,b.minute,b.second):null):null}var g=b.r(18),h=/^([0-9]+)([-/:])([0-9]+)(?:\2([0-9]+))?$/,i=/^([0-9]+)([^0-9])([0-9]+)([^0-9])(?:([0-9]+)([^0-9]))?$/,j=b.r(5),k=b.r(3),l=b.r(2),m=b.r(10);return{analyze:function(a){return a=a.split(/\s+/),a.length>2?null:1===a.length?c(a[0]):d(a[0],a[1])}}}},b[5]={value:function(){var a={analyze:function(b,c){return"/"===c||"-"===c?a.analyzeDate(b):a.analyzeTime(b)},analyzeDate:function(a){function b(){var b=new Date;return a[0]<=12?{type:"date",year:b.getFullYear()+"",month:a[0],day:a[1]}:{type:"date",year:a[0],month:a[1],day:"1"}}function c(){return{type:"date",year:a[0],month:a[1],day:a[2]}}return a[a.length-1]?c():b()},analyzeTime:function(a){return a[a.length-1]?{type:"time",hour:a[0],minute:a[1],second:a[2]}:{type:"time",hour:a[0],minute:a[1],second:"0"}}};return a}},b[6]={value:function(a){b.r(9),b.r(18),b.r(14);return{analyze:function(a){return null}}}},b[7]={value:function(a){var c=b.r(9),d=b.r(18);return{analyze:function(a){return c.isNumber(a)?/[Ee]/.test(a)?{type:d.SCIENTIFIC,value:parseFloat(a)+""}:{type:d.NUMBER,value:parseFloat(a)+""}:(a=a.replace(/^\(|\)$/g,""),"+"===a.charAt(0)||"-"===a.charAt(0)?null:c.isNumber(a)?{type:d.NUMBER,value:-parseFloat(a)+""}:void 0)}}}},b[8]={value:function(a){var c=b.r(9),d=b.r(18);return{analyze:function(a){return/^\s*%|%\s*$/.test(a)?(a=a.replace("%","").trim(),c.isNumber(a)&&!/[Ee]/.test(a)?{TYPE:d.PERCENTAGE,value:parseFloat(a)+""}:null):null}}}},b[9]={value:function(){return{isNumber:function(a){return!isNaN(parseFloat(a))&&isFinite(a)}}}},b[10]={value:function(){var a=Date.UTC(1900,0,0),b=864e5,c=3600,d=86400,e=1/d;return{dateToNumber:function(c,d,e){var f=Date.UTC(c,d-1,e)-a;return f/b},timeToNumber:function(a,b,d){return(a*c+60*b+d)*e},numberToDate:function(c){c=parseInt(c,10);var d=new Date(c*b+a);return{year:d.getUTCFullYear(),month:d.getUTCMonth()+1,day:d.getUTCDate(),weekday:d.getUTCDay()}},numberToTime:function(a){var b=parseInt(a,10);a-=b;var f,g=Math.round(a/e),h=Math.floor(g/c);return f=0===a?{hour:0,minute:0,second:0,am:!0,hour12:0}:{hour:h,minute:Math.floor(g%c/60),second:g%60,am:12>h,hour12:12>h?h:h-12},g+=d*b,f.totalSecond=g,f.totalMinute=Math.floor(g/60),f.totalHour=Math.floor(g/c),f}}}},b[11]={value:function(){"O\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d".split("")}},b[12]={value:function(){return{convert:function(a,b,c){for(var d=[],e=0,f=a.length;f>e;e++)d.push(a[e].value);return d.join("");var e,f}}}},b[13]={value:function(a){var c=b.r(17);return{convert:function(a){var b,d=[],e=0;a.reverse();for(var f=-1,g=0,h=a.length;h>g;g++)b=a[g],d.push(b),b.type===c.NUMBER&&(e++,f=-1,3===e&&(e=0,f=d.length,d.push({type:c.STRING,value:","})));return-1!==f&&d.splice(f,1),a.reverse(),d.reverse()}}}},b[14]={value:{$:!0,"\xa5":!0,US$:!0}},b[15]={value:["\u5e74\u6708\u65e5"]},b[16]={value:["\u65f6\u5206\u79d2"]},b[17]={value:{STRING:"string",NUMBER:"number",DECIMAL:"decimal",THOUSANDTH:"thousandth",QUOTE:"quote",PERCENTAGE:"percentage",SYMBOL_SPACE:"symbol_space",REPEAT:"repeat",COLOR:"color",DBNUM:"dbnum",LOCALE:"locale",TIMESTAMP:"timestamp",DATE_YEAR:"year",DATE_MONTH:"month",DATE_DAY:"day",TIME_HOUR:"hour",TIME_MINUTE:"minute",TIME_SECOND:"second",AMPM:"AM/PM",SCIENTIFIC:"scientific",FRACTION:"fraction",DATE_LONG_WEEK:"long_week",DATE_SHORT_WEEK:"short_week"}},b[18]={value:{NUMBER:"number",CURRENCY:"currency",DATE:"date",TIME:"time",DATETIME:"datetime",PERCENTAGE:"percentage",FRACTION:"fraction",SCIENTIFIC:"scientific",TEXT:"text",LOGICAL:"logical",ERROR:"error"}},b[19]={value:function(a){function c(a){var b=[];switch(b[0]=a[0],a.length){case 1:b[1]=a[0],b[2]=a[0],b[3]=a[0];break;case 2:b[1]=a[1],b[2]=a[0],b[3]=null;break;case 3:b[1]=a[1],b[2]=a[2],b[3]=null;break;case 4:b[1]=a[1],b[2]=a[2],b[3]=a[3]}return b.type=d(b),b}function d(a){a[0]}function e(a){for(var b,c=f();b=a.shift();)switch(b.type){case g.THOUSANDTH:c.thousandth=!0;break;case g.QUOTE:c.text=!0,c.tokens.push(b);break;case g.COLOR:c.color=b.value;break;case g.DBNUM:c.dbnum=b.value;break;case g.LOCALE:c.locale=b.value;break;case g.FRACTION:c.tokens.push({type:g.STRING,value:"/"}),c.fraction=!c.date;break;case g.TIMESTAMP:c.time=!0,c.tokens.push(b);break;case g.DATE_YEAR:case g.DATE_MONTH:case g.DATE_DAY:case g.DATE_LONG_WEEK:case g.DATE_SHORT_WEEK:c.date=!0,c.fraction=!1,c.tokens.push(b);break;case g.TIME_HOUR:case g.TIME_MINUTE:case g.TIME_SECOND:c.time=!0,c.tokens.push(b);break;case g.AMPM:c.time=!0,c.tokens.push(b);break;case g.SCIENTIFIC:c.scientific=!0,c.tokens.push(b);break;default:c.tokens.push(b)}return c}function f(){return{thousandth:!1,date:!1,time:!1,scientific:!1,percentage:!1,fraction:!1,text:!1,color:null,dbnum:null,locale:null,ampm:null,tokens:[]}}var g=b.r(17);return{parse:function(a){if(0===a.length||a.length>4)throw new Error("illegal group");for(var b=[],d=0,f=a.length;f>d;d++)b.push(e(a[d]));return c(b)}}}},b[20]={value:function(){var a={_symbols:null,reload:function(b){a._symbols=b.split("")},getSymbol:function(){return a._symbols.shift()},hasMore:function(){return a._symbols.length>0},matchNextSymbol:function(b,c){return 0===a._symbols.length?!1:c?a._symbols[0].toLowerCase()===b.toLowerCase():a._symbols[0]===b},matchNextString:function(b,c){if(0===a._symbols.length)return!1;var d=a._symbols.join("");return c&&(d=d.toLowerCase(),b=b.toLowerCase()),0===d.indexOf(b)},freeSymbol:function(b){a._symbols=a._symbols.slice(b)}};return a}},b[21]={value:function(a){function c(a){return a.push([]),F=null,G=E.NONE,a[a.length-1]}function d(){for(var a,b=[],d=c(b);a=B.getSymbol();)switch(a){case"\\":e(d,a);break;case'"':f(d,a);break;case"#":case"?":case"0":i(d,a);break;case".":j(d,a);break;case",":k(d,a);break;case"@":l(d,a);break;case"_":m(d,a);break;case"*":n(d,a);break;case"[":o(d,a);break;case"y":case"Y":p(d,a);break;case"m":case"M":u(d,a);break;case"d":case"D":q(d,a);break;case"h":case"H":r(d,a);break;case"s":case"S":s(d,a);break;case"a":case"A":t(d,a);break;case"E":x(d,a);break;case"%":y(d,a);break;case"/":z(d,a);break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":g(d,a);break;case";":d=c(b);break;case"$":case"\xa5":case"+":case"(":case":":case"^":case"'":case"{":case"<":case"=":case"-":case")":case"!":case"&":case"~":case"}":case">":case" ":h(d,a);break;default:if(!w(d,a))throw new Error("Illegal symbol: "+a)}return b}function e(a){var b=B.getSymbol();if(!b)throw new Error("escape symbol not found");var c=a[a.length-1];c&&c.type===C.STRING?c.value+=b:a.push({type:C.STRING,value:b})}function f(a){for(var b,c=[];(b=B.getSymbol())&&'"'!==b;)c.push(b);if(c.length){c=c.join("");var d=a[a.length-1];d&&d.type===C.STRING?d.value+=c:a.push({type:C.STRING,value:c})}}function g(a,b){a.push({type:C.STRING,value:b})}function h(a,b){var c=a[a.length-1];c&&c.type===C.STRING?c.value+=b:a.push({type:C.STRING,value:b})}function i(a,b){a.push({type:C.NUMBER,value:b})}function j(a,b){a.push({type:C.DECIMAL,value:b})}function k(a,b){a.push({type:C.THOUSANDTH,value:b})}function l(a,b){a.push({type:C.QUOTE,value:b})}function m(a){var b=B.getSymbol();if(!b)throw new Error("space symbol not found");a.push({type:C.SYMBOL_SPACE,value:b})}function n(a){var b=B.getSymbol();if(!b)throw new Error("repeat symbol not found");a.push({type:C.REPEAT,value:b})}function o(a){for(var b,c=[],d=!1;b=B.getSymbol();){if("]"===b){d=!0;break}c.push(b)}if(!d)throw new Error('directive "[]" is incomplete');c=c.join(""),-1!==D.indexOf(c.toLowerCase())?a.push({type:C.COLOR,value:A(c)}):/^dbnum([12])$/i.test(c)?a.push({type:C.DBNUM,value:+RegExp.$1}):/^\$-([48]04)$/.test(c)?a.push({type:C.LOCALE,value:+RegExp.$1}):/^(h{1,2}|m{1,2}|s{1,2})$/i.test(c)&&a.push({type:C.TIMESTAMP,value:RegExp.$1.toLowerCase()})}function p(a){F=null,G=E.YEAR,a.push({type:C.DATE_YEAR,value:v("y")})}function q(a){F&&(F.type=C.DATE_MONTH,F=null),G=E.NONE,a.push({type:C.DATE_DAY,value:v("d")})}function r(a){F=null,G=E.HOUR,a.push({type:C.TIME_HOUR,value:v("h")})}function s(a){F?(F.type=C.TIME_MINUTE,F=null,G=E.NONE):G=E.SECOND,a.push({type:C.TIME_SECOND,value:v("s")})}function t(a,b){for(var c=[b];B.matchNextString("a",!0);)c.push("a"),B.freeSymbol(1);if(3===c.length)a.push({type:C.DATE_SHORT_WEEK,value:"aaa"});else if(c.length>3)a.push({type:C.DATE_LONG_WEEK,value:"aaaa"});else if(!w(a,b))throw new Error("Illegal symbol: "+b)}function u(a){var b=v("m"),c={type:C.DATE_MONTH,value:b};if(a.push(c),!(b.length>2)){var d=G;switch(F=null,G=E.NONE,d){case E.NONE:F=c;break;case E.YEAR:c.type=C.DATE_MONTH;break;case E.DAY:break;case E.HOUR:c.type=C.TIME_MINUTE;break;case E.SECOND:c.type=C.TIME_MINUTE}}}function v(a){a=a.toLowerCase();for(var b=[a];B.matchNextSymbol(a,!0);)B.getSymbol(),b.push(a);return b.join("")}function w(a,b){var c=null;return"a"===b||"A"===b?B.matchNextString("m/pm",!0)?(c=[],c[0]=b+B.getSymbol(),B.freeSymbol(1),c[1]=B.getSymbol()+B.getSymbol()):B.matchNextString("/p",!0)&&(c=[],c[0]=b,B.freeSymbol(1),c[1]=B.getSymbol()):"\u4e0a"===b&&B.matchNextString("\u5348/\u4e0b\u5348",!0)&&(c=["\u4e0a\u5348","\u4e0b\u5348"],B.freeSymbol(4)),null===c?!1:(a.push({type:C.AMPM,value:c}),!0)}function x(a,b){var c=B.getSymbol();if("+"===c)a.push({type:C.SCIENTIFIC,value:"E+"});else{if(!c)throw new Error("Illegal symbol: "+b);a.push({type:C.SCIENTIFIC,value:"E-"})}}function y(a){a.push({type:C.PERCENTAGE,value:"%"})}function z(a){a.push({type:C.FRACTION,value:"/"})}function A(a){return a.charAt(0).toUpperCase()+a.substring(1).toLowerCase()}var B=b.r(20),C=b.r(17),D=["black","green","white","blue","magenta","yellow","cyan","red"],E={NONE:0,YEAR:1,DAY:2,HOUR:4,SECOND:8},F=null,G=E.NONE;return{parse:function(a){return B.reload(a),d()}}}},b[22]={value:function(a){var c=b.r(23);return{format:function(a,b){var d;return"number"==typeof a?(d=a>0?b[0]:0>a?b[1]:b[2])?0===d.tokens.length?"":(a=Math.abs(a),c.exec(a,d)):a:(a+="",d=b[3],d?0===d.tokens.length?"":void 0:a)}}}},b[23]={value:function(a){var c=b.r(25),d=b.r(28),e=b.r(27),f=b.r(26),g=b.r(18);return{exec:function(a,b){return b?0===b.tokens.length?{type:g.NUMBER,color:null,value:""}:(b=$.extend(!0,{},b),b.date||b.time?c.exec(a,b):b.scientific?d.exec(a,b):b.fraction?f.exec(a,b):e.exec(a,b)):{type:g.NUMBER,color:null,value:a}}}}},b[24]={value:function(){function a(a,c){var d=[a.shift()];return d.concat(b(a,c))}function b(a,b){var c=Math.pow(10,b)-1;return d(a,c)}function c(a,b){var c=(a+"").replace(/^-?\d+\./,""),d=Math.pow(10,c.length);c=parseInt(c,10);var e=f(d,c);return e.unshift(Math.floor(a)),e}function d(a,b){if(a[0]>b)return[0,0];for(var c;null===(c=e(a,b));)a.pop();return c}function e(a,b){if(1===a.length)return[1,a[0]];for(var c,d=1,e=a[a.length-1],f=a.length-2;f>=0;f--){if(c=a[f]*e+d,c>b)return null;d=e,e=c}return[d,e]}function f(a,b){for(var c,d=[],e=20;0!=b&&e>0;)e--,c=b,d.push(Math.floor(a/b)),b=a%b,a=c;return d}return{getFraction:function(b,d){var e=c(b);return a(e,d)}}}},b[25]={value:function(a){function c(a,b){return"yy"===b?{type:l.DATE_YEAR,value:a.year%100+""}:"yyyy"===b?{type:l.DATE_YEAR,value:a.year+""}:void 0}function d(a,b){switch(b){case"m":return{type:l.DATE_MONTH,value:a.month+""};case"mm":return{type:l.DATE_MONTH,value:a.month<10?"0"+a.month:""+a.month};case"mmm":return{type:l.STRING,value:o[a.month]};case"mmmmm":return{type:l.STRING,value:p[a.month]};case"mmmm":default:return{type:l.STRING,value:q[a.month]}}}function e(a,b){switch(b){case"d":return{type:l.DATE_DAY,value:a.day+""};case"dd":return{type:l.DATE_DAY,value:a.day<10?"0"+a.day:""+a.day};case"ddd":return{type:l.STRING,value:r[a.weekday]};case"dddd":default:return{type:l.STRING,value:s[a.weekday]}}}function f(a,b){switch(b){case"aaa":return{type:l.STRING,value:t[a.weekday]};case"aaaa":return{type:l.STRING,value:u[a.weekday]}}}function g(a,b){var c=a.am?a.hour12:a.hour;switch(b){case"h":return{type:l.TIME_HOUR,value:c+""};case"hh":default:return{type:l.TIME_HOUR,value:10>c?"0"+c:""+c}}}function h(a,b){switch(b){case"m":return{type:l.TIME_MINUTE,value:a.minute+""};case"mm":default:return{type:l.HOUR,value:a.minute<10?"0"+a.minute:""+a.minute}}}function i(a,b){switch(b){case"s":return{type:l.TIME_SECOND,value:a.second+""};case"ss":default:return{type:l.TIME_SECOND,value:a.second<10?"0"+a.second:""+a.second}}}function j(a,b){return{type:l.STRING,value:a.am?b[0]:b[1]}}function k(a,b){switch(b){case"s":return{type:l.TIMESTAMP,value:a.totalSecond};case"ss":return{type:l.TIMESTAMP,value:a.totalSecond<10?"0"+a.totalSecond:""+a.totalSecond};case"m":return{type:l.TIMESTAMP,value:a.totalMinute};case"mm":return{type:l.TIMESTAMP,value:a.totalMinute<10?"0"+a.totalMinute:""+a.totalMinute};case"h":return{type:l.TIMESTAMP,value:a.totalHour};case"hh":return{type:l.TIMESTAMP,value:a.totalHour<10?"0"+a.totalHour:""+a.totalHour}}}var l=b.r(17),m=b.r(10),n=b.r(12),o=["","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],p=["","J","F","M","A","M","J","J","A","S","O","N","D"],q=["","January","February","March","April","May","June","July","August","September","October","November","December"],r=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],s=["Sunday","Monday","Tuesday","Wednesday","Thurday","Friday","Saturday"],t=["\u5468\u65e5","\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d"],u=["\u661f\u671f\u65e5","\u661f\u671f\u4e00","\u661f\u671f\u4e8c","\u661f\u671f\u4e09","\u661f\u671f\u56db","\u661f\u671f\u4e94","\u661f\u671f\u516d"],v=b.r(18);return{exec:function(a,b){if(0>a)return"######";var o,p;b.date&&(o=m.numberToDate(a)),b.time&&(p=m.numberToTime(a));for(var q,r=[],s=b.tokens,t=0,u=s.length;u>t;t++)switch(q=s[t],q.type){case l.STRING:r.push({type:l.STRING,value:q.value});break;case l.SYMBOL_SPACE:r.push({type:l.STRING,value:" "});break;case l.THOUSANDTH:case l.REPEAT:break;case l.TIMESTAMP:r.push(k(p,q.value));break;case l.DATE_YEAR:r.push(c(o,q.value));break;case l.DATE_MONTH:r.push(d(o,q.value));break;case l.DATE_DAY:r.push(e(o,q.value));break;case l.DATE_LONG_WEEK:case l.DATE_SHORT_WEEK:r.push(f(o,q.value));break;case l.TIME_HOUR:r.push(g(p,q.value));break;case l.TIME_MINUTE:r.push(h(p,q.value));break;case l.TIME_SECOND:r.push(i(p,q.value));break;case l.AMPM:r.push(j(p,q.value));break;default:throw new Error("error code")}a=n.convert(r,b.dbnum,b.locale);var w;return w=b.date&&b.time?v.DATETIME:b.date?v.DATE:v.TIME,{type:w,color:b.color||null,value:a}}}}},b[26]={value:function(a){function c(a,b,c){var d,f,g;return Number.isInteger(a)?(d=a,f=1):c.value.length?(f=+c.value.join(""),d=Math.round(a*f)):(g=k.getFraction(a,c.denominator),f=g[2],d=g[0]*f+g[1]),e(b,["",d+"",f+""])}function d(a,b,c){var d,f,g,h;return Number.isInteger(a)?(g=a,d=a,f=1):c.value.length?(f=+c.value.join(""),g=Math.floor(a),d=Math.round((a-g)*f)):(h=k.getFraction(a,c.denominator),g=h[0],d=h[1],f=h[2]),0===g&&(g=""),e(b,[g+"",d+"",f+""])}function e(a,b){function c(a,b){f=f.concat(l.parseInteger(a,b.split("")))}function d(a,b){f=f.concat(l.parseDecimal(a,b.split("")))}function e(a,b){f=f.concat(l.parseInteger(a,b.split("")))}var f=[];e(a.integer,b[0]),c(a.numerator,b[1]),d(a.denominator,b[2]);for(var g=0,h=f.length;h>g;g++)f[g]=f[g].value;return f.join("")}function f(a,b){var c={integer:[],numerator:[],denominator:[]};return g(c,a,b),h(c,a,b),i(c,a,b),c}function g(a,b,c){function d(){h=!0;var a=+l.join("");if(isNaN(a)||0===a){c.denominator=l.length;for(var b=0,d=l.length;d>b;b++)i.push({type:j.NUMBER,value:l[b]})}else{c.value=l,c.denominator=l.length;for(var b=0,d=l.length;d>b;b++)i.push({type:j.NUMBER,value:"0"})}}for(var e=0,f=b.length;f>e&&"/"!==b[e].value;e++);b=b.splice(e);for(var g,h=!1,i=a.denominator,k=!0,l=[];k&&(g=b.shift());)switch(g.type){case j.STRING:if(-1!=="123456789".indexOf(g.value)){l.push(g.value);break}if(l.length>0){k=!1,d(),i.push(g);break}i.push(g);break;case j.THOUSANDTH:break;case j.NUMBER:l.push(g.value);break;case j.SYMBOL_SPACE:i.push({type:j.STRING,value:" "});break;default:throw new Error("Illegal token: "+g.value)}for(var e=0,f=b.length;f>e;e++)switch(g=b[e],g.type){case j.STRING:case j.NUMBER:i.push({type:j.STRING,value:g.value});break;case j.THOUSANDTH:break;case j.SYMBOL_SPACE:i.push({type:j.STRING,value:" "});break;default:throw new Error("Illegal token: "+g.value)}h||d()}function h(a,b,c){for(var d,e=a.numerator,f=[],g=b.length-1;g>=0;g--){if(d=b[g],d.type===j.STRING&&-1!==d.value.indexOf(" ")){b.splice(g+1);break}f.push(d)}for(b=f;d=b.shift();)switch(d.type){case j.STRING:e.push(d);break;case j.THOUSANDTH:break;case j.NUMBER:c.numerator++,e.push(d);break;case j.SYMBOL_SPACE:e.push({type:j.STRING,value:" "});break;default:throw new Error("Illegal token: "+d.value)}}function i(a,b,c){for(var d,e=a.integer;d=b.shift();)switch(d.type){case j.STRING:e.push(d);break;case j.THOUSANDTH:break;case j.NUMBER:c.integer++,e.push(d);break;case j.SYMBOL_SPACE:e.push({type:j.STRING,value:" "});break;default:throw new Error("Illegal token: "+d.value)}}var j=b.r(17),k=b.r(24),l=b.r(29),m=b.r(18);return{exec:function(a,b){var e,g={integer:0,numerator:0,denominator:0,value:[]},h=f(b.tokens,g);return e=0===g.integer?c(a,h,g):d(a,h,g),{type:m.FRACTION,color:b.color||null,value:e}}}}},b[27]={value:function(a){function c(a,b,c){var d=i.parseInteger(a,c.split(""));return b&&(d=h.convert(d)),d}function d(a,b){return i.parseDecimal(a,(b||"").split(""))}function e(a,b){for(var c,d="integer",e={integer:[],decimal:[]},g=0,h=a.length;h>g;g++)switch(c=a[g],c.type){case f.STRING:e[d].push(c);break;case f.THOUSANDTH:break;case f.DECIMAL:d="decimal",e[d].push(c);break;case f.NUMBER:b[d]++,e[d].push(c);break;case f.QUOTE:e[d].push(c);break;case f.SYMBOL_SPACE:e[d].push({type:f.STRING,value:" "});break;case f.REPEAT:break;default:throw new Error("Illegal token: "+c.value)}return e}var f=b.r(17),g=b.r(12),h=b.r(13),i=b.r(29),j=b.r(18);return{exec:function(a,b){var f={integer:0,decimal:0},h=e(b.tokens,f);a=i.toFixed(a,f.decimal).split(".");var k=c(h.integer,b.thousandth,a[0]),l=d(h.decimal,a[1]);return{type:j.NUMBER,color:b.color||null,value:g.convert(k.concat(l))}}}}},b[28]={value:function(a){function c(a,b,c){var d=k.parseInteger(a,c);return b&&(d=j.convert(d)),h(d)}function d(a,b){for(var c,d,e,f=[];a.length;){if(c=a.shift(),d=c.type,d===i.SCIENTIFIC){a.unshift(c);break}if(d===i.NUMBER)switch(e=b.shift(),c.value){case"0":f.push({type:i.NUMBER,value:e||"0"});break;case"#":void 0!==e&&f.push({type:i.NUMBER,value:e});break;case"?":f.push(void 0!==e?{type:i.NUMBER,value:e}:{type:i.STRING,value:" "})}else f.push(c)}return h(f)}function e(a,b,c){var d=a.shift();d="E+"===d.value?0>c?"E-":"E+":0>c?"E-":"E";var e=k.parseInteger(a,(Math.abs(c)+"").split(""));return b&&(e=j.convert(e)),d+h(e)}function f(a,b){for(var c,d={integer:[],decimal:[],exponent:[]},e="integer",f=0,g=a.length;g>f;f++)switch(c=a[f],c.type){case i.STRING:d[e].push(c);break;case i.THOUSANDTH:break;case i.SCIENTIFIC:e="exponent",d[e].push(c);break;case i.DECIMAL:e="decimal",d[e].push(c);break;case i.NUMBER:b[e]++,d[e].push(c);break;case i.QUOTE:d[e].push(c);break;case i.SYMBOL_SPACE:d[e].push({type:i.STRING,value:" "});break;case i.REPEAT:break;default:throw new Error("Illegal token: "+c.value)}return d}function g(a,b){a=(a+"").replace(/^0+/,"");var c=a.indexOf(".");-1===c&&(c=a.length);var d,e=[];a=a.replace(".","");var f=a.length;a=+a+"",f-=a.length,a=a.split("");for(var g=0,h=b.integer;h>g;g++)e.push(a.shift()||0);return a.length>b.decimal?(a=parseFloat(e.join("")+"."+a.join("")).toFixed(b.decimal),a=a.split("."),e=a[0].split(""),d=a[1].split("")):d=a,{integer:e,decimal:d,exponent:c-b.integer-f}}function h(a){for(var b=[],c=0,d=a.length;d>c;c++)b.push(a[c].value);return b.join("")}var i=b.r(17),j=b.r(13),k=b.r(29),l=b.r(18);return{exec:function(a,b){var h=b.tokens,i={integer:0,decimal:0,exponent:0};h=f(h,i),a=g(a,i);var j=c(h.integer,b.thousandth,a.integer),k=d(h.decimal,a.decimal),m=e(h.exponent,b.thousandth,a.exponent);return{type:l.SCIENTIFIC,color:b.color||null,value:j+k+m}}}}},b[29]={value:function(a){var c=b.r(17);return{toFixed:function(a,b){return a=(parseFloat(a)+"").split("."),1===a.length?a[0]:a[1].length<b?a.join("."):(a=a.join("."),parseFloat(a).toFixed(b))},parseInteger:function(a,b){var d,e,f=[],g=-1;a.reverse();for(var h=0,i=a.length;i>h;h++)if(d=a[h],d.type===c.NUMBER)switch(g=h,e=b.pop(),d.value){case"0":f.push({type:c.NUMBER,value:e||"0"});break;case"?":f.push(e?{type:c.NUMBER,value:e}:{type:c.STRING,value:" "});break;case"#":e&&f.push({type:c.NUMBER,value:e})}else f.push(d);if(b.length&&-1!==g)for(var h=b.length-1;h>=0;h--)g+=1,f.splice(g,0,{type:c.NUMBER,value:b[h]});return f.reverse()},parseDecimal:function(a,b){for(var d,e,f=[],g=0,h=a.length;h>g;g++)if(d=a[g],d.type===c.NUMBER)switch(e=b.shift(),d.value){case"0":f.push({type:c.NUMBER,value:e||"0"});break;case"?":f.push(e?{type:c.NUMBER,value:e}:{type:c.STRING,value:" "});break;case"#":e&&f.push({type:c.NUMBER,value:e})}else f.push(d);return f}}}},b[30]={value:function(a){function c(a){var b=h[a];return b||(b=d.parse(a),b=e.parse(b),h[a]=b),b}var d=b.r(21),e=b.r(19),f=b.r(22),g=b.r(0),h={};return{format:function(a,b){var d=c(b);return f.format(a,d)},analyze:function(a,b){return g.analyze(a)}}}},b[31]={value:function(a){window.NumfmtCode=b.r(30)}};var c={"kf.start":31};!function(b){try{a("kf.start")}catch(c){}}(this)}();